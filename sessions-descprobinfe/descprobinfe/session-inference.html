<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Statistical Inference | Descriptive statistics, probability and inference</title>
  <meta name="description" content="Chapter 4 Statistical Inference | Descriptive statistics, probability and inference" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Statistical Inference | Descriptive statistics, probability and inference" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Statistical Inference | Descriptive statistics, probability and inference" />
  
  
  

<meta name="author" content="NBIS" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="session-probability.html"/>

<script src="libs/header-attrs-2.10/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Preface</a></li>
<li class="chapter" data-level="2" data-path="session-descstats.html"><a href="session-descstats.html"><i class="fa fa-check"></i><b>2</b> Descriptive statistics</a>
<ul>
<li class="chapter" data-level="2.1" data-path="session-descstats.html"><a href="session-descstats.html#data-types"><i class="fa fa-check"></i><b>2.1</b> Data types</a></li>
<li class="chapter" data-level="2.2" data-path="session-descstats.html"><a href="session-descstats.html#categorical-data"><i class="fa fa-check"></i><b>2.2</b> Categorical data</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="session-descstats.html"><a href="session-descstats.html#data-summarization-and-plots"><i class="fa fa-check"></i><b>2.2.1</b> Data summarization and plots</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="session-descstats.html"><a href="session-descstats.html#quantitative-data"><i class="fa fa-check"></i><b>2.3</b> Quantitative data</a></li>
<li class="chapter" data-level="2.4" data-path="session-descstats.html"><a href="session-descstats.html#measures-of-location"><i class="fa fa-check"></i><b>2.4</b> Measures of location</a></li>
<li class="chapter" data-level="2.5" data-path="session-descstats.html"><a href="session-descstats.html#measures-of-spread"><i class="fa fa-check"></i><b>2.5</b> Measures of spread</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="session-descstats.html"><a href="session-descstats.html#variance-and-standard-deviation"><i class="fa fa-check"></i><b>2.5.1</b> Variance and standard deviation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="session-descstats.html"><a href="session-descstats.html#exercises-descriptive-statistics"><i class="fa fa-check"></i>Exercises: Descriptive statistics</a>
<ul>
<li class="chapter" data-level="" data-path="session-descstats.html"><a href="session-descstats.html#solutions-descriptive-statistics"><i class="fa fa-check"></i>Solutions: Descriptive statistics</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="session-probability.html"><a href="session-probability.html"><i class="fa fa-check"></i><b>3</b> Probability theory</a>
<ul>
<li class="chapter" data-level="3.1" data-path="session-probability.html"><a href="session-probability.html#introduction-to-probability"><i class="fa fa-check"></i><b>3.1</b> Introduction to probability</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="session-probability.html"><a href="session-probability.html#axioms-of-probability"><i class="fa fa-check"></i><b>3.1.1</b> Axioms of probability</a></li>
<li class="chapter" data-level="3.1.2" data-path="session-probability.html"><a href="session-probability.html#common-rules-of-probability"><i class="fa fa-check"></i><b>3.1.2</b> Common rules of probability</a></li>
<li class="chapter" data-level="3.1.3" data-path="session-probability.html"><a href="session-probability.html#conditional-probability"><i class="fa fa-check"></i><b>3.1.3</b> Conditional probability</a></li>
<li class="chapter" data-level="3.1.4" data-path="session-probability.html"><a href="session-probability.html#the-urn-model"><i class="fa fa-check"></i><b>3.1.4</b> The urn model</a></li>
<li class="chapter" data-level="3.1.5" data-path="session-probability.html"><a href="session-probability.html#random-variables"><i class="fa fa-check"></i><b>3.1.5</b> Random variables</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="session-probability.html"><a href="session-probability.html#discrete-random-variables"><i class="fa fa-check"></i><b>3.2</b> Discrete random variables</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="session-probability.html"><a href="session-probability.html#expected-value"><i class="fa fa-check"></i><b>3.2.1</b> Expected value</a></li>
<li class="chapter" data-level="3.2.2" data-path="session-probability.html"><a href="session-probability.html#variance"><i class="fa fa-check"></i><b>3.2.2</b> Variance</a></li>
<li class="chapter" data-level="3.2.3" data-path="session-probability.html"><a href="session-probability.html#simulate-distributions"><i class="fa fa-check"></i><b>3.2.3</b> Simulate distributions</a></li>
<li class="chapter" data-level="3.2.4" data-path="session-probability.html"><a href="session-probability.html#parametric-discrete-distributions"><i class="fa fa-check"></i><b>3.2.4</b> Parametric discrete distributions</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="session-probability.html"><a href="session-probability.html#exercises-discrete-random-variables"><i class="fa fa-check"></i>Exercises: Discrete random variables</a>
<ul>
<li class="chapter" data-level="" data-path="session-probability.html"><a href="session-probability.html#solutions-discrete-random-variables"><i class="fa fa-check"></i>Solutions: Discrete random variables</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="session-probability.html"><a href="session-probability.html#continuous-random-variable"><i class="fa fa-check"></i><b>3.3</b> Continuous random variable</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="session-probability.html"><a href="session-probability.html#parametric-continuous-distributions"><i class="fa fa-check"></i><b>3.3.1</b> Parametric continuous distributions</a></li>
<li class="chapter" data-level="3.3.2" data-path="session-probability.html"><a href="session-probability.html#normal-distribution"><i class="fa fa-check"></i><b>3.3.2</b> Normal distribution</a></li>
<li class="chapter" data-level="3.3.3" data-path="session-probability.html"><a href="session-probability.html#central-limit-theorem"><i class="fa fa-check"></i><b>3.3.3</b> Central limit theorem</a></li>
<li class="chapter" data-level="3.3.4" data-path="session-probability.html"><a href="session-probability.html#chi2-distribution"><i class="fa fa-check"></i><b>3.3.4</b> <span class="math inline">\(\chi^2\)</span>-distribution</a></li>
<li class="chapter" data-level="3.3.5" data-path="session-probability.html"><a href="session-probability.html#f-distribution"><i class="fa fa-check"></i><b>3.3.5</b> F-distribution</a></li>
<li class="chapter" data-level="3.3.6" data-path="session-probability.html"><a href="session-probability.html#t-distribution"><i class="fa fa-check"></i><b>3.3.6</b> t-distribution</a></li>
<li class="chapter" data-level="3.3.7" data-path="session-probability.html"><a href="session-probability.html#distributions-in-r-1"><i class="fa fa-check"></i><b>3.3.7</b> Distributions in R</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="session-probability.html"><a href="session-probability.html#exercises-continuous-random-variables"><i class="fa fa-check"></i>Exercises: Continuous random variables</a>
<ul>
<li class="chapter" data-level="" data-path="session-probability.html"><a href="session-probability.html#solutions"><i class="fa fa-check"></i>Solutions</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="session-probability.html"><a href="session-probability.html#random-sample"><i class="fa fa-check"></i><b>3.4</b> Random sample</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="session-probability.html"><a href="session-probability.html#the-urn-model-to-perform-simple-random-sampling"><i class="fa fa-check"></i><b>3.4.1</b> The urn model to perform simple random sampling</a></li>
<li class="chapter" data-level="3.4.2" data-path="session-probability.html"><a href="session-probability.html#sample-properties"><i class="fa fa-check"></i><b>3.4.2</b> Sample properties</a></li>
<li class="chapter" data-level="3.4.3" data-path="session-probability.html"><a href="session-probability.html#sample-mean-and-standard-deviation"><i class="fa fa-check"></i><b>3.4.3</b> Sample mean and standard deviation</a></li>
<li class="chapter" data-level="3.4.4" data-path="session-probability.html"><a href="session-probability.html#standard-error"><i class="fa fa-check"></i><b>3.4.4</b> Standard error</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="session-inference.html"><a href="session-inference.html"><i class="fa fa-check"></i><b>4</b> Statistical Inference</a>
<ul>
<li class="chapter" data-level="4.1" data-path="session-inference.html"><a href="session-inference.html#hypothesis-test"><i class="fa fa-check"></i><b>4.1</b> Hypothesis test</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="session-inference.html"><a href="session-inference.html#the-null-and-alternative-hypothesis"><i class="fa fa-check"></i><b>4.1.1</b> The null and alternative hypothesis</a></li>
<li class="chapter" data-level="4.1.2" data-path="session-inference.html"><a href="session-inference.html#to-perform-a-hypothesis-test"><i class="fa fa-check"></i><b>4.1.2</b> To perform a hypothesis test</a></li>
<li class="chapter" data-level="4.1.3" data-path="session-inference.html"><a href="session-inference.html#significance-level-and-error-types"><i class="fa fa-check"></i><b>4.1.3</b> Significance level and error types</a></li>
<li class="chapter" data-level="4.1.4" data-path="session-inference.html"><a href="session-inference.html#hypothesis-test-simulation-examples"><i class="fa fa-check"></i><b>4.1.4</b> Hypothesis test, simulation examples</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="session-inference.html"><a href="session-inference.html#exercises-hypothesis-tests-resampling"><i class="fa fa-check"></i>Exercises: Hypothesis tests, resampling</a></li>
<li class="chapter" data-level="4.2" data-path="session-inference.html"><a href="session-inference.html#parametric-tests"><i class="fa fa-check"></i><b>4.2</b> Parametric tests</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="session-inference.html"><a href="session-inference.html#one-sample-proportions"><i class="fa fa-check"></i><b>4.2.1</b> One sample, proportions</a></li>
<li class="chapter" data-level="4.2.2" data-path="session-inference.html"><a href="session-inference.html#one-sample-mean"><i class="fa fa-check"></i><b>4.2.2</b> One sample, mean</a></li>
<li class="chapter" data-level="4.2.3" data-path="session-inference.html"><a href="session-inference.html#two-samples-proportions"><i class="fa fa-check"></i><b>4.2.3</b> Two samples, proportions</a></li>
<li class="chapter" data-level="4.2.4" data-path="session-inference.html"><a href="session-inference.html#two-samples-mean"><i class="fa fa-check"></i><b>4.2.4</b> Two samples, mean</a></li>
<li class="chapter" data-level="4.2.5" data-path="session-inference.html"><a href="session-inference.html#variance-1"><i class="fa fa-check"></i><b>4.2.5</b> Variance</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="session-inference.html"><a href="session-inference.html#exercises-hypothesis-tests-parametric"><i class="fa fa-check"></i>Exercises: Hypothesis tests, parametric</a>
<ul>
<li class="chapter" data-level="" data-path="session-inference.html"><a href="session-inference.html#solutions-hypothesis-tests-parametric"><i class="fa fa-check"></i>Solutions: Hypothesis tests, parametric</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="session-inference.html"><a href="session-inference.html#point-and-interval-estimates"><i class="fa fa-check"></i><b>4.3</b> Point and interval estimates</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="session-inference.html"><a href="session-inference.html#bootstrap-interval"><i class="fa fa-check"></i><b>4.3.1</b> Bootstrap interval</a></li>
<li class="chapter" data-level="4.3.2" data-path="session-inference.html"><a href="session-inference.html#confidence-interval"><i class="fa fa-check"></i><b>4.3.2</b> Confidence interval</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="session-inference.html"><a href="session-inference.html#exercises-interval-estimates"><i class="fa fa-check"></i>Exercises: Interval estimates</a>
<ul>
<li class="chapter" data-level="4.3.3" data-path="session-inference.html"><a href="session-inference.html#solutions-1"><i class="fa fa-check"></i><b>4.3.3</b> Solutions</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="session-inference.html"><a href="session-inference.html#multiple-testing"><i class="fa fa-check"></i><b>4.4</b> Multiple testing</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="session-inference.html"><a href="session-inference.html#error-types"><i class="fa fa-check"></i><b>4.4.1</b> Error types</a></li>
<li class="chapter" data-level="4.4.2" data-path="session-inference.html"><a href="session-inference.html#bonferroni-correction"><i class="fa fa-check"></i><b>4.4.2</b> Bonferroni correction</a></li>
<li class="chapter" data-level="4.4.3" data-path="session-inference.html"><a href="session-inference.html#benjamini-hochbergs-fdr"><i class="fa fa-check"></i><b>4.4.3</b> Benjamini-Hochbergs FDR</a></li>
<li class="chapter" data-level="4.4.4" data-path="session-inference.html"><a href="session-inference.html#adjusted-p-values"><i class="fa fa-check"></i><b>4.4.4</b> ‘Adjusted’ p-values</a></li>
<li class="chapter" data-level="" data-path="session-inference.html"><a href="session-inference.html#example-10000-independent-tests-e.g.-genes"><i class="fa fa-check"></i>Example, 10000 independent tests (e.g. genes)</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Descriptive statistics, probability and inference</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="session-inference" class="section level1" number="4">
<h1><span class="header-section-number">Chapter 4</span> Statistical Inference</h1>
<p>Learning outcomes:</p>
<ul>
<li>to define null and alternative hypothesis</li>
<li>to perform a hypothesis test using resampling</li>
<li>to perform a t-test</li>
<li>to understand and define sampling distribution and standard error</li>
<li>to compute standard error of mean and proportions</li>
<li>to compute confidence interval of mean and proportions using the normal approximation</li>
<li>to compute confidence interval of mean using the t-distribution</li>
</ul>
<p>Statistical inference is to draw conclusions regarding properties of a population based on observations of a random sample from the population.</p>
<div id="hypothesis-test" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Hypothesis test</h2>
<p>To perform a hypothesis test is to evaluate a hypothesis based on a random sample.</p>
<p>Typicaly, the hypotheses that are tested are assumptions about properties of the population, such as proportion, mean, mean difference, variance etc.</p>
<div id="the-null-and-alternative-hypothesis" class="section level3" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> The null and alternative hypothesis</h3>
<p>There are two hypotheses involved in a hypothesis test, the null hypothesis, <span class="math inline">\(H_0\)</span>, and the alternative hypothesis, <span class="math inline">\(H_1\)</span>.</p>
<p>The null hypothesis is in general neutral, “no change”, “no difference between groups”, “no association”. In general we want to show that <span class="math inline">\(H_0\)</span> is false.</p>
<p>The alternative hypothesis expresses what the researcher is interested in “the treatment has an effect”, “there is a difference between groups”, “there is an association”. The alternative hypothesis can also be directional “the treatment has a positive effect”.</p>
</div>
<div id="to-perform-a-hypothesis-test" class="section level3" number="4.1.2">
<h3><span class="header-section-number">4.1.2</span> To perform a hypothesis test</h3>
<ol style="list-style-type: decimal">
<li>Define <span class="math inline">\(H_0\)</span> and <span class="math inline">\(H_1\)</span></li>
<li>Select appropriate test statistic, <span class="math inline">\(T\)</span>, and compute the observed value, <span class="math inline">\(t_{obs}\)</span></li>
<li>Assume that the <span class="math inline">\(H_0\)</span> is true and compute the sampling distribution of <span class="math inline">\(T\)</span>.</li>
<li>Select an appropriate significance level, <span class="math inline">\(\alpha\)</span></li>
<li>Compare the observed value, <span class="math inline">\(t_{obs}\)</span>, with the computed sampling distribution under <span class="math inline">\(H_0\)</span> and compute a p-value. The p-value is the probability of observing a value at least as extreme as the observed value, if <span class="math inline">\(H_0\)</span> is true.</li>
<li>Based on the p-value either accept or reject <span class="math inline">\(H_0\)</span>.</li>
</ol>

<div class="definition">
<p><span id="def:samplingdistribution" class="definition"><strong>Definition 4.1  </strong></span><strong>Sampling distribution</strong></p>
A <strong>sampling distribution</strong> is the distribution of a sample statistic. The samplling distribution can be obtained by drawing a large number of samples from a specific population.
</div>

<div class="definition">
<p><span id="def:nulldistribution" class="definition"><strong>Definition 4.2  </strong></span><strong>Null distribution</strong></p>
The null distribution is a sampling distribution when the null hypothesis is true.
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:examplenull"></span>
<img src="descprobinfe_files/figure-html/examplenull-1.png" alt="A null distribution" width="70%" />
<p class="caption">
Figure 4.1: A null distribution
</p>
</div>

<div class="definition">
<p><span id="def:pvalue" class="definition"><strong>Definition 4.3  </strong></span><strong>p-value</strong></p>
The p-value is the probability of the observed value, or something more extreme, if the null hypothesis is true.
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:examplepval"></span>
<img src="descprobinfe_files/figure-html/examplepval-1.png" alt="The p-value is the probability to observe $x_{obs}$ or something more extreme, if the null hypothesis is true." width="70%" /><img src="descprobinfe_files/figure-html/examplepval-2.png" alt="The p-value is the probability to observe $x_{obs}$ or something more extreme, if the null hypothesis is true." width="70%" />
<p class="caption">
Figure 4.2: The p-value is the probability to observe <span class="math inline">\(x_{obs}\)</span> or something more extreme, if the null hypothesis is true.
</p>
</div>
</div>
<div id="significance-level-and-error-types" class="section level3" number="4.1.3">
<h3><span class="header-section-number">4.1.3</span> Significance level and error types</h3>
<table>
<tbody>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
H0 is true
</td>
<td style="text-align:left;">
H0 is false
</td>
</tr>
<tr>
<td style="text-align:left;">
Accept H0
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Type II error, miss
</td>
</tr>
<tr>
<td style="text-align:left;">
Reject H0
</td>
<td style="text-align:left;">
Type I error, false alarm
</td>
<td style="text-align:left;">
</td>
</tr>
</tbody>
</table>
<p>The significance level, <span class="math inline">\(\alpha\)</span> = P(false alarm) = P(Reject <span class="math inline">\(H_0\)</span>|<span class="math inline">\(H_0\)</span> is true).</p>
<p>The significance level is the risk to of false alarm, i.e. to say “I have a hit”, “I found a difference”, when the the null hypothesis (“there is no difference”) is true. The risk of false alarm is control by setting the significance level to a disired value. We do want to keep the risk of false alarm (type I error) low, but at the same time we don’t want to many missed hits (type II error).</p>
<p>The significance level should be set before the hypothesis test is performed. Common values to use are 0.05 or 0.01.</p>
<p>If the p-value is above the significance level, <span class="math inline">\(H_0\)</span> is accepted.</p>
<p>If the p-value is below the significance level, <span class="math inline">\(H_0\)</span> is rejected.</p>
<!-- Power = P(Refect H0|H0 is false) -->
</div>
<div id="hypothesis-test-simulation-examples" class="section level3" number="4.1.4">
<h3><span class="header-section-number">4.1.4</span> Hypothesis test, simulation examples</h3>
<p>In these examples the significance level is set to 0.05.</p>

<div class="example">
<p><span id="exm:simpollentest" class="example"><strong>Example 4.1  </strong></span><strong>Pollen allergy</strong></p>
<p>Let’s assume we know that the proportion of pollen allergy in Sweden is <span class="math inline">\(0.3\)</span>. We suspect that the number of pollen allergic has increased in Uppsala in the last couple of years and want to investigate this.</p>
Observe 100 people from Uppsala, 42 of these were allergic to pollen. Is there a reason to believe that the proportion of pollen allergic in Uppsala <span class="math inline">\(\pi &gt; 0.3\)</span>?
</div>
<div id="null-and-alternative-hypotheses" class="section level5 unnumbered">
<h5>Null and alternative hypotheses</h5>
<p><span class="math inline">\(H_0:\)</span> The proportion of pollen allergy in Uppsala is the same as in Sweden as a whole.</p>
<p><span class="math inline">\(H_1:\)</span> The proportion of pollen allergy in Uppsala is not the same as in Sweden as a whole.</p>
<p>or expressed differently;</p>
<p><span class="math display">\[H_0:\, \pi=\pi_0\]</span></p>
<p><span class="math display">\[H_1:\, \pi&gt;\pi_0\]</span>
where <span class="math inline">\(\pi\)</span> is the unknown proportion of pollen allergy in the Uppsala population that. <span class="math inline">\(\pi_0 = 0.3\)</span> is the proportion of pollen allergy in Sweden.</p>
</div>
<div id="test-statistic" class="section level5 unnumbered">
<h5>Test statistic</h5>
<p>Here we are interested in the proportion of pollen allergic in Uppsala. An appropriate test statistic could be the number of pollen allergic in a sample of size <span class="math inline">\(n=100\)</span>, <span class="math inline">\(X\)</span>. As an alternative we can use the proportion of pollen allergic in a sample of size <span class="math inline">\(n\)</span>,</p>
<p><span class="math display">\[P = \frac{X}{n}\]</span></p>
<p>Let’s use <span class="math inline">\(P\)</span> as our test statistic and compute the observed value, <span class="math inline">\(p_{obs}\)</span>. In our sample of 100 people from Uppsala the proportion allergic to pollen is <span class="math inline">\(p=42/100=0.42\)</span>.</p>
</div>
<div id="null-distribution" class="section level5 unnumbered">
<h5>Null distribution</h5>
<p>The sampling distribution of <span class="math inline">\(P\)</span> under <span class="math inline">\(H_0\)</span> (i.e. when the null hypothesis is true) is what we call the null distribution.</p>
<p><span class="math inline">\(H_0\)</span> state that <span class="math inline">\(\pi=0.3\)</span>. We can model this using an urn model as follows;</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:pollenurn"></span>
<img src="figures/pollenurn.png" alt="An urn model of the null hypothesis $\pi=0.3$. The black balls represent allergic and the white balls non-allergic." width="20%" />
<p class="caption">
Figure 4.3: An urn model of the null hypothesis <span class="math inline">\(\pi=0.3\)</span>. The black balls represent allergic and the white balls non-allergic.
</p>
</div>
<p>Using this model, we can simulate taking a sample of size 100 many times.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="session-inference.html#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Urn</span></span>
<span id="cb102-2"><a href="session-inference.html#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">3</span>))</span></code></pre></div>
<pre><code>##  [1] 0 0 0 0 0 0 0 1 1 1</code></pre>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="session-inference.html#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Sample 100 times with replacement</span></span>
<span id="cb104-2"><a href="session-inference.html#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">3</span>)), <span class="dv">100</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>##   [1] 0 0 0 1 0 0 1 1 1 0 0 1 0 0 0 0 1 0 1 1 0 1 0 1 0 0 0 0 1 0 1 1 0 0 0 0 1
##  [38] 0 1 0 0 0 0 1 0 0 0 0 1 1 0 0 0 1 0 0 1 0 1 0 1 0 0 1 1 0 0 0 1 1 1 0 0 0
##  [75] 0 0 0 0 0 0 0 1 1 0 0 0 1 1 1 0 1 0 1 1 1 0 1 0 0 0</code></pre>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="session-inference.html#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Compute proportion of samples that are allergic (1)</span></span>
<span id="cb106-2"><a href="session-inference.html#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">sample</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">3</span>)), <span class="dv">100</span>, <span class="at">replace=</span><span class="cn">TRUE</span>))<span class="sc">/</span><span class="dv">100</span></span></code></pre></div>
<pre><code>## [1] 0.3</code></pre>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="session-inference.html#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Draw samples of size 100 and compute proporion allergic 100000 times</span></span>
<span id="cb108-2"><a href="session-inference.html#cb108-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">100000</span>, <span class="fu">mean</span>(<span class="fu">sample</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">3</span>)), <span class="dv">100</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)))</span></code></pre></div>
<p>Finally plot the distribution</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:pollensampledistr"></span>
<img src="descprobinfe_files/figure-html/pollensampledistr-1.png" alt="The sampling distribution." width="45%" />
<p class="caption">
Figure 4.4: The sampling distribution.
</p>
</div>
</div>
<div id="compute-p-value" class="section level5 unnumbered">
<h5>Compute p-value</h5>
<p>Compare the observed value, <span class="math inline">\(p_{obs} = 0.42\)</span> to the null distribution.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-38"></span>
<img src="descprobinfe_files/figure-html/unnamed-chunk-38-1.png" alt="The sampling distribution. The observed value is marked by a red vertical line." width="50%" />
<p class="caption">
Figure 4.5: The sampling distribution. The observed value is marked by a red vertical line.
</p>
</div>
<p>The p-value is the probability of getting the observed value or higher, if the null hypothesis is true.</p>
<p>Use the null distribution to calculate the p-value, <span class="math inline">\(P(P \geq 0.42|H_0)\)</span>.</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="session-inference.html#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="do">## How many times </span></span>
<span id="cb109-2"><a href="session-inference.html#cb109-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(p <span class="sc">&gt;=</span> <span class="fl">0.42</span>)</span></code></pre></div>
<pre><code>## [1] 689</code></pre>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="session-inference.html#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="do">## p-value</span></span>
<span id="cb111-2"><a href="session-inference.html#cb111-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(p <span class="sc">&gt;=</span> <span class="fl">0.42</span>)<span class="sc">/</span><span class="fu">length</span>(p)</span></code></pre></div>
<pre><code>## [1] 0.00689</code></pre>
<p>p = <span class="math inline">\(P(P \geq 0.42|H_0)\)</span> = 0.00689</p>
</div>
<div id="accept-or-reject-h_0" class="section level5 unnumbered">
<h5>Accept or reject <span class="math inline">\(H_0\)</span>?</h5>

<div class="example">
<p><span id="exm:permutationtest" class="example"><strong>Example 4.2  </strong></span><strong>Permutation test: Do high fat diet lead to increased body weight?</strong></p>
<p>Study setup:</p>
<ol style="list-style-type: decimal">
<li>Order 24 female mice from a lab.</li>
<li>Randomly assign 12 of the 24 mice to receive high-fat diet, the
remaining 12 are controls (ordinary diet).</li>
<li>Measure body weight after one week.
</div></li>
</ol>
<p>The observed values, mouse weights in grams, are summarized below;</p>
<table class="table" style="font-size: 14px; margin-left: auto; margin-right: auto;">
<tbody>
<tr>
<td style="text-align:left;">
high-fat
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
23
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
31
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
39
</td>
<td style="text-align:right;">
26
</td>
<td style="text-align:right;">
36
</td>
<td style="text-align:right;">
29
</td>
<td style="text-align:right;">
23
</td>
<td style="text-align:right;">
32
</td>
</tr>
<tr>
<td style="text-align:left;">
ordinary
</td>
<td style="text-align:right;">
27
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:right;">
23
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
37
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
26
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
26
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
24
</td>
</tr>
</tbody>
</table>
</div>
<div id="null-and-alternative-hypotheses-1" class="section level5 unnumbered">
<h5>Null and alternative hypotheses</h5>
<p><span class="math display">\[
\begin{aligned}
H_0: \mu_2 = \mu_1 \iff \mu_2 - \mu_1 = 0\\
H_1: \mu_2&gt;\mu_1 \iff \mu_2-\mu_1 &gt; 0
\end{aligned}
\]</span></p>
<p>where <span class="math inline">\(\mu_2\)</span> is the (unknown) mean body weight of the high-fat mouse population and <span class="math inline">\(\mu_1\)</span> is the mean body-weight of the control mouse population.</p>
<p>Studied population: Female mice that can be ordered from a lab.</p>
</div>
<div id="test-statistic-1" class="section level5 unnumbered">
<h5>Test statistic</h5>
<p>Here we are interested in the mean difference between high-fat and control mice.</p>
<p>Mean weight of 12 (randomly selected) mice on ordinary diet, <span class="math inline">\(\bar X_1\)</span>. <span class="math inline">\(E[\bar X_1] = E[X_1] = \mu_1\)</span></p>
<p>Mean weight of 12 (randomly selected) mice on high-fat diet, <span class="math inline">\(\bar X_2\)</span>. <span class="math inline">\(E[\bar X_2] = E[X_2] = \mu_2\)</span></p>
<p>The mean difference is also a random variable: <span class="math inline">\(D = \bar X_2 - \bar X_1\)</span></p>
<p>Observed values;</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="session-inference.html#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 12 HF mice</span></span>
<span id="cb113-2"><a href="session-inference.html#cb113-2" aria-hidden="true" tabindex="-1"></a>xHF <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">30</span>, <span class="dv">23</span>, <span class="dv">18</span>, <span class="dv">31</span>, <span class="dv">24</span>, <span class="dv">39</span>, <span class="dv">26</span>, <span class="dv">36</span>, <span class="dv">29</span>, <span class="dv">23</span>, <span class="dv">32</span>)</span>
<span id="cb113-3"><a href="session-inference.html#cb113-3" aria-hidden="true" tabindex="-1"></a><span class="do">## 12 control mice</span></span>
<span id="cb113-4"><a href="session-inference.html#cb113-4" aria-hidden="true" tabindex="-1"></a>xN <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">27</span>, <span class="dv">25</span>, <span class="dv">22</span>, <span class="dv">23</span>, <span class="dv">25</span>, <span class="dv">37</span>, <span class="dv">24</span>, <span class="dv">26</span>, <span class="dv">21</span>, <span class="dv">26</span>, <span class="dv">30</span>, <span class="dv">24</span>)</span>
<span id="cb113-5"><a href="session-inference.html#cb113-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-6"><a href="session-inference.html#cb113-6" aria-hidden="true" tabindex="-1"></a><span class="do">##Compute mean body weights of the two samples</span></span>
<span id="cb113-7"><a href="session-inference.html#cb113-7" aria-hidden="true" tabindex="-1"></a>mHF <span class="ot">&lt;-</span> <span class="fu">mean</span>(xHF)</span>
<span id="cb113-8"><a href="session-inference.html#cb113-8" aria-hidden="true" tabindex="-1"></a>mN <span class="ot">&lt;-</span> <span class="fu">mean</span>(xN) </span>
<span id="cb113-9"><a href="session-inference.html#cb113-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Compute mean difference</span></span>
<span id="cb113-10"><a href="session-inference.html#cb113-10" aria-hidden="true" tabindex="-1"></a>dobs <span class="ot">&lt;-</span> mHF <span class="sc">-</span> mN</span></code></pre></div>
<p>Mean weight of control mice (ordinary diet): <span class="math inline">\(\bar x_1 = 25.83\)</span></p>
<p>Mean weight of mice on high-fat diet: <span class="math inline">\(\bar x_2 = 28.00\)</span></p>
<p>Difference in mean weights: <span class="math inline">\(d_{obs} = \bar x_2 - \bar x_1 = 2.1667\)</span></p>
</div>
<div id="null-distribution-1" class="section level5 unnumbered">
<h5>Null distribution</h5>
<p>If high-fat diet has no effect, i.e. if <span class="math inline">\(H_0\)</span> was true, the result would be as if all mice were given the same diet. What can we expect if all mice are fed with the same type of food?</p>
<p>This can be accomplished using permutation</p>
<p>The 24 mice were initially from the same population, depending on how the mice are randomly assigned to high-fat and normal group, the mean weights would differ, even if the two groups were treated the same.</p>
<p>Assume <span class="math inline">\(H_0\)</span> is true, i.e. assume all mice are equivalent and</p>
<ol style="list-style-type: decimal">
<li>Randomly reassign 12 of the 24 mice to ‘high-fat’ and the remaining 12 to ‘control’.</li>
<li>Compute difference in mean weights</li>
</ol>
<p>If we repeat 1-2 many times we get the sampling distribution when <span class="math inline">\(H_0\)</span> is true, the so called null distribution, of difference in mean weights.</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="session-inference.html#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="do">## All 24 body weights in a vector</span></span>
<span id="cb114-2"><a href="session-inference.html#cb114-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(xHF, xN)</span>
<span id="cb114-3"><a href="session-inference.html#cb114-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Mean difference</span></span>
<span id="cb114-4"><a href="session-inference.html#cb114-4" aria-hidden="true" tabindex="-1"></a>(dobs <span class="ot">&lt;-</span> <span class="fu">mean</span>(x[<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>]) <span class="sc">-</span> <span class="fu">mean</span>(x[<span class="dv">13</span><span class="sc">:</span><span class="dv">24</span>]))</span></code></pre></div>
<pre><code>## [1] 2.167</code></pre>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="session-inference.html#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Permute once</span></span>
<span id="cb116-2"><a href="session-inference.html#cb116-2" aria-hidden="true" tabindex="-1"></a>(y <span class="ot">&lt;-</span> <span class="fu">sample</span>(x))</span></code></pre></div>
<pre><code>##  [1] 29 36 39 31 26 24 25 23 25 27 32 37 30 23 30 18 24 23 24 26 22 26 21 25</code></pre>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="session-inference.html#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Compute mean difference</span></span>
<span id="cb118-2"><a href="session-inference.html#cb118-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(y[<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>]) <span class="sc">-</span> <span class="fu">mean</span>(y[<span class="dv">13</span><span class="sc">:</span><span class="dv">24</span>])</span></code></pre></div>
<pre><code>## [1] 5.167</code></pre>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="session-inference.html#cb120-1" aria-hidden="true" tabindex="-1"></a>dnull.perm <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="at">n =</span> <span class="dv">100000</span>, {</span>
<span id="cb120-2"><a href="session-inference.html#cb120-2" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">sample</span>(x)</span>
<span id="cb120-3"><a href="session-inference.html#cb120-3" aria-hidden="true" tabindex="-1"></a>  <span class="do">##Mean difference</span></span>
<span id="cb120-4"><a href="session-inference.html#cb120-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(y[<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>]) <span class="sc">-</span> <span class="fu">mean</span>(y[<span class="dv">13</span><span class="sc">:</span><span class="dv">24</span>])</span>
<span id="cb120-5"><a href="session-inference.html#cb120-5" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb120-6"><a href="session-inference.html#cb120-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">d=</span>dnull.perm), <span class="fu">aes</span>(<span class="at">x=</span>d)) <span class="sc">+</span></span>
<span id="cb120-7"><a href="session-inference.html#cb120-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins=</span><span class="dv">25</span>, <span class="at">color=</span><span class="st">&quot;white&quot;</span>) <span class="sc">+</span></span>
<span id="cb120-8"><a href="session-inference.html#cb120-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb120-9"><a href="session-inference.html#cb120-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept=</span>dobs, <span class="at">color=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="descprobinfe_files/figure-html/permtest-1.png" width="50%" /></p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="session-inference.html#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Alternatively plot using hist</span></span>
<span id="cb121-2"><a href="session-inference.html#cb121-2" aria-hidden="true" tabindex="-1"></a><span class="do">## hist(dnull.perm)</span></span></code></pre></div>
</div>
<div id="compute-p-value-1" class="section level5 unnumbered">
<h5>Compute p-value</h5>
<p>What is the probability to get an at least as extreme mean difference as our observed value, <span class="math inline">\(d_{obs}\)</span>, if <span class="math inline">\(H_0\)</span> was true?</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="session-inference.html#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Compute the p-value</span></span>
<span id="cb122-2"><a href="session-inference.html#cb122-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(dnull.perm<span class="sc">&gt;</span>dobs)<span class="sc">/</span><span class="fu">length</span>(dnull.perm)</span></code></pre></div>
<pre><code>## [1] 0.1492</code></pre>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="session-inference.html#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(dnull.perm<span class="sc">&gt;</span>dobs)</span></code></pre></div>
<pre><code>## [1] 0.1492</code></pre>
<p>$P(X_2 - X_1 d_{obs} | H_0) = $ 0.168</p>
<p>Conclusion?</p>
<!-- ## Parametric hypothesis tests -->
</div>
</div>
</div>
<div id="exercises-hypothesis-tests-resampling" class="section level2 unnumbered">
<h2>Exercises: Hypothesis tests, resampling</h2>

<div class="exercise">
<p><span id="exr:pollentest" class="exercise"><strong>Exercise 4.1  </strong></span>You believe that the proportion of Swedish students allergic to pollen is greater than 0.3 (the proportion allergic to pollen in Sweden). To test this you observe 20 people in a student group at BMC in Uppsala, 9 or them are allergic to pollen. Is this reason to believe that the proportion of Swedish students allergic to pollen i greater than 0.3?</p>
Can you identify any problems with this study setup?
</div>

<div class="exercise">
<p><span id="exr:diet" class="exercise"><strong>Exercise 4.2  </strong></span>A diet study aims to study how the hemoglobin (Hb) levels in blood are affected by an iron-rich diet consisting of tofu, soybeans, broccoli, lentils and peas. To perform the study the dietician has recruited 40 male participants, who are randomly assigned to the iron-rich diet or control group (no change in participants diet), 20 participant in each group.</p>
The observed Hb levels (in g/L);
</div>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="session-inference.html#cb126-1" aria-hidden="true" tabindex="-1"></a>ctrl <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">197</span>, <span class="dv">186</span>, <span class="dv">157</span>, <span class="dv">170</span>, <span class="dv">193</span>, <span class="dv">188</span>, <span class="dv">175</span>, <span class="dv">186</span>, <span class="dv">177</span>, <span class="dv">191</span>, <span class="dv">168</span>, <span class="dv">193</span>, <span class="dv">191</span>, <span class="dv">189</span>, <span class="dv">188</span>, <span class="dv">192</span>, <span class="dv">179</span>, <span class="dv">186</span>, <span class="dv">197</span>, <span class="dv">203</span>)</span>
<span id="cb126-2"><a href="session-inference.html#cb126-2" aria-hidden="true" tabindex="-1"></a>iron <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">187</span>, <span class="dv">218</span>, <span class="dv">196</span>, <span class="dv">210</span>, <span class="dv">206</span>, <span class="dv">178</span>, <span class="dv">181</span>, <span class="dv">193</span>, <span class="dv">172</span>, <span class="dv">202</span>, <span class="dv">169</span>, <span class="dv">221</span>, <span class="dv">183</span>, <span class="dv">222</span>, <span class="dv">185</span>, <span class="dv">174</span>, <span class="dv">192</span>, <span class="dv">192</span>, <span class="dv">162</span>, <span class="dv">211</span>)</span></code></pre></div>
<p>Perform a hypothesis test to investigate if the Hb level is affected (increased or decreased) by the iron-rich diet.</p>
</div>
<div id="parametric-tests" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Parametric tests</h2>
<p>In previous chapters we have computed the sampling distribution using resampling techniques to be able to perform hypothesis tests or compute interval estimates. If the null distribution was already known (or could be computed based on a few assumptions) resampling would not be necessary.</p>
<p>We can follow the same steps as before to perform a hypothesis test:</p>
<ol style="list-style-type: decimal">
<li>Define <span class="math inline">\(H_0\)</span> and <span class="math inline">\(H_1\)</span></li>
<li>Select appropriate test statistic, <span class="math inline">\(T\)</span>, and compute the observed value, <span class="math inline">\(t_{obs}\)</span></li>
<li>Assume that the <span class="math inline">\(H_0\)</span> and derive the null distribution of the test statistic based on appropriate assumptions.</li>
<li>Select an appropriate significance level, <span class="math inline">\(\alpha\)</span></li>
<li>Compare the observed value, <span class="math inline">\(t_{obs}\)</span>, with the null distribution and compute a p-value. The p-value is the probability of observing a value at least as extreme as the observed value, if <span class="math inline">\(H_0\)</span> is true.</li>
<li>Based on the p-value either accept or reject <span class="math inline">\(H_0\)</span>.</li>
</ol>
<div id="one-sample-proportions" class="section level3" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> One sample, proportions</h3>

<div class="example">
<p><span id="exm:parampollen" class="example"><strong>Example 4.3  </strong></span><strong>Let’s get back to the pollen example!</strong></p>
Assume that the proportion of pollen allergy in Sweden is known to be <span class="math inline">\(0.3\)</span>. Observe 100 people from Uppsala, 42 of these were allergic to pollen. Is there a reason to believe that the proportion of pollen allergic in Uppsala <span class="math inline">\(\pi &gt; 0.3\)</span>?
</div>
<p>The number of allergic individuals in a sample of size <span class="math inline">\(n\)</span> is <span class="math inline">\(X\)</span> and the proportion of allergic persons is <span class="math inline">\(P = X/n\)</span>. <span class="math inline">\(X\)</span> is binomially distributed, but here we can use the Central limit theorem, see <a href="session-probability.html#thm:CLT">3.1</a>.</p>

<div class="theorem">
<span id="thm:CLTrep" class="theorem"><strong>Theorem 4.1  </strong></span>The sum of <span class="math inline">\(n\)</span> independent and equally distributed random variables
is normally distributed, if <span class="math inline">\(n\)</span> is large enough.
</div>
<p>As a result of the central limit theorem, the distribution of number or proportion of allergic
individuals in a sample of size <span class="math inline">\(n\)</span> is approximately normal. At least if the sample is large enough. A rule of thumb is that the sample size should be <span class="math inline">\(n&gt;30\)</span>.</p>
<p>Here, the sample size is 100!</p>
<p>The normal distribution has two parameters, mean and standard deviation.</p>
<p>From the binomial distribution we know that <span class="math inline">\(E[X] = \pi\)</span> and <span class="math inline">\(var(X) = n\pi(1-\pi)\)</span>. Hence <span class="math inline">\(E[P] = \pi\)</span> and <span class="math inline">\(var(P) = \frac{\pi(1-\pi)}{n}\)</span>.</p>
<p>The standard error is thus</p>
<p><span class="math display">\[SE=\sqrt{\frac{\pi(1-\pi)}{n}}\]</span></p>
<p>When the null hypothesis is true <span class="math inline">\(\pi\)</span> is known and <span class="math inline">\(\pi=0.3\)</span>.</p>
<p>Actually these calculations are true in general when a proportion in one sample is compared to a known value.</p>
<p><span class="math display">\[H_0: \pi=\pi_0 \\
H_1: \pi&gt;\pi_0 \]</span></p>
<p>Ather potential alternative hypothesis are <span class="math inline">\(H_1: \pi&lt;\pi_0\)</span> or <span class="math inline">\(H_1:\pi \neq \pi_0\)</span>, but in this particular example we are only interested in the alternative that <span class="math inline">\(\pi &gt; \pi_0\)</span>.</p>
<p>If <span class="math inline">\(H_0\)</span> is true <span class="math inline">\(\pi=\pi_0\)</span> and</p>
<p><span class="math display">\[P \sim N\left(\pi_0, \sqrt{\frac{\pi_0(1-\pi_0)}{n}}\right)\]</span>
An appropriate test statistic is</p>
<p><span class="math display">\[Z = \frac{P-\pi_0}{\sqrt{\frac{\pi_0(1-\pi_0)}{n}}}\]</span></p>
<p><span class="math inline">\(Z \in N(0,1)\)</span> which makes probabilities easy to compute.</p>
<p>Back to our example, replace <span class="math inline">\(P\)</span> with our observed value <span class="math inline">\(p=0.42\)</span> and <span class="math inline">\(\pi_0=0.3\)</span> and compute our observed</p>
<p><span class="math display">\[Z_{obs} = \frac{0.42-0.3}{\sqrt{\frac{0.3(1-0.3)}{100}}} = 2.62\]</span></p>
<p>The p-value is the probability of the observed value, or something more extreme, if the null hypothesis is true. If the computed probability is below <span class="math inline">\(\alpha=0.05\)</span> our significance threshold, <span class="math inline">\(H_0\)</span> will be rejected.</p>
<p><span class="math display">\[p = P(P \geq \pi_0) = P(Z \geq Z_{obs}) = P(Z \geq 2.62) = 1 - P(Z \leq 2.62) = [table] = 1 - 0.996 = 0.0044\]</span></p>
<p>As 0.0044&lt;0.05 we reject <span class="math inline">\(H_0\)</span> and conclude that there is reason to believe that the proportion of allergic in Uppsala is greater than 0.3.</p>
</div>
<div id="one-sample-mean" class="section level3" number="4.2.2">
<h3><span class="header-section-number">4.2.2</span> One sample, mean</h3>
<p>A one sample test of means compares the mean of a sample to a prespecified value.</p>
<p>For example, we might know that the weight of a mouse on normal diet is normally distributed with mean 24.0 g and standard deviation 3 g and want to compare the weight of a sample of 10 mice on high-fat diet to the known mean value for mice on normal diet.</p>
<p>The hypotheses:</p>
<p><span class="math display">\[H_0: \mu = \mu_0 \\
H_1: \mu \neq \mu_0\]</span></p>
<p>The alternative hypothesis, <span class="math inline">\(H_1,\)</span> above is for the two sided hypothesis test. Other options are the one sided <span class="math inline">\(H_1\)</span>; <span class="math inline">\(H_1: \mu &gt; \mu_0\)</span> or <span class="math inline">\(H_1: \mu &lt; \mu_0\)</span>.</p>
<p>If <span class="math display">\[X \sim N(\mu, \sigma)\]</span> (this could for example be the weight of a mouse on high-fat diet) then the sample mean <span class="math display">\[\bar X \sim N\left(\mu, \frac{\sigma}{\sqrt{n}}\right).\]</span></p>
<p>If <span class="math inline">\(\sigma\)</span> is known the test statistic</p>
<p><span class="math display">\[Z = \frac{\bar X - \mu}{\frac{\sigma}{\sqrt{n}}}\]</span>
is normally distributed, <span class="math inline">\(\sim N(0,1)\)</span>.</p>
<p>For small <span class="math inline">\(n\)</span> and unknown <span class="math inline">\(\sigma\)</span>, the test statistic</p>
<p><span class="math display">\[t = \frac{\bar X - \mu}{\frac{s}{\sqrt{n}}}\]</span></p>
<p>is t-distributed with <span class="math inline">\(df=n-1\)</span> degrees of freedom.</p>
</div>
<div id="two-samples-proportions" class="section level3" number="4.2.3">
<h3><span class="header-section-number">4.2.3</span> Two samples, proportions</h3>
<p><span class="math display">\[H_0: \pi_1 - \pi_2 = 0\\
H_1: \pi_1 - \pi_2 \neq 0\]</span></p>
<p>Alternatively, a one sided alternative hypothesis can be used; <span class="math inline">\(H_1: \pi_1 - \pi_2 &gt;0\)</span> or <span class="math inline">\(H_1: \pi_1 - \pi_2 &lt; 0\)</span>.
<!-- If $H_0$ is true --></p>
<!-- $$P_1 - P_2 \sim N\left(0, \sqrt{\pi(1-\pi)\left (\frac{1}{n_1} + \frac{1}{n_2}\right)} \right)$$ -->
<!-- where $\pi$ is the  -->
<p>Test statistic</p>
<p><span class="math display">\[Z = \frac{P_1 - P_2}{\sqrt{P(1-P)\left (\frac{1}{n_1} + \frac{1}{n_2}\right)}}\]</span></p>
<p>where <span class="math inline">\(P\)</span> is the proportion in the merged sample of size <span class="math inline">\(n_1 + n_2\)</span>. <span class="math inline">\(Z \in N(0,1)\)</span> and p-value can be computed using the standard normal distribution.</p>
</div>
<div id="two-samples-mean" class="section level3" number="4.2.4">
<h3><span class="header-section-number">4.2.4</span> Two samples, mean</h3>
<p>A two sample test of means is used to determine if two population means are equal.</p>
<p>Two independent samples are collected (one from each population) and the means are compared. Can for example be used to determine if a treatment group is different compared to a control group, in terms of the mean of a property of interest.</p>
<p>The null hypothesis;</p>
<p><span class="math display">\[H_0: \mu_2 = \mu_1\]</span>
The alternative hypothesis can either be two sided</p>
<p><span class="math display">\[H_1: \mu_2 \neq \mu_1\]</span>
or one sided</p>
<p><span class="math display">\[H_1: \mu_2 &gt; \mu_1\]</span>
or</p>
<p><span class="math display">\[H_1: \mu_2 &lt; \mu_1\]</span></p>
<p>Assume that observations from both populations are normally distributed;</p>
<p><span class="math display">\[
\begin{aligned}
X_1 \sim N(\mu_1, \sigma_1) \\
X_2 \sim N(\mu_2, \sigma_2)
\end{aligned}
\]</span>
Then it follows that the sample means will also be normally distributed;</p>
<p><span class="math display">\[
\begin{aligned}
\bar X_1 \sim N(\mu_1, \sigma_1/\sqrt{n_1}) \\
\bar X_2 \sim N(\mu_2, \sigma_2/\sqrt{n_2})
\end{aligned}
\]</span></p>
<p>The mean difference <span class="math inline">\(D = \bar X_2 - \bar X_1\)</span> is thus also normally distributed:</p>
<p><span class="math display">\[D = \bar X_2 - \bar X_1 = N\left(\mu_2-\mu_1, \sqrt{\frac{\sigma_2^2}{n_2} + \frac{\sigma_1^2}{n_1}}\right)\]</span></p>
<p>If <span class="math inline">\(H_0\)</span> is true: <span class="math display">\[D = \bar X_2 - \bar X_1 = N\left(0, \sqrt{\frac{\sigma_2^2}{n_2} + \frac{\sigma_1^2}{n_1}}\right)\]</span></p>
<p>The test statistic: <span class="math display">\[Z = \frac{\bar X_2 - \bar X_1}{\sqrt{\frac{\sigma_2^2}{n_2} + \frac{\sigma_1^2}{n_1}}}\]</span> is standard normal, i.e. <span class="math inline">\(Z \sim N(0,1)\)</span>.</p>
<p>However, note that the test statistic require the standard deviations <span class="math inline">\(\sigma_1\)</span> and <span class="math inline">\(\sigma_2\)</span> to be known.</p>
<p>What if the population standard deviations are not known?</p>
<p>If the sample sizes are large, we can replace the known standard deviations with our sample standard deviations and according to the central limit theorem assume that</p>
<p><span class="math display">\[Z = \frac{\bar X_2 - \bar X_1}{\sqrt{\frac{s_2^2}{n_2} + \frac{s_1^2}{n_1}}} \sim N(0,1)\]</span></p>
<p>and proceed as before.</p>
<!-- Here $n_1=n_2=12$ which is not very large. -->
<p>For small sample sizes the test statistic will be t-distributed.</p>
<p><span class="math display">\[t = \frac{\bar X_2 - \bar X_1}{\sqrt{\frac{s_2^2}{n_2} + \frac{s_1^2}{n_1}}}\]</span></p>
<p>For small sample sizes we can use Student’s t-test, which requires us to assume that <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span> both are normally distributed and have equal variances. With these assumptions we can compute the pooled variance</p>
<p><span class="math display">\[
s_p^2 = \frac{(n_1-1)s_1^2 + (n_2-1)s_2^2}{n_1+n_2-2}
\]</span></p>
<p>and the test statistic</p>
<p><span class="math display">\[t = \frac{\bar X_1 - \bar X_2}{\sqrt{s_p^2(\frac{1}{n_1} + \frac{1}{n_2})}}\]</span></p>
<p><span class="math inline">\(t\)</span> is t-distributed with <span class="math inline">\(n_1+n_2-2\)</span> degrees of freedom.</p>
<p>The t-test is implemented in R, e.g. in the function <code>t.test</code> in the R-package <code>stats</code>, both Student’s t-test with equal variances and Welch’s t-test with unequal variances.</p>
</div>
<div id="variance-1" class="section level3" number="4.2.5">
<h3><span class="header-section-number">4.2.5</span> Variance</h3>
<p>The test of equal variance in two groups is based on the null hypothesis</p>
<p><span class="math display">\[H_0: \sigma_1^2 = \sigma_2^2\]</span></p>
<p>If the two samples both come from two populations with normal distributions, the sample variances</p>
<p><span class="math display">\[S_1^2 = \frac{1}{n_1-1} \sum_{i=1}^{n_1} (X_{1i}-\bar X_1)^2\\
S_2^2 = \frac{1}{n_2-1} \sum_{i=1}^{n_2} (X_{2i}-\bar X_2)^2\]</span></p>
<p>It can be shown that <span class="math inline">\(\frac{(n_1-1)S_1^2}{\sigma_1^2} \sim \chi^2(n_1-1)\)</span> and <span class="math inline">\(\frac{(n_2-1)S_2^2}{\sigma_2^2} \sim \chi^2(n_2-1)\)</span>.</p>
<p>Hence, the test statistic for comparing the variances of two groups</p>
<p><span class="math display">\[F = \frac{S_1^2}{S_2^2}\]</span>
is <span class="math inline">\(F\)</span>-distributed with <span class="math inline">\(n_1-1\)</span> and <span class="math inline">\(n_2-1\)</span> degrees of freedom.</p>
<p>In R a test of equal variances can be performed using the function <code>var.test</code>.</p>
</div>
</div>
<div id="exercises-hypothesis-tests-parametric" class="section level2 unnumbered">
<h2>Exercises: Hypothesis tests, parametric</h2>

<div class="exercise">
<span id="exr:Hb" class="exercise"><strong>Exercise 4.3  </strong></span>The hemoglobin value (Hb) in women is on average 140 g/L. You observe the following Hb values in a set of five male blood donors: 154, 140, 147, 162, 172. Assume that Hb is normally distributed. Is there a reason to believe that the mean Hb value in men differ from that in women?
</div>

<div class="exercise">
<span id="exr:Hb2" class="exercise"><strong>Exercise 4.4  </strong></span>The hemoglobin value (Hb) in men is on average 188 g/L. The Hb values in <a href="session-inference.html#exr:Hb2">4.4</a> were actually measured after the men had donated blood. Is there a reason to believe that the mean Hb level after blood donation is less than 188 g/L?
</div>

<div class="exercise">
<span id="exr:Hb3" class="exercise"><strong>Exercise 4.5  </strong></span>By observing the Hb values in 5 male blood donors; 154, 140, 147, 162, 172 g/L, and 5 female blood donors: 123, 140, 137, 132, 127 g/L, is there a reason to believe that the Hb level is higher in men than in women?
</div>

<div class="exercise">
<span id="exr:mice12" class="exercise"><strong>Exercise 4.6  </strong></span>In order to study the effect of high-fat diet 12 mice are fed normal diet (control group) and 12 mice are fed high-fat diet. After a couple of weeks the mouse weights in gram are recorded;
</div>
<table class="table" style="font-size: 14px; margin-left: auto; margin-right: auto;">
<tbody>
<tr>
<td style="text-align:left;">
high-fat
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
23
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
31
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
39
</td>
<td style="text-align:right;">
26
</td>
<td style="text-align:right;">
36
</td>
<td style="text-align:right;">
29
</td>
<td style="text-align:right;">
23
</td>
<td style="text-align:right;">
32
</td>
</tr>
<tr>
<td style="text-align:left;">
ordinary
</td>
<td style="text-align:right;">
27
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:right;">
23
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
37
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
26
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
26
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
24
</td>
</tr>
</tbody>
</table>
<p>Does high fat diet increase body weight in mice?</p>
<ol style="list-style-type: lower-alpha">
<li>Assume equal variances.</li>
<li>Don’t assume equal variances.</li>
</ol>
<!-- Exercise, known $\sigma$ -->
<!-- If the means of the populations are unknown, but the standard variations are known -->
<!-- Let's assume that both mouse body weights in control and treatment groups are independent and normally distributed, with unknown mean, but known standard deviations, $\sigma_1=3.4$ and $\sigma_2=5.1$. -->
<!-- ```{r echo=F, eval=FALSE} -->
<!-- ## Our observed value -->
<!-- dobs -->
<!-- ## The p-value -->
<!-- 1-pnorm(dobs, mean=0, sd=sqrt(5.1^2/12 + 3.4^2/12)) -->
<!-- 1-pnorm((dobs-0)/sqrt(5.1^2/12 + 3.4^2/12)) -->
<!-- pnorm(dobs, mean=0, sd=sqrt(5.1^2/12 + 3.4^2/12), lower.tail=FALSE) -->
<!-- pnorm((dobs-0)/sqrt(5.1^2/12 + 3.4^2/12), lower.tail=FALSE) -->
<!-- ``` -->
<div id="solutions-hypothesis-tests-parametric" class="section level3 unnumbered">
<h3>Solutions: Hypothesis tests, parametric</h3>
<p><a href="session-inference.html#exr:Hb">4.3</a></p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="session-inference.html#cb127-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">154</span>, <span class="dv">140</span>, <span class="dv">147</span>, <span class="dv">162</span>, <span class="dv">172</span>)</span>
<span id="cb127-2"><a href="session-inference.html#cb127-2" aria-hidden="true" tabindex="-1"></a><span class="do">## sample mean</span></span>
<span id="cb127-3"><a href="session-inference.html#cb127-3" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)</span>
<span id="cb127-4"><a href="session-inference.html#cb127-4" aria-hidden="true" tabindex="-1"></a><span class="do">## standard error of mean</span></span>
<span id="cb127-5"><a href="session-inference.html#cb127-5" aria-hidden="true" tabindex="-1"></a>SE <span class="ot">&lt;-</span> <span class="fu">sd</span>(x)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">5</span>)</span>
<span id="cb127-6"><a href="session-inference.html#cb127-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Observed value of test statistic</span></span>
<span id="cb127-7"><a href="session-inference.html#cb127-7" aria-hidden="true" tabindex="-1"></a>tobs <span class="ot">&lt;-</span> (m<span class="dv">-140</span>)<span class="sc">/</span>SE</span>
<span id="cb127-8"><a href="session-inference.html#cb127-8" aria-hidden="true" tabindex="-1"></a><span class="do">## P(t&gt;tobs)</span></span>
<span id="cb127-9"><a href="session-inference.html#cb127-9" aria-hidden="true" tabindex="-1"></a><span class="fu">pt</span>(tobs, <span class="at">df=</span><span class="dv">4</span>, <span class="at">lower.tail=</span><span class="cn">FALSE</span>)</span></code></pre></div>
<pre><code>## [1] 0.0277</code></pre>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="session-inference.html#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="do">## p = P(t&gt;tobs) + P(t&lt;-tobs) = 2 * P(t&gt;tobs)</span></span>
<span id="cb129-2"><a href="session-inference.html#cb129-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">pt</span>(tobs, <span class="at">df=</span><span class="dv">4</span>, <span class="at">lower.tail=</span><span class="cn">FALSE</span>)</span>
<span id="cb129-3"><a href="session-inference.html#cb129-3" aria-hidden="true" tabindex="-1"></a>p</span></code></pre></div>
<pre><code>## [1] 0.05541</code></pre>
<p><a href="session-inference.html#exr:mice12">4.6</a>
a)</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="session-inference.html#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Student&#39;s t-test with pooled variances</span></span>
<span id="cb131-2"><a href="session-inference.html#cb131-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(xHF, xN, <span class="at">var.equal=</span><span class="cn">TRUE</span>, <span class="at">alternative=</span><span class="st">&quot;greater&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  Two Sample t-test
## 
## data:  xHF and xN
## t = 1, df = 22, p-value = 0.2
## alternative hypothesis: true difference in means is greater than 0
## 95 percent confidence interval:
##  -1.469    Inf
## sample estimates:
## mean of x mean of y 
##     28.00     25.83</code></pre>
<ol start="2" style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="session-inference.html#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Unequal variances with Welch approximation to the degrees of freedom (the default)</span></span>
<span id="cb133-2"><a href="session-inference.html#cb133-2" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(xHF, xN, <span class="at">var.equal=</span><span class="cn">FALSE</span>, <span class="at">alternative=</span><span class="st">&quot;greater&quot;</span>)</span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  xHF and xN
## t = 1, df = 20, p-value = 0.2
## alternative hypothesis: true difference in means is greater than 0
## 95 percent confidence interval:
##  -1.486    Inf
## sample estimates:
## mean of x mean of y 
##     28.00     25.83</code></pre>
</div>
</div>
<div id="point-and-interval-estimates" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Point and interval estimates</h2>
<p>As seen in previous chapter, the sample proportion or mean is an unbiased estimate of the population values. When we only have a sample, the sample estimate will be our best guess of the population value, but it will not be without error.</p>
<p>If we are interested in how large proportion of the Uppsala population is allergic to pollen, we can investigate this by studying a random sample. Randomly select 100 persons in Uppsala. It is important to actually sample randomly, ideally every individual should have the same probability of being sampled.</p>
<p>In our sample, we observe that 42 of the 100 has a pollen allergy. Hence, the observed sample proportion is <span class="math inline">\(p=0.42\)</span>.</p>
<!-- What does this say about the population proportion $\pi$? -->
<p>Based on this observation our point estimate of the Uppsla popultation proportion <span class="math inline">\(\pi\)</span> is <span class="math inline">\(\pi \approx p = 0.42\)</span>. We know that there is a certain uncertainty in this measurement, if the experiment is repeated we would select 100 other persons and our point estimate would be slightly different.</p>
<div id="bootstrap-interval" class="section level3" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> Bootstrap interval</h3>
<p>Using bootstrap we can sample with replacement from our sample to estimate the uncertainty.</p>
<p>Bootstrap is to use the data we have (our sample) and sample repeatedly with replacement from this data.</p>
<p>Put the entire sample in an urn!</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:pollenurn42"></span>
<img src="figures/pollenurn42.png" alt="An urn model with 42 allergy (black) and 58 non-allergy (white). The black balls represent allergic and the white balls non-allergic." width="20%" />
<p class="caption">
Figure 4.6: An urn model with 42 allergy (black) and 58 non-allergy (white). The black balls represent allergic and the white balls non-allergic.
</p>
</div>
<p>Sample from the urn with replacement to compute the bootstrap distribution.</p>
<p><img src="descprobinfe_files/figure-html/CIboot-1.png" width="45%" style="display: block; margin: auto;" /></p>
<p>Using the bootstrap distribution the uncertainty of our estimate of <span class="math inline">\(\pi\)</span> can be estimated.</p>
<p>The 95% bootstrap interval is [0.32, 0.52].</p>
<p>The bootstrap is very useful if you do not know the distribution of our sampled propery. But in our example we actually do.</p>
</div>
<div id="confidence-interval" class="section level3" number="4.3.2">
<h3><span class="header-section-number">4.3.2</span> Confidence interval</h3>
<p>A confidence interval is a type of interval estimate associated with a confidence level.</p>
<div id="confidence-interval-of-proportions" class="section level4" number="4.3.2.1">
<h4><span class="header-section-number">4.3.2.1</span> Confidence interval of proportions</h4>
<p>Remember that we can use the central limit theorem to show that</p>
<p><span class="math display">\[P \sim N\left(\pi, SE\right) \iff P \sim \left(\pi, \sqrt{\frac{\pi(1-\pi)}{n}}\right)\]</span></p>
<p>It follows that</p>
<p><span class="math display">\[Z = \frac{P - \pi}{SE} \sim N(0,1)\]</span>
Based on what we know of the standard normal distribution, we can compute an interval around the population property <span class="math inline">\(\pi\)</span> such that the probability that a sample property <span class="math inline">\(p\)</span> fall within this interval is <span class="math inline">\(1-\alpha\)</span>.</p>
<p><span class="math display">\[P(-z &lt; \frac{P - \pi}{SE} &lt; z) = 1 - \alpha\]</span>
For a 95% confidence interval z=1.96 (from a table of the standard normal distribution). Other confidence levels of interest include 90% (z=1.64) and 99% (z=2.58).</p>
<p><span class="math display">\[P\left(-z &lt; \frac{P-\pi}{SE}&lt;z\right) = \left(-z &lt; Z &lt;z\right) = 1-\alpha\]</span>
We can rewrite this to</p>
<p><span class="math display">\[P\left(\pi-z SE &lt; P &lt; \pi + z SE\right) = 1-\alpha\]</span>
in other words sample fraction <span class="math inline">\(p\)</span> will fall between <span class="math inline">\(\pi \pm 1.96 SE\)</span> with 95% probability.</p>
<p>The equation can also be rewritten to
<span class="math display">\[P\left(P-z SE &lt; \pi &lt; P + z SE\right) = 1 - \alpha\]</span>
The observed confidence interval is what we get when we replace the random variable <span class="math inline">\(P\)</span> with our observed fraction,</p>
<p><span class="math display">\[p-z SE &lt; \pi &lt; p + z SE\]</span>
<span class="math display">\[\pi = p \pm z SE = p \pm z \sqrt{\frac{p(1-p)}{n}}\]</span>
The 95% confidence interval <span class="math display">\[\pi = p \pm 1.96 \sqrt{\frac{p(1-p)}{n}}\]</span></p>
<p>A 95% confidence interval will have 95% chance to cover the true value.</p>
<p><img src="descprobinfe_files/figure-html/CIallergy-1.png" width="4200" /></p>
<p>Back to our example of proportion pollen allergic in Uppsala. <span class="math inline">\(p=0.42\)</span> and <span class="math inline">\(SE=\sqrt{\frac{p(1-p)}{n}} = 0.0494\)</span>.</p>
<p>Hence, the 95% confidence interval is
<span class="math display">\[\pi = 0.42 \pm 1.96 * 0.05 = 0.42 \pm 0.092\]</span>
or
<span class="math display">\[(0.42-0.092, 0.42+0.092) = (0.32, 0.52)\]</span></p>
<div id="confidence-interval-of-mean" class="section level5" number="4.3.2.1.1">
<h5><span class="header-section-number">4.3.2.1.1</span> Confidence interval of mean</h5>
<p>The confidence interval of mean can be derived similarly.</p>
<p>The mean of a sample of <span class="math inline">\(n\)</span> independent and identically normal distributed observations <span class="math inline">\(X_i\)</span> is normally distributed;</p>
<p><span class="math display">\[\bar X \sim N(\mu, \frac{\sigma}{\sqrt{n}})\]</span></p>
<p>If <span class="math inline">\(\sigma\)</span> is unknown the statistic</p>
<p><span class="math display">\[\frac{\bar X - \mu}{\frac{\sigma}{\sqrt{n}}} \sim t(n-1)\]</span>
is t-distributed with <span class="math inline">\(n-1\)</span> degrees of freedom.</p>
<p>It follows that</p>
<p><span class="math display">\[
\begin{aligned}
P\left(-t &lt; \frac{\bar X - \mu}{\frac{\sigma}{\sqrt{n}}} &lt; t\right) = 1 - \alpha \iff \\
P\left(\bar X - t \frac{\sigma}{\sqrt{n}} &lt; \mu &lt; \bar X + t \frac{\sigma}{\sqrt{n}}\right) = 1 - \alpha
\end{aligned}
\]</span></p>
<p>The confidence interval with confidence level <span class="math inline">\(1-\alpha\)</span> is thus;</p>
<p><span class="math display">\[\mu = \bar x \pm t \frac{s}{\sqrt{n}}\]</span></p>
<p>For a 95% confidence interval and <span class="math inline">\(n=5\)</span> <span class="math inline">\(t\)</span> is 2.7764.</p>
<p>The <span class="math inline">\(t\)</span> values for different values of <span class="math inline">\(\alpha\)</span> and degrees of freedom are tabulated and can be computed in R using the function <code>qt</code>.</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="session-inference.html#cb135-1" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">5</span></span>
<span id="cb135-2"><a href="session-inference.html#cb135-2" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">=</span> <span class="fl">0.05</span></span>
<span id="cb135-3"><a href="session-inference.html#cb135-3" aria-hidden="true" tabindex="-1"></a><span class="do">## t value</span></span>
<span id="cb135-4"><a href="session-inference.html#cb135-4" aria-hidden="true" tabindex="-1"></a><span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>, <span class="at">df=</span>n<span class="dv">-1</span>)</span></code></pre></div>
<pre><code>## [1] 2.776</code></pre>
</div>
</div>
</div>
</div>
<div id="exercises-interval-estimates" class="section level2 unnumbered">
<h2>Exercises: Interval estimates</h2>

<div class="exercise">
<p><span id="exr:CIHb" class="exercise"><strong>Exercise 4.7  </strong></span>You measure the Hb value in 10 50-year old men and get the following observations; 145, 165, 134, 167, 158, 176, 156, 189, 143, 123 g/L.</p>
<ol style="list-style-type: lower-alpha">
<li>Compute a 95% bootstrap interval for the mean Hb value.</li>
<li>Compute the sample mean Hb value</li>
<li>Compute the sample variance</li>
<li>Compute the sample standard deviation</li>
<li>Assume that Hb is normally distributed and compute a 95% confidence interval for the mean Hb value.
</div></li>
</ol>

<div class="exercise">
<p><span id="exr:CIprop" class="exercise"><strong>Exercise 4.8  </strong></span>In the pollen example we calculated a 95% confidence interval.</p>
<ol style="list-style-type: lower-alpha">
<li>How can we get a narrower confidence interval?</li>
<li>We computed a 95% interval, what if we want a 90% confidence interval?</li>
<li>or a 99% confidence interval?
</div></li>
</ol>

<div class="exercise">
<p><span id="exr:CIscale" class="exercise"><strong>Exercise 4.9  </strong></span>A scale has a normally distributed error with mean 0 and standard deviation 2.3 g. You measure a sample 10 times and observe the mean weight 43 g.</p>
<ol style="list-style-type: lower-alpha">
<li>Compute a 95% confidence interval of the sample weight</li>
<li>Compute a 90% confidence interval of the sample weight
</div></li>
</ol>
<div id="solutions-1" class="section level3" number="4.3.3">
<h3><span class="header-section-number">4.3.3</span> Solutions</h3>
<p><a href="session-inference.html#exr:CIHb">4.7</a></p>
<ol style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="session-inference.html#cb137-1" aria-hidden="true" tabindex="-1"></a>obs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">145</span>, <span class="dv">165</span>, <span class="dv">134</span>, <span class="dv">167</span>, <span class="dv">158</span>, <span class="dv">176</span>, <span class="dv">156</span>, <span class="dv">189</span>, <span class="dv">143</span>, <span class="dv">123</span>)</span>
<span id="cb137-2"><a href="session-inference.html#cb137-2" aria-hidden="true" tabindex="-1"></a>mboot <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">10000</span>, {</span>
<span id="cb137-3"><a href="session-inference.html#cb137-3" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">sample</span>(obs, <span class="at">size=</span><span class="dv">10</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb137-4"><a href="session-inference.html#cb137-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(x)</span>
<span id="cb137-5"><a href="session-inference.html#cb137-5" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb137-6"><a href="session-inference.html#cb137-6" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(mboot)</span></code></pre></div>
<p><img src="descprobinfe_files/figure-html/unnamed-chunk-46-1.png" width="2100" /></p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="session-inference.html#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 05% confidence interval</span></span>
<span id="cb138-2"><a href="session-inference.html#cb138-2" aria-hidden="true" tabindex="-1"></a><span class="fu">quantile</span>(mboot, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span></code></pre></div>
<pre><code>##  2.5% 97.5% 
## 143.9 167.2</code></pre>
<ol start="2" style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="session-inference.html#cb140-1" aria-hidden="true" tabindex="-1"></a>(m <span class="ot">&lt;-</span> <span class="fu">mean</span>(obs))</span></code></pre></div>
<pre><code>## [1] 155.6</code></pre>
<ol start="3" style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="session-inference.html#cb142-1" aria-hidden="true" tabindex="-1"></a>(v <span class="ot">&lt;-</span> <span class="fu">var</span>(obs))</span></code></pre></div>
<pre><code>## [1] 395.2</code></pre>
<ol start="4" style="list-style-type: lower-alpha">
<li></li>
</ol>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="session-inference.html#cb144-1" aria-hidden="true" tabindex="-1"></a>(s <span class="ot">&lt;-</span> <span class="fu">sd</span>(obs))</span></code></pre></div>
<pre><code>## [1] 19.88</code></pre>
<ol start="5" style="list-style-type: lower-alpha">
<li>Assume that Hb is normally distributed and compute a 95% confidence interval for the mean Hb value.</li>
</ol>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="session-inference.html#cb146-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(obs)</span>
<span id="cb146-2"><a href="session-inference.html#cb146-2" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="fl">0.975</span>, <span class="at">df=</span><span class="dv">9</span>)</span>
<span id="cb146-3"><a href="session-inference.html#cb146-3" aria-hidden="true" tabindex="-1"></a><span class="do">##95% confidence interval </span></span>
<span id="cb146-4"><a href="session-inference.html#cb146-4" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(m <span class="sc">-</span> t<span class="sc">*</span>s<span class="sc">/</span><span class="fu">sqrt</span>(n), m <span class="sc">+</span> t<span class="sc">*</span>s<span class="sc">/</span><span class="fu">sqrt</span>(n))</span></code></pre></div>
<pre><code>## [1] 141.4 169.8</code></pre>
<p><a href="session-inference.html#exr:CIprop">4.8</a></p>
<ol style="list-style-type: lower-alpha">
<li><p>Calculate a 90% confidence interval instead. Or sample more people than 100.</p></li>
<li><p>Change the z number,</p></li>
</ol>
<p><span class="math display">\[p \pm z * SE\]</span></p>
<p>For a 90% confidence interval use z=1.64</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="session-inference.html#cb148-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fl">0.42</span></span>
<span id="cb148-2"><a href="session-inference.html#cb148-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb148-3"><a href="session-inference.html#cb148-3" aria-hidden="true" tabindex="-1"></a>SE <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(p<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p)<span class="sc">/</span>n)</span>
<span id="cb148-4"><a href="session-inference.html#cb148-4" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="fl">0.95</span>)</span>
<span id="cb148-5"><a href="session-inference.html#cb148-5" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(p <span class="sc">-</span> z<span class="sc">*</span>SE, p <span class="sc">+</span> z<span class="sc">*</span>SE)</span></code></pre></div>
<pre><code>## [1] 0.3388 0.5012</code></pre>
<ol start="3" style="list-style-type: lower-alpha">
<li>or a 99% confidence interval?</li>
</ol>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="session-inference.html#cb150-1" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="fl">0.995</span>)</span>
<span id="cb150-2"><a href="session-inference.html#cb150-2" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(p <span class="sc">-</span> z<span class="sc">*</span>SE, p <span class="sc">+</span> z<span class="sc">*</span>SE)</span></code></pre></div>
<pre><code>## [1] 0.2929 0.5471</code></pre>
<p>@(ref:CIscale)</p>
<p>The measured weight is a random variable <span class="math inline">\(X \sim N(\mu, \sigma)\)</span>. You know that <span class="math inline">\(\sigma = 2.3\)</span>, <span class="math inline">\(\mu\)</span> is the weight of the smaple.</p>
<ol style="list-style-type: lower-alpha">
<li>Compute a 95% confidence interval of the sample weight</li>
</ol>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="session-inference.html#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 95% ciónfidence interval</span></span>
<span id="cb152-2"><a href="session-inference.html#cb152-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">42</span></span>
<span id="cb152-3"><a href="session-inference.html#cb152-3" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fl">2.3</span></span>
<span id="cb152-4"><a href="session-inference.html#cb152-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb152-5"><a href="session-inference.html#cb152-5" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="fl">0.975</span>)</span>
<span id="cb152-6"><a href="session-inference.html#cb152-6" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(m <span class="sc">-</span> z<span class="sc">*</span>sigma<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">10</span>), m <span class="sc">+</span> z<span class="sc">*</span>sigma<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">10</span>))</span></code></pre></div>
<pre><code>## [1] 40.57 43.43</code></pre>
<ol start="2" style="list-style-type: lower-alpha">
<li>Compute a 90% confidence interval of the sample weight</li>
</ol>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="session-inference.html#cb154-1" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="fl">0.95</span>)</span>
<span id="cb154-2"><a href="session-inference.html#cb154-2" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(m <span class="sc">-</span> z<span class="sc">*</span>sigma<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">10</span>), m <span class="sc">+</span> z<span class="sc">*</span>sigma<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">10</span>))</span></code></pre></div>
<pre><code>## [1] 40.8 43.2</code></pre>
<p>@(ref:BMCsmokers)</p>
<p>You observe 150 students at BMC of which 25 are smokers. Compute a 95% confidence interval for the proportion of smokers among BMC students.</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="session-inference.html#cb156-1" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">25</span><span class="sc">/</span><span class="dv">150</span></span>
<span id="cb156-2"><a href="session-inference.html#cb156-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">150</span></span>
<span id="cb156-3"><a href="session-inference.html#cb156-3" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span><span class="fu">qnorm</span>(<span class="fl">0.975</span>)</span>
<span id="cb156-4"><a href="session-inference.html#cb156-4" aria-hidden="true" tabindex="-1"></a>SE <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(p<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p)<span class="sc">/</span>n)</span>
<span id="cb156-5"><a href="session-inference.html#cb156-5" aria-hidden="true" tabindex="-1"></a><span class="do">## 95% CI</span></span>
<span id="cb156-6"><a href="session-inference.html#cb156-6" aria-hidden="true" tabindex="-1"></a><span class="fu">c</span>(p <span class="sc">-</span> z<span class="sc">*</span>SE, p <span class="sc">+</span> z<span class="sc">*</span>SE)</span></code></pre></div>
<pre><code>## [1] 0.1070 0.2263</code></pre>
</div>
</div>
<div id="multiple-testing" class="section level2" number="4.4">
<h2><span class="header-section-number">4.4</span> Multiple testing</h2>
<div id="error-types" class="section level3" number="4.4.1">
<h3><span class="header-section-number">4.4.1</span> Error types</h3>
<table class="table" style="font-size: 14px; margin-left: auto; margin-right: auto;">
<tbody>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Accept H0
</td>
<td style="text-align:left;">
Reject H0
</td>
</tr>
<tr>
<td style="text-align:left;">
H0 is true
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Type I error, false alarm
</td>
</tr>
<tr>
<td style="text-align:left;">
H0 is false
</td>
<td style="text-align:left;">
Type II error, miss
</td>
<td style="text-align:left;">
</td>
</tr>
</tbody>
</table>
<table class="table" style="font-size: 14px; margin-left: auto; margin-right: auto;">
<tbody>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Accept H0
</td>
<td style="text-align:left;">
Reject H0
</td>
</tr>
<tr>
<td style="text-align:left;">
H0 is true
</td>
<td style="text-align:left;">
TN
</td>
<td style="text-align:left;">
FP
</td>
</tr>
<tr>
<td style="text-align:left;">
H0 is false
</td>
<td style="text-align:left;">
FN
</td>
<td style="text-align:left;">
TP
</td>
</tr>
</tbody>
</table>
<p>Significance level</p>
<p><span class="math display">\[P(\mbox{reject }\,H_0 | H_0 \,\mbox{is true}) = P(\mbox{type I error}) = \alpha\]</span></p>
<p>Statistical power</p>
<p><span class="math display">\[P(\mbox{reject } H_0 | H_1 \mbox{ is true}) = P(\mbox{reject } H_0 | H_0 \mbox{ is false}) = 1 - P(\mbox{type II error})\]</span></p>
<div id="perform-one-test" class="section level4" number="4.4.1.1">
<h4><span class="header-section-number">4.4.1.1</span> Perform one test:</h4>
<ul>
<li>P(One type I error) = <span class="math inline">\(\alpha\)</span></li>
<li>P(No type I error) = <span class="math inline">\(1 - \alpha\)</span></li>
</ul>
</div>
<div id="perform-m-independent-tests" class="section level4" number="4.4.1.2">
<h4><span class="header-section-number">4.4.1.2</span> Perform <span class="math inline">\(m\)</span> independent tests:</h4>
<ul>
<li>P(No type I errors in <span class="math inline">\(m\)</span> tests) = <span class="math inline">\((1 - \alpha)^m\)</span></li>
<li>P(At least one type I error in <span class="math inline">\(m\)</span> tests) = <span class="math inline">\(1 - (1 - \alpha)^m\)</span></li>
</ul>
<p><img src="descprobinfe_files/figure-html/multiple-1.png" width="50%" style="display: block; margin: auto;" /></p>
<ul>
<li>FWER: family-wise error rate, probability of one or more false positive, e.g. Bonferroni, Holm</li>
<li>FDR: false discovery rate, proportion of false positives among hits, e.g. Benjamini-Hochberg, Storey</li>
</ul>
</div>
</div>
<div id="bonferroni-correction" class="section level3" number="4.4.2">
<h3><span class="header-section-number">4.4.2</span> Bonferroni correction</h3>
<p>To achieve a family-wise error rate of <span class="math inline">\(\leq \alpha\)</span> when performing <span class="math inline">\(m\)</span> tests, declare significance and reject the null hypothesis for any test with <span class="math inline">\(p \leq \alpha/m\)</span>.</p>
<p>Objections: too conservative</p>
</div>
<div id="benjamini-hochbergs-fdr" class="section level3" number="4.4.3">
<h3><span class="header-section-number">4.4.3</span> Benjamini-Hochbergs FDR</h3>
<table class="table" style="font-size: 14px; margin-left: auto; margin-right: auto;">
<tbody>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
H0 is true
</td>
<td style="text-align:left;">
H0 is false
</td>
</tr>
<tr>
<td style="text-align:left;">
Accept H0
</td>
<td style="text-align:left;">
TN
</td>
<td style="text-align:left;">
FN
</td>
</tr>
<tr>
<td style="text-align:left;">
Reject H0
</td>
<td style="text-align:left;">
FP
</td>
<td style="text-align:left;">
TP
</td>
</tr>
</tbody>
</table>
<p>The false discovery rate is the proportion of false positives among ‘hits’, i.e. <span class="math inline">\(\frac{FP}{TP+FP}\)</span>.</p>
<p>Benjamini-Hochberg’s method control the FDR level, <span class="math inline">\(\gamma\)</span>, when performing <span class="math inline">\(m\)</span> <em>independent</em> tests, as follows:</p>
<ol style="list-style-type: decimal">
<li>Sort the p-values <span class="math inline">\(p_1 \leq p_2 \leq \dots \leq p_m\)</span>.</li>
<li>Find the maximum <span class="math inline">\(j\)</span> such that <span class="math inline">\(p_j \leq \gamma \frac{j}{m}\)</span>.</li>
<li>Declare significance for all tests <span class="math inline">\(1, 2, \dots, j\)</span>.</li>
</ol>
</div>
<div id="adjusted-p-values" class="section level3" number="4.4.4">
<h3><span class="header-section-number">4.4.4</span> ‘Adjusted’ p-values</h3>
<p>Sometimes an adjusted significance threshold is not reported, but instead ‘adjusted’ p-values are reported.</p>
<ul>
<li><p>Using Bonferroni’s method the ‘adjusted’ p-values are:</p>
<p><span class="math inline">\(\tilde p_i = \min(m p_i, 1)\)</span>.</p></li>
</ul>
<p>A feature’s adjusted p-value represents the smallest FWER at which the null hypothesis will be rejected, i.e. the feature will be deemed significant.</p>
<ul>
<li><p>Benjamini-Hochberg’s ‘adjusted’ p-values are called <span class="math inline">\(q\)</span>-values:</p>
<p><span class="math inline">\(q_i = \min(\frac{m}{i} p_i, 1)\)</span></p>
<p>A feature’s <span class="math inline">\(q\)</span>-value can be interpreted as the lowest FDR at which the corresponding null hypothesis will be rejected, i.e. the feature will be deemed significant.</p></li>
</ul>
</div>
<div id="example-10000-independent-tests-e.g.-genes" class="section level3 unnumbered">
<h3>Example, 10000 independent tests (e.g. genes)</h3>
<table>
<thead>
<tr>
<th style="text-align:left;">
p-value
</th>
<th style="text-align:right;">
adj p (Bonferroni)
</th>
<th style="text-align:right;">
q-value (B-H)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
1.7e-08
</td>
<td style="text-align:right;">
0.0002
</td>
<td style="text-align:right;">
0.0002
</td>
</tr>
<tr>
<td style="text-align:left;">
5.8e-08
</td>
<td style="text-align:right;">
0.0006
</td>
<td style="text-align:right;">
0.0003
</td>
</tr>
<tr>
<td style="text-align:left;">
3.4e-07
</td>
<td style="text-align:right;">
0.0034
</td>
<td style="text-align:right;">
0.0011
</td>
</tr>
<tr>
<td style="text-align:left;">
9.1e-07
</td>
<td style="text-align:right;">
0.0091
</td>
<td style="text-align:right;">
0.0020
</td>
</tr>
<tr>
<td style="text-align:left;">
1e-06
</td>
<td style="text-align:right;">
0.0100
</td>
<td style="text-align:right;">
0.0020
</td>
</tr>
<tr>
<td style="text-align:left;">
2.4e-06
</td>
<td style="text-align:right;">
0.0240
</td>
<td style="text-align:right;">
0.0040
</td>
</tr>
<tr>
<td style="text-align:left;">
2.3e-05
</td>
<td style="text-align:right;">
0.2300
</td>
<td style="text-align:right;">
0.0329
</td>
</tr>
<tr>
<td style="text-align:left;">
3.6e-05
</td>
<td style="text-align:right;">
0.3600
</td>
<td style="text-align:right;">
0.0450
</td>
</tr>
<tr>
<td style="text-align:left;">
0.00022
</td>
<td style="text-align:right;">
1.0000
</td>
<td style="text-align:right;">
0.2300
</td>
</tr>
<tr>
<td style="text-align:left;">
0.00023
</td>
<td style="text-align:right;">
1.0000
</td>
<td style="text-align:right;">
0.2300
</td>
</tr>
<tr>
<td style="text-align:left;">
0.00073
</td>
<td style="text-align:right;">
1.0000
</td>
<td style="text-align:right;">
0.6636
</td>
</tr>
<tr>
<td style="text-align:left;">
0.0032
</td>
<td style="text-align:right;">
1.0000
</td>
<td style="text-align:right;">
1.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
0.0045
</td>
<td style="text-align:right;">
1.0000
</td>
<td style="text-align:right;">
1.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
0.0087
</td>
<td style="text-align:right;">
1.0000
</td>
<td style="text-align:right;">
1.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
0.0089
</td>
<td style="text-align:right;">
1.0000
</td>
<td style="text-align:right;">
1.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
0.012
</td>
<td style="text-align:right;">
1.0000
</td>
<td style="text-align:right;">
1.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
0.014
</td>
<td style="text-align:right;">
1.0000
</td>
<td style="text-align:right;">
1.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
0.045
</td>
<td style="text-align:right;">
1.0000
</td>
<td style="text-align:right;">
1.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
0.08
</td>
<td style="text-align:right;">
1.0000
</td>
<td style="text-align:right;">
1.0000
</td>
</tr>
<tr>
<td style="text-align:left;">
0.23
</td>
<td style="text-align:right;">
1.0000
</td>
<td style="text-align:right;">
1.0000
</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="session-probability.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
