[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Probability Theory",
    "section": "",
    "text": "Preface\nThis repository contains teaching and learning materials prepared and used during “Introduction to biostatistics and machine learning” course, organized by NBIS, National Bioinformatics Infrastructure Sweden. The course is open for PhD students, postdoctoral researcher and other employees within Swedish universities. The materials are geared towards life scientists wanting to be able to understand and use basic statistical and machine learning methods. More about the course https://uppsala.instructure.com/courses/74597"
  },
  {
    "objectID": "index.html#learning-outcomes",
    "href": "index.html#learning-outcomes",
    "title": "Probability Theory",
    "section": "Learning outcomes",
    "text": "Learning outcomes\n\nunderstand the concept of random variables\nunderstand the concept of probability\nunderstand and learn to use resampling to compute probabilities\nunderstand the concept probability mass function\nunderstand the concept probability density function\nunderstand the concept cumulative distribution functions\nuse normal distribution\nunderstand the central limit theorem"
  },
  {
    "objectID": "prob_01intro.html#axioms-of-probability",
    "href": "prob_01intro.html#axioms-of-probability",
    "title": "1  Introduction to probability",
    "section": "1.1 Axioms of probability",
    "text": "1.1 Axioms of probability\n\n\\(0 \\leq P(E) \\leq 1\\) for any event \\(E \\subseteq S\\)\n\\(P(S) = 1\\)\nif \\(E\\), \\(F\\) are disjoint events, then \\(P(E \\cup F) = P(E) + P(F)\\)"
  },
  {
    "objectID": "prob_01intro.html#common-rules-of-probability",
    "href": "prob_01intro.html#common-rules-of-probability",
    "title": "1  Introduction to probability",
    "section": "1.2 Common rules of probability",
    "text": "1.2 Common rules of probability\nBased on the axioms the following rules of probability can be proved.\n\nComplement rule: let \\(E \\subseteq S\\) be any event, then \\(P(E') = 1 - P(E)\\)\nImpossible event: \\(P(\\emptyset)=0\\)\nProbability of a subset: let \\(E,F \\subseteq S\\) be events such that \\(E \\subseteq F\\) then \\(P(F) \\geq P(E)\\)\nAddition rule: let \\(E,F \\subseteq S\\) be any two events, then \\(P(E \\cup F) = P(E) + P(F) - P(E \\cap F)\\)"
  },
  {
    "objectID": "prob_01intro.html#conditional-probability",
    "href": "prob_01intro.html#conditional-probability",
    "title": "1  Introduction to probability",
    "section": "1.3 Conditional probability",
    "text": "1.3 Conditional probability\nLet \\(E,F \\subseteq S\\) be two events that \\(P(E)>0\\) then the conditional probability of \\(F\\) given that \\(E\\) occurs is defined to be: \\[P(F|E) = \\frac{P(E\\cap F)}{P(E)}\\]\nProduct rule follows conditional probability: let \\(E,F \\subseteq S\\) be events such that \\(P(E)>0\\) then: \\[P(E \\cap F) = P(F|E)P(E) = P(E|F)P(F)\\]"
  },
  {
    "objectID": "prob_01intro.html#the-urn-model",
    "href": "prob_01intro.html#the-urn-model",
    "title": "1  Introduction to probability",
    "section": "1.4 The urn model",
    "text": "1.4 The urn model\nThe urn model is a simple mathematical model commonly used in statistics and probability. In the urn model, objects (such as people, mice, cells, genes, molecules, etc) are represented by balls of different colors or labels. A fair coin can be represented by an urn with two balls representing the coin’s two sides; H and T. A group of people can be modeled in an urn model, if age is the variable of interest, we write the age of each person on the balls. If we instead are interested in if the people are allergic to pollen or not, we color the balls according to allergy status.\n\n\n\n\n\n\n\n(a) Fair coin\n\n\n\n\n\n\n\n(b) Age\n\n\n\n\n\n\n\n(c) Pollen allergy status\n\n\n\n\nFigure 1.1: Urn models of a fair coin, age of a group of people, and pollen allergy status of a group of people.\n\n\nIn the urn model every unit (ball) is equally likely of being selected. This means that the urn model is well suited to represent flipping a fair coin. However, a biased coin can also be modelled using an urn model, by changing the number of balls that represent each side of the coin.\nBy drawing balls from the urn with (or without) replacement, probabilities and other properties of the model can be inferred. For example, with an urn representinga population of people who are or are not allergic, the probability of randomly selecting three people who are all allergic can be determined."
  },
  {
    "objectID": "prob_01intro.html#random-variables",
    "href": "prob_01intro.html#random-variables",
    "title": "1  Introduction to probability",
    "section": "1.5 Random variables",
    "text": "1.5 Random variables\nThe outcome of a random experiment can be described by a random variable. Whenever chance is involved in the outcome of an experiment the outcome is a random variable.\nA random variable can not be predicted exactly, but the probability of all possible outcomes can be described. The sample space is the set of all possible outcomes of a random variable. Note, the sample space is not always countable.\nA random variable is usually denoted by a capital letter, \\(X, Y, Z, \\dots\\). Values collected in an experiment are observations of the random variable, usually denoted by lowercase letters \\(x, y, z, \\dots\\).\nThe sample space is the collection of all possible observation values.\nThe population is the collection of all possible observations.\nA sample is a subset of the population.\n\nExample 1.1 Paint a fair six sided dice black on one side and white on the other five sides. The outcome of throwing this dice is a random variable, \\(X\\). The possible outcomes, the sample space, is black and white. The population is all possible observations, i.e. the six sides.\n\nExample random variables and probabilites:\n\nThe weight of a random newborn baby, \\(W\\). \\(P(W>4.0kg)\\)\nThe smoking status of a random mother, \\(S\\). \\(P(S=1)\\)\nThe hemoglobin concentration in blood, \\(Hb\\). \\(P(Hb<125 g/L)\\)\nThe number of mutations in a gene\nBMI of a random man\nWeight status of a random man (underweight, normal weight, overweight, obese)\nThe result of throwing a die\n\nConditional probability can be written for example \\(P(W \\geq 3.5 | S = 1)\\), which is the probability that \\(X \\geq 3.5\\) if \\(S = 1\\), in words “the probability that a smoking mother has a baby with birth weight of 3.5 kg or more”.\nRandom variables are divided based on their data type, categorical (nominal or ordinal) or numeric (discrete or continuous)."
  },
  {
    "objectID": "prob_02discrv.html#expected-value-and-variance",
    "href": "prob_02discrv.html#expected-value-and-variance",
    "title": "2  Discrete random variables",
    "section": "2.1 Expected value and variance",
    "text": "2.1 Expected value and variance\nTwo common properties of a probability distrubution, such as a probability mass function, are the expected value and the variance.\n\nThe expected value is the average outcome of a random variable over many trials and is denoted \\(E[X]\\) or \\(\\mu\\) and can be computed by summing up all possible outcome values weighted by their probability;\n\\[E[X] = \\mu = \\sum_{i=1}^n x_i p(x_i),\\] where \\(n\\) is the number of outcomes.\nFor a uniform distribution, where every outcome has the same probability , the expected value can be computed as the sum of all outcome values divided by the total number of outcome values.\nThe expected value can also be computed as the population mean, i.e. by summing over outcome value for every object in the population (this is of course only possible if the population is countable);\n\\[E[X] = \\mu = \\frac{1}{N}\\sum_{i=1}^N x_i,\\] where \\(N\\) is the number of objects in the population.\nThe variance is a measure of spread defined as the expected value of the squared difference of the random variable and its expected value;\n\\[var(X) = \\sigma^2 = E[(X-E[X])^2] = \\sum_{i=1}^n (x_i-\\mu)^2 p(x_i).\\] The variance can also be computed by summing over the outcome value for every object in the population;\n\\[var(X) = \\sigma^2 = \\frac{1}{N}\\sum_{i=1}^N (x_i-\\mu)^2,\\] where \\(N\\) is the number of objects in the population.\nThe standard deviation is the square root of the variance. The standard deviation of a random variable is usually denoted $. The standard deviation is always positive and on the same scale as the outcome values.\n\n2.1.1 Linear transformations and combinations\n\\[E(aX) = a E(X)\\]\n\\[E(X + Y) = E(X) + E(Y)\\]\n\\[E[aX + bY] = aE[X] + bE[Y],\\] where \\(a\\) and \\(b\\) are constants.\n\\[var(aX) = a^2 var(X)\\]\nFor independent random variables X and Y\n\\[var(aX + bY) = a^2var(X) + b^2var(Y)\\]"
  },
  {
    "objectID": "prob_02discrv.html#simulate-distributions",
    "href": "prob_02discrv.html#simulate-distributions",
    "title": "2  Discrete random variables",
    "section": "2.2 Simulate distributions",
    "text": "2.2 Simulate distributions\nOnce a random variable’s probability distribution is known, probabilities, such as \\(P(X=x), P(X<x)\\) and \\(P(X \\geq x)\\), and properties, such as expected value and variance, of the random variable can be computed. If the distribution is not known, simulation might be the solution.\n\nExample 2.4 (Simulate coin toss) In a single coin toss the probabity of heads is 0.5. In 20 coin tosses, what is the probability of at least 15 heads?\n\nThe outcome of a single coin toss is a random variable, \\(X\\), with two possible outcomes \\(\\{H, T\\}\\). We know that \\(P(X=H) = 0.5\\). The random variable of interest is the number of heads in 20 coin tosses, \\(Y\\). The probability that we need to compute is \\(P(Y \\geq 15)\\).\n\n\n\n\n\nFigure 2.4: A coin toss. Urn model with one black ball (heads) and one white ball (tails).\n\n\n\n\nA single coin toss can be modelled by an urn with two balls. When a ball is drawn randomly from the urn, the probability to get the black ball (heads) is \\(P(X=H) = 0.5\\).\nIn R we can simulate random draws from an urn model using the function sample.\n\n## A single coin toss\nsample(c(\"H\", \"T\"), size=1)\n\n[1] \"T\"\n\n## Another coin toss\nsample(c(\"H\", \"T\"), size=1)\n\n[1] \"H\"\n\n\nEvery time you run sample a new coin toss is simulated.\nIf we want to simulate tossing 20 coins (or one coin 20 times) we can use the same urn model, if the ball is replaced after each draw.\nThe argument size tells the function how many balls we want to draw from the urn. To draw 20 balls from the urn, set size=20, remember to replace the ball after each draw!\n\n## 20 independent coin tosses\n(coins <- sample(c(\"H\", \"T\"), size=20, replace=TRUE))\n\n [1] \"T\" \"T\" \"T\" \"T\" \"T\" \"T\" \"T\" \"H\" \"T\" \"T\" \"H\" \"T\" \"T\" \"T\" \"T\" \"T\" \"H\" \"H\" \"T\"\n[20] \"H\"\n\n\nHow many heads did we get in the 20 random draws?\n\n## How many heads?\nsum(coins == \"H\")\n\n[1] 5\n\n\nWe can repeat this experiment (toss 20 coins and count the number of heads) several times to estimate the distribution of number of heads in 20 coin tosses.\nTo do the same thing several times we use the function replicate.\nTo simulate tossing 20 coins and counting the number of heads 10000 times, do the following;\n\nNheads <- replicate(10000, {\n  coins <- sample(c(\"H\", \"T\"), size=20, replace=TRUE)\n  sum(coins == \"H\")\n})\n\nPlot the distribution of the number of heads in a histogram.\n\nhist(Nheads, breaks=0:20-0.5)\n\n\n\n\nNow, let’s get back to the question; when tossing 20 coins, what is the probability of at least 15 heads?\n\\(P(Y \\geq 15)\\)\nCount how many times out of our 10000 experiments the number is 15 or greater\n\nsum(Nheads >= 15)\n\n[1] 178\n\n\nFrom this we conclude that\n\\(P(Y \\geq 15) =\\) 178/10000 = 0.0178\n\nResampling can also be used to compute other properties of a random variable, such as the expected variable.\nThe law of large numbers states that if the same experiment is performed many times the average of the result will be close to the expected value.\nThe coin flip is a common example in statistics, but many situations with two outcomes can be modeled using similar models. If we consider the outcome of interest succes (like heads in the coin example) and the alternative outcome failure we can for example model;\n\nDrug effect: A patient can respond to drug treatment (success) or not (failure)\nSide effect: After a treatment a patient might experience a side effect (success) or not (failure)\nTreatment or placebo: Randomly assign a study participant into treatment or placebo group\nAntibiotic resistance: A bacteria is either resistant to an antibiotic or not\n\nThe probability of success and failure can be equal, like in the coin example, but they don’t have to be equal. If the probability of a patient responding to a treatment is \\(p=0.80\\), we know that the probability of the patient not responding is \\(1-p=0.20\\), this can be modelled using an urn model with 4 black balls (cured) and 1 white ball (not cured)."
  },
  {
    "objectID": "prob_02discrv.html#parametric-discrete-distributions",
    "href": "prob_02discrv.html#parametric-discrete-distributions",
    "title": "2  Discrete random variables",
    "section": "2.3 Parametric discrete distributions",
    "text": "2.3 Parametric discrete distributions\nA discrete parametric distribution is a probability distribution described by a set of parameters. In many situations data can be assumed to follow a parametric distribution.\n\n2.3.1 Uniform\nIn a uniform distribution every possible outcome has the same probability. With \\(n\\) different outcomes, the probability for each outcome is \\(1/n\\).\n\n\n2.3.2 Bernoulli\nA Bernoulli trial is a random experiment with two outcomes; success and failure. The probability of success, \\(P(success) = p\\), is constant. The probability of failure is \\(P(failure) = 1-p\\).\nWhen coding it is convenient to code success as 1 and failure as 0.\nThe outcome of a Bernoulli trial is a discrete random variable, \\(X\\).\n\\[P(X=x) = p(x) = \\left\\{\n\\begin{array}{ll}\np & \\mathrm{if}\\,x=1\\mathrm,\\,success\\\\\n1-p & \\mathrm{if}\\,x=0\\mathrm,\\,failure\n\\end{array}\n\\right.\\]\n\n\n\nUsing the definitions of expected value and variance it can be shown that;\n\\[E[X] = p\\] \\[var(X) = p(1-p)\\]\nA Bernoulli trial can be simulated, as seen in previous section, using the function sample.\n\n\n2.3.3 Binomial\nThe number of successes in a series of independent and identical Bernoulli trials is a binomial random variable, \\(X\\).\n\\(X = \\sum_{i=0}^n Z_i,\\)\nwhere all \\(Z_i\\) describe the outcome of independent and identical Bernoulli trials with probability \\(p\\) for success (\\(P(Z_i=1) = p\\)).\nThe probability mass function of \\(X\\) is called the binomial distribution. In short we use the notation;\n\\[X \\sim Bin(n, p)\\]\nThe probability mass function is\n\\[P(X=k) = {n \\choose k} p^k (1-p)^{n-k}\\] It can be shown that\n\\[E[X] = np\\] \\[var(X) = np(1-p)\\]\nA binomial random variable is the number of successes when sampling \\(n\\) objects with replacement from an urn with objects of two types, of which the interesting type (success) has probability \\(p\\).\nThe probability mass function, \\(P(X=k)\\) can be computed using the R function dbinom and the cumulative distribution function \\(P(X \\leq k)\\) can be computed using pbinom.\nExamples fo binomial random variables;\n\nThe number of patients responding to a treatment out of \\(n\\) patients in a study, if the probability of a patient responding to treatment is \\(p\\).\nThe number of patients experiencing a side effect out of \\(n\\) patients in a study, if the probability of a side effect is \\(p\\).\nthe number of mutations in a gene of length \\(n\\), if the mutations are independent and identically distributed and the probability of a mutation at every single position is \\(p\\).\n\n\n\n2.3.4 Poisson distribution\nThe Poisson distribution describe the number of times a rare event occurs in a large number of trials. Commonly used to describe the number of events during a given time period.\nA rare disease has a very low probability for a single individual. The number of individuals in a large population that catch the disease in a certain time period can be modelled using the Poisson distribution.\nThe probability mass function has a single parameter, \\(\\lambda\\), the expected value, and can be described as;\n\\[P(X=k) = \\frac{\\lambda}{k!}e^{-\\lambda}\\]\nThe expected value \\(\\lampbda = n \\pi\\), where \\(n\\) is the number of objects sampled from the population and \\(\\pi\\) is the probability of a single object.\nThe variance is equal to the expected value;\n\\[var(X) = E[X] = \\lamba = n \\pi\\]\nThe Poisson distribution can approximate the binomial distribution if \\(n\\) is large (\\(n>10\\)) and \\(\\pi\\) is small (\\(\\pi < 0.1\\)).\nExamples of Poisson random variables;\n\nA rare disease has a very low probability for a single individual. The number of individuals in a large population that catch the disease in a certain time period is a Poisson random variable.\nNumber of reads aligned to a gene region\n\n\n\n2.3.5 Negative binomial\nA negative binomial distribution describes the number of failures that occur before a specified number of successes (\\(r\\)) has occurred, in a sequence of independent and identically distributed Bernoilli trials.\nIn R: dnbinm, pnbinom, qnbinom\n\n\n2.3.6 Geometric\nThe geometric distribution is a special case of the negative binomial distribution, where \\(r=1\\).\nIn R: dgeom, pgeom, qgeom\n\n\n2.3.7 Hypergeometric distribution\nThe hypergeometric distribution occurs when sampling \\(n\\) objects without replacement from an urn with \\(N\\) objects of two types, of which the interesting type has probability \\(p\\).\nThe probability mass function\n\\[P(X=k) = \\frac{{Np\\choose{k}}{{N-Np}\\choose{n-k}}}{N\\choose{n}}\\] can be computed in R using dhyper and the cumulative distribution function \\(P(X \\leq k)\\) can be computed using phyper.\nExamples of hypergeometric random variables;\n\nIn a student group of 25 individuals, 10 are R beginners. If 5 individuals are randomly choosen to belong to group A, the number of R beginners in group A is a hypergeometric random variable.\nA drug company is producing 1000 pills per day, 5% have an amount of active substance below an acceptable threshold. In a random sample of 10 pills, how many contain to little active substance? The number of pills with to little active substance is a hypergeometric random variable.\nYou investigate the differential expression of 10000 genes, 150 of these genes belong to the super interesting pathway XXX. You run a black-box algorithm that report 80 differentially expressed (DE) genes. If the black-box algorithm choose DE genes at random, the number of DE genes that belong to pathway XXX is a hypergeometric random variable.\n\n\n\n2.3.8 Summary of discrete distributions\nThe binomial, hypoergeometric, negative binomial and poisson distributions have similarities. For large N (large population) the hypergeometric and binomial distributions are very similar. The Poisson distribution has equal variance and mean, whereas the binomial has a variance less than the mean and the negative binomial has a variance greater than the mean.\n\n\n\n\n\nFigure 2.5: Probability mass functions for the binomial distribution (n=20, p=0.1, 0.3 or 0.5), hypergeometric distribution (N=100, n=20, p=0.1, 0.3 or 0.5), negative binomial distribution (n=20, r=n*p, p=0.1, 0.3 or 0.5) and Poisson distribution (n=20, p=0.1, 0.3 or 0.5).\n\n\n\n\nProbability mass functions, \\(P(X=x)\\), for the binomial, hypergeometric, negative binomial and Poisson distributions can in R can be computed using functions dbinom, dhyper, dnbinom and dpois, respectively.\nCumulative distribution functions, \\(P(X \\leq x)\\) can be computed using pbinom, phyper, pnbinom and ppois.\nAlso, functions for computing an \\(x\\) such that \\(P(X \\leq x) = q\\), where \\(q\\) is a probability of interest are available using qbinom, qhyper, qnbinom and qpois."
  },
  {
    "objectID": "prob_exr1_discrv_solutions.html#introduction-to-probability",
    "href": "prob_exr1_discrv_solutions.html#introduction-to-probability",
    "title": "Exercises: Discrete random variables",
    "section": "Introduction to probability",
    "text": "Introduction to probability\n\nExercise 1 (BRCA) The probability of carrying mutations (one or more) in the breast cancer gene BRCA1 is 0.01. What is the probability of not carrying any mutations in BRCA1?\n\n​HintSolution\n\n\n\n\n\nUse the rule of complement.\n\n\nAccording to the rule of complement \\(P(no\\,mutation) = 1 - P(mutations) = 1 - 0.01 = 0.99\\)\n\n\n\n\n\nExercise 2 (A coin toss) When tossing a fair coin\n\nwhat is the probability of heads?\nwhat is the probability of tails?\n\n\n​HintSolution\n\n\n\n\n\nFair = equal probabilities\n\n\nFor a fair coin the probability of heads and tails are equal; \\(P(H) = P(T)\\). According to the rule of complement \\(p(H) = 1 - P(T)\\)\nIt follows that\n\n\\(P(H) = 0.5\\)\n\\(P(T) = 0.5\\)\n\n\n\n\n\n\n\nExercise 3 (Number of children) In a region in Sweden with many children the number of children per household is between 0 and 6. The probability mass function is as follows;\n\n\n\nx\n0\n1\n2\n3\n4\n5\n6\n\n\n\n\np(x)\n0.14\n0.20\n0.27\n0.19\n0.13\n0.05\n0.02\n\n\n\nIn a randomly choosen household\n\nwhat is the probability of exactly 3 children?\nwhat is the probability of less than 3 children?\nwhat is the probability of 3 or less children?\nwhat is the probability of an even number of children?\n\nIn your answers, denote the probability with a mathematical expression (such as \\(P(X>4)\\)) and calculate its value.\n\n​Solution\n\n\n\n\n\nThe number of children in a random household is a random variable. Let \\(X\\) (a random variable) denote the number of children in a household in the studied region.\n\n\\(P(X=3) = 0.19\\)\n\\(P(X<3) = P(X=0) + P(X=1) + P(X=2) = 0.14 + 0.20 + 0.27 = 0.61\\)\n\\(P(X \\leq 3) = P(X=3) + P(X<3) = 0.19 + 0.61 = 0.80\\)\n\\(P(even\\,X) = P(X=0) + P(X=2) + P(X=4) + P(X=6) = 0.14 + 0.27 + 0.13 + 0.02 = 0.56\\)\n\n\n\n\n\n\nExercise 4 (Rolling dice) When tossing a fair six-sided dice\n\nwhat is the probability of getting 6?\nwhat is the probability of an even number?\nwhat is the probability of getting 3 or more?\nwhat is the expected value of dots on the dice?\n\n\n​HintSolution\n\n\n\n\n\nOn fair sided dice, all six sides have equal pobability.\n\n\nThe random variable, \\(X\\), describe the number of dots on the upper face of a dice.\n\n\\(P(X=6) = \\frac{1}{6}\\)\n\\(P(even\\, X) = \\frac{3}{6} = \\frac{1}{2}\\)\n\\(P(X \\geq 3) = \\frac{4}{6} = \\frac{2}{3}\\)\n\\(E[X] = 1*\\frac{1}{6} + 2*\\frac{1}{6} + 3*\\frac{1}{6} + 4*\\frac{1}{6} + 5*\\frac{1}{6} + 6*\\frac{1}{6} = 3.5\\)"
  },
  {
    "objectID": "prob_exr1_discrv_solutions.html#simulation",
    "href": "prob_exr1_discrv_solutions.html#simulation",
    "title": "Exercises: Discrete random variables",
    "section": "Simulation",
    "text": "Simulation\n\nExercise 5 In a single coin toss the probability of heads is 0.5.\nIn 20 coin tosses,\n\nwhat is the probability of exactly 15 heads?\nwhat is the probability of less than 7 heads?\nWhat is the most probable number of heads?\nwhat is the probability of 5 tails or less?\nwhat is the probability of 2 heads or less?\n\n\n​HintAnswerSolution\n\n\n\n\n\n\n\n\n\n0.015\n0.058\n10\n0.020\n0.0002\n\n\n\nSimulate as in the lecture;\n\n## A single coin toss\nsample(c(\"H\", \"T\"), size=1)\n\n[1] \"H\"\n\n## Another coin toss\nsample(c(\"H\", \"T\"), size=1)\n\n[1] \"H\"\n\n## 20 independent coin tosses\n(coins <- sample(c(\"H\", \"T\"), size=20, replace=TRUE))\n\n [1] \"T\" \"T\" \"T\" \"T\" \"H\" \"T\" \"T\" \"T\" \"T\" \"T\" \"T\" \"H\" \"H\" \"T\" \"T\" \"T\" \"T\" \"T\" \"H\"\n[20] \"T\"\n\n## How many heads did we get in these particular 20 draws?\nsum(coins == \"H\")\n\n[1] 4\n\n## The simulation is about repeating this (20 random draws and summing up the number of heads) many times. To do it 10000 times;\nNheads <- replicate(10000, {\n  coins <- sample(c(\"H\", \"T\"), size=20, replace=TRUE)\n  sum(coins == \"H\")\n})\n\n\nProbability of exactly 15 heads\n\n\n## Number of times of the 10000 with exactly 15 heads\nsum(Nheads==15)\n\n[1] 153\n\n## divide by 10000 to get the probability\nsum(Nheads==15)/10000\n\n[1] 0.0153\n\n## or compute using mean (why does this work?)\nmean(Nheads==15)\n\n[1] 0.0153\n\n\n\nProbability of less than 7 heads\n\n\nmean(Nheads<7)\n\n[1] 0.06\n\n\n\nWhat is the most probable number of heads?\n\n\n## plot the distribution and read the graph\nhist(Nheads, breaks=0:21-0.5)\n\n\n\n## or tabulate\ntable(Nheads)\n\nNheads\n   2    3    4    5    6    7    8    9   10   11   12   13   14   15   16   17 \n   2    7   31  148  412  673 1169 1638 1736 1651 1240  724  348  153   58    9 \n  18 \n   1 \n\n\n\nWhat is the probability of 5 tails or less?\n\nTo get five or less tails out of 20 throws is equal to getting 15 or more heads out of 20.\n\n## probability of 15 heads or more\nmean(Nheads>=15)\n\n[1] 0.0221\n\n\n\nwhat is the probability of 2 heads or less?\n\n\nmean(Nheads<=2)\n\n[1] 2e-04\n\nsum(Nheads<=2)\n\n[1] 2\n\n## with this low number of observations, more repeats is required to get a more accurate answer\n\nNheads <- replicate(1000000, {\n  coins <- sample(c(\"H\", \"T\"), size=20, replace=TRUE)\n  sum(coins == \"H\")\n})\nsum(Nheads<=2)\n\n[1] 205\n\nmean(Nheads<=2)\n\n[1] 0.000205\n\n\n\n\n\n\n\nExercise 6 (Randomization) In a clinical trial, enrolled patients are randomly assigned to treatment or control group with equal probability.\nFor a single patient, what is the probability of being assigned to\n\nthe treatment group?\nthe control group?\n\nIf 20 patients are enrolled in the study;\n\nwhat is the probability of exactly 15 in the treatment group?\nwhat is the probability of less than 7 in the treatment group?\nWhat is the most probable number of patients in the treatment group?\nwhat is the probability of 5 or less patients in the control group?\nwhat is the probability of 2 or less patients in the treatment group?\n\n\n​HintAnswerSolution\n\n\n\n\n\n\n\n\n\n\\(P(T)=0.5\\)\n\\(P(C) = 0.5\\)\n\n\n\nThis can be solved just as the coin toss exercise.\n\nThe probability of assigning to control (C) and treatment (T) group are equal and sum up to 1. Hence \\(P(T) = 0.5\\) and;\n\\(P(C) = 0.5\\)\n\nSimulate the assignment of patients into T or C groups.\n\n## Randomization for a single patient\nsample(c(\"T\", \"C\"), size=1)\n\n[1] \"C\"\n\n## Randomize 20 independent patients\n(patients <- sample(c(\"T\", \"c\"), size=20, replace=TRUE))\n\n [1] \"T\" \"c\" \"T\" \"T\" \"c\" \"c\" \"c\" \"T\" \"T\" \"T\" \"c\" \"c\" \"c\" \"c\" \"T\" \"T\" \"c\" \"T\" \"c\"\n[20] \"c\"\n\n## How many patients are assigned to treatment group?\nsum(patients == \"T\")\n\n[1] 9\n\n## Simulate by repeating 10000 times\nNtreat <- replicate(10000, {\n  patients <- sample(c(\"T\", \"C\"), size=20, replace=TRUE)\n  sum(patients == \"T\")\n})\n\n\nProbability of exactly 15 T\n\n\n## Proportion of the 10000 repeats with exactly 15 T\nmean(Ntreat==15)\n\n[1] 0.0138\n\n\n\nProbability of less than 7 T\n\n\nmean(Ntreat<7)\n\n[1] 0.0625\n\n\n\nWhat is the most probable number of T patients?\n\n\n## plot the distribution and read the graph\nhist(Ntreat, breaks=0:21-0.5)\n\n\n\n## or tabulate\ntable(Ntreat)\n\nNtreat\n   1    2    3    4    5    6    7    8    9   10   11   12   13   14   15   16 \n   1    1    8   43  167  405  721 1229 1525 1696 1576 1236  780  417  138   46 \n  17   18 \n  10    1 \n\n\n\nWhat is the probability of 5 C or less?\n\nTo get five or less C out of 20 throws is equal to getting 15 or more T out of 20.\n\n## probability of 15 T or more\nmean(Ntreat>=15)\n\n[1] 0.0195\n\n\n\nwhat is the probability of 2 T or less?\n\n\nmean(Ntreat<=2)\n\n[1] 2e-04\n\nsum(Ntreat<=2)\n\n[1] 2\n\n## with this low number of observations, more repeats is required to get a more accurate answer\n  \nNtreat <- replicate(1000000, {\n  patients <- sample(c(\"T\", \"C\"), size=20, replace=TRUE)\n  sum(patients == \"T\")\n})\nsum(Ntreat<=2)\n\n[1] 181\n\nmean(Ntreat<=2)\n\n[1] 0.000181\n\n\n\n\n\n\n\nExercise 7 (Ten dice) When rolling 10 six-sided dice, study the number of sixes.\n\nDefine the random variable of interest\nWhat are the possible outcomes?\nUsing simulation, estimate the probability mass function\nwhat is the probability to get at least 5 sixes?\nWhich is the most likely number of sixes?\nWhat is the probability to get exactly 2 sixes?\nOn average how many sixes do you get when throwing ten dice? \n\n\n\nExercise 8 (Bacterial colonies) In a bacterial sample, 1/6 are antibiotic resistant. From bacterial colonies on an agar plate, you randomly pick 10 colonies and investigate how many that are antibiotic resistant.\n\nDefine the random variable of interest\nWhat are the possible outcomes?\nUsing simulation, estimate the probability mass function\nwhat is the probability to get at least 5 antibiotic resistant colonies?\nWhich is the most likely number of antibioitic colonies?\nWhat is the probability to get exactly 2 antibiotic resistant colonies?\nOn average how many antibiotic resistant colonies would you get if the experiment is repeated many time? \n\n\n​HintAnswerSolution\n\n\n\n\n\n\n\n\n\n\n\n\n\\(X\\), the number of sixes when rolling 10 dice.\n\\({0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10}\\)\n\n\n\n##Simulate thowing 10 dice and counting the number of sixes.\nN <- replicate(100000, sum(sample(1:6, size=10, replace=TRUE)==6))\ntable(N)\n\nN\n    0     1     2     3     4     5     6     7     8 \n16103 32287 29183 15500  5426  1265   204    28     4 \n\n##The probability mass function\ntable(N)/length(N)\n\nN\n      0       1       2       3       4       5       6       7       8 \n0.16103 0.32287 0.29183 0.15500 0.05426 0.01265 0.00204 0.00028 0.00004 \n\nhist(N, breaks=(0:11)-0.5)\n\n\n\n\n\n0.015\n\n\nsum(N>=5)\n\n[1] 1501\n\nsum(N>=5)/length(N)\n\n[1] 0.01501\n\nmean(N>=5)\n\n[1] 0.01501\n\n\n\n1 (Use the PMF to answer this question)\n0.29\n\n\nmean(N==2)\n\n[1] 0.29183\n\n\n\n1.7\n\n\nmean(N)\n\n[1] 1.66634\n\n10*1/6\n\n[1] 1.666667\n\n\n\n\n\n\n\nExercise 9 (Cards) A deck of cards consists of 52 cards; 13 diamonds, 13 spades, 13 hearts and 13 clubs. When five cards are randomly selected (a poker hand), what is the probability of getting all hearts?\n\n​HintAnswerSolution\n\n\n\n\n\n\n\n\n0.00050\n\n\n\nN <- replicate(100000, sum(sample(rep(0:1, c(39,13)), size=5)))\nhist(N, breaks=(0:6)-.5)\n\n\n\n## P(N==5)\nmean(N==5)\n\n[1] 0.00043\n\n\n\n\n\n\n\nExercise 10 (Pollen allergy)  \n\n30% of a large population is allergic to pollen. If you randomly select 3 people to participate in your study, what is the probability than none of them will be allergic to pollen?\n\n\n​HintAnswerSolution\n\n\n\n\n\n\n\n\n\n\n\n\n## Solution using 100 replicates\nx <- replicate(100, sum(sample(c(0,0,0,0,0,0,0,1,1,1), size=3, replace=TRUE)))\ntable(x)\n\nx\n 0  1  2  3 \n43 38 18  1 \n\nmean(x==0)\n\n[1] 0.43\n\n## Solution using 1000 replicates\nx <- replicate(1000, sum(sample(c(0,0,0,0,0,0,0,1,1,1), size=3, replace=TRUE)))\ntable(x)\n\nx\n  0   1   2   3 \n345 426 205  24 \n\nmean(x==0)\n\n[1] 0.345\n\n## Solution using 100000 replicates\nx <- replicate(100000, sum(sample(c(0,0,0,0,0,0,0,1,1,1), size=3, replace=TRUE)))\ntable(x)\n\nx\n    0     1     2     3 \n34007 44291 18975  2727 \n\nmean(x==0)\n\n[1] 0.34007\n\n\n\n\n\n\nIn a class of 20 students, 6 are allergic to pollen. If you randomly select 3 of the students to participate in your study, what is the probability than none of them will be allergic to pollen?\n\n\n​HintAnswerSolution\n\n\n\n\n\n\n\n\n\n\n\n\n## Solution using 100000 replicates\nx <- replicate(100000, sum(sample(rep(c(0, 1), c(14, 6)), size=3, replace=FALSE)))\ntable(x)\n\nx\n    0     1     2     3 \n31953 47990 18296  1761 \n\nmean(x==0)\n\n[1] 0.31953\n\n\n\n\n\n\nOf the 200 persons working at a company, 60 are allergic to pollen. If you randomly select 3 people to participate in your study, what is the probability that none of them are allergic to pollen?\n\n\n​HintAnswerSolution\n\n\n\n\n\n\n\n\n\n\n\n\n## Solution using 100000 replicates\nx <- replicate(100000, sum(sample(rep(c(0, 1), c(140, 60)), size=3, replace=FALSE)))\ntable(x)\n\nx\n    0     1     2     3 \n34079 44457 18906  2558 \n\nmean(x==0)\n\n[1] 0.34079\n\n\n\n\n\n\nCompare your results in a, b and c. Did you get the same results? Why/why not?\n\n\n​HintAnswerSolution\n\n\n\n\n\n\n\n\n\n\n\nThe results differ. In a the probability of selecting an allergic person is constant, regardless of the status of previously selected persons. On the other hand in the situations in b and c, the probability of selecting an allergic person changes depending on the persons selected before."
  },
  {
    "objectID": "prob_exr1_discrv_solutions.html#parametric-discrete-distribution",
    "href": "prob_exr1_discrv_solutions.html#parametric-discrete-distribution",
    "title": "Exercises: Discrete random variables",
    "section": "Parametric discrete distribution",
    "text": "Parametric discrete distribution\n\nExercise 11 (Pollen) Do Exercise 10 again, but using parametric distributions. Compare your results.\n\n​Solution\n\n\n\n\n\n\n## 1.6 Solution using the Binomial distribution\npbinom(0, 3, 0.3)\n\n[1] 0.343\n\n## 1.7 Solution using the hypergeometric distribution\nphyper(0, 6, 20-6, 3)\n\n[1] 0.3192982\n\n## 1.8 Solution using the hypergeometric distribution\nphyper(0, 60, 200-60, 3)\n\n[1] 0.3407797\n\n\n\n\n\n\n\nExercise 12 (Gene set enrichment analysis) You have analyzed 20000 genes and a bioinformatician you are collaborating with has sent you a list of 1000 genes that she says are important. You are interested in a particular pathway A. 200 genes in pathway A are represented among the 20000 genes, 20 of these are in the bioinformaticians important list.\nIf the bioinformatician selected the 1000 genes at random, what is the probability to see 20 or more genes from pathway A in this list?\n\n​Solution\n\n\n\n\n\n\nphyper(20, 200, 20000-200, 1000, lower.tail=FALSE)\n\n[1] 0.001089567\n\n\n\n\n\n\n\nExercise 13 (Chance of meeting boss) Your boss comes in to the office three days per week. You do also come in to work three days per week. If you both choose which days to come in to work at random, what is the probability that a particular week you are in the office at the same time 0, 1, 2 or 3 days, respectively?\n\n​Solution\n\n\n\n\n\n\nx <- replicate(100000, {x<-sample(1:5, 3); y<-sample(1:5,3); length(intersect(x,y))})\ntable(x)\n\nx\n    1     2     3 \n30032 59965 10003 \n\nphyper(0:3, 3, 2, 3)\n\n[1] 0.0 0.3 0.9 1.0"
  },
  {
    "objectID": "prob_exr1_discrv_solutions.html#conditional-probability",
    "href": "prob_exr1_discrv_solutions.html#conditional-probability",
    "title": "Exercises: Discrete random variables",
    "section": "Conditional probability",
    "text": "Conditional probability\n\nExercise 14 (Diagnostic tests) A study of a method for cancer prediction is evaluated. Based on the results in the below table estimate;\n\n\n\n\npos\nneg\ntot\n\n\n\n\nnot cancer\n98\n882\n980\n\n\ncancer\n16\n4\n20\n\n\ntotal\n114\n886\n1000\n\n\n\n\nthe probability of a positive test result from a person with cancer?\nthe probability of a negative test result from a person without cancer?\nthe probability of having cancer, if the test is positive?\nthe probability of not having cancer, if the test is negative?\nConnect the four computed probabilities with the following four terms;\n\n\nSensitivity\nSpecificity\nPositive predictive value (PPV)\nNegative predictive value (NPV)\n\n\n​Solution\n\n\n\n\n\n\n\\(P(pos|cancer) = 16/20\\), sensitivity\n\\(P(neg|not cancer) = 882/980\\), specificity\n\\(P(cancer|pos) = 16/114\\), PPV\n\\(P(not cancer|neg) = 882/886\\), NPV"
  },
  {
    "objectID": "prob_03contrv.html#parametric-continuous-distributions",
    "href": "prob_03contrv.html#parametric-continuous-distributions",
    "title": "3  Continuous random variable",
    "section": "3.1 Parametric continuous distributions",
    "text": "3.1 Parametric continuous distributions\nTwo important parameters of a distribution is the expected value, \\(\\mu\\), that describe the distributions location and the variance, \\(\\sigma^2\\), that describe the spread.\nThe expected value, or population mean, is defined as;\n\\[E[X] = \\mu = \\int_{-\\infty}^\\infty x f(x) dx\\] We will learn more about the expected value and how to estimate a population mean from a sample later in the course.\nThe population variance is defined as the expected value of the squared distance from the population mean;\n\\[\\sigma^2 = E[(X-\\mu)^2] = \\int_{-\\infty}^\\infty (x-\\mu)^2 f(x) dx\\]\nThe square root of the variance is the standard deviation, \\(\\sigma\\)."
  },
  {
    "objectID": "prob_03contrv.html#normal-distribution",
    "href": "prob_03contrv.html#normal-distribution",
    "title": "3  Continuous random variable",
    "section": "3.2 Normal distribution",
    "text": "3.2 Normal distribution\nThe normal distribution (sometimes referred to as the Gaussian distribution) is a common bell-shaped probability distribution. Many continuous random variables can be described by the normal distribution or be approximated by the normal distribution.\nThe normal probability density function\n\\[f(x) = \\frac{1}{\\sqrt{2 \\pi} \\sigma} e^{-\\frac{1}{2} \\left(\\frac{x-\\mu}{\\sigma}\\right)^2}\\]\ndescribes the distribution of a normal random variable, \\(X\\), with expected value \\(\\mu\\) and standard deviation \\(\\sigma\\), \\(e\\) and \\(\\pi\\) are two common mathematical constants, \\(e \\approx 2.71828\\) and \\(\\pi \\approx 3.14159\\).\n\n\n\n\nThe bell-shaped normal distributions is symmetric around \\(\\mu\\) and \\(f(x) \\rightarrow 0\\) as \\(x \\rightarrow \\infty\\) and as \\(x \\rightarrow -\\infty\\).\nAs \\(f(x)\\) is well defined, values for the cumulative distribution function \\(F(x) = \\int_{- \\infty}^x f(x) dx\\) can be computed.\n\n\n\n\n\n\nFigure 3.4: Normal probability density function and cumulative distribution functions.\n\n\n\n\n\n\n\nFigure 3.5: Normal probability density function and cumulative distribution functions.\n\n\n\n\n\nIf \\(X\\) is normally distributed with expected value \\(\\mu\\) and standard deviation \\(\\sigma\\) we write:\n\\[X \\sim N(\\mu, \\sigma)\\]\nUsing transformation rules we can define \\(Z\\), a random variable that is standard normal distributed (mean 0 and standard deviation 1).\n\\[Z = \\frac{X-\\mu}{\\sigma}, \\, Z \\sim N(0,1)\\]\nValues for the cumulative standard normal distribution, \\(F(z)\\), are tabulated and easy to compute in R using the function pnorm.\n\n\n\n\n\nFigure 3.6: The shaded area under the curve is the tabulated value \\(P(Z \\leq z) = F(z)\\).\n\n\n\n\n\n\n\n\nTable 3.1:  Cumulative distribution function for the standard normal distribution. The table gives F(z) = P(Z < z) for standard normal Z. \n \n  \n      \n    0 \n    0.01 \n    0.02 \n    0.03 \n    0.04 \n    0.05 \n    0.06 \n    0.07 \n    0.08 \n    0.09 \n  \n \n\n  \n    0.0 \n    0.5000 \n    0.5040 \n    0.5080 \n    0.5120 \n    0.5160 \n    0.5199 \n    0.5239 \n    0.5279 \n    0.5319 \n    0.5359 \n  \n  \n    0.1 \n    0.5398 \n    0.5438 \n    0.5478 \n    0.5517 \n    0.5557 \n    0.5596 \n    0.5636 \n    0.5675 \n    0.5714 \n    0.5753 \n  \n  \n    0.2 \n    0.5793 \n    0.5832 \n    0.5871 \n    0.5910 \n    0.5948 \n    0.5987 \n    0.6026 \n    0.6064 \n    0.6103 \n    0.6141 \n  \n  \n    0.3 \n    0.6179 \n    0.6217 \n    0.6255 \n    0.6293 \n    0.6331 \n    0.6368 \n    0.6406 \n    0.6443 \n    0.6480 \n    0.6517 \n  \n  \n    0.4 \n    0.6554 \n    0.6591 \n    0.6628 \n    0.6664 \n    0.6700 \n    0.6736 \n    0.6772 \n    0.6808 \n    0.6844 \n    0.6879 \n  \n  \n    0.5 \n    0.6915 \n    0.6950 \n    0.6985 \n    0.7019 \n    0.7054 \n    0.7088 \n    0.7123 \n    0.7157 \n    0.7190 \n    0.7224 \n  \n  \n    0.6 \n    0.7257 \n    0.7291 \n    0.7324 \n    0.7357 \n    0.7389 \n    0.7422 \n    0.7454 \n    0.7486 \n    0.7517 \n    0.7549 \n  \n  \n    0.7 \n    0.7580 \n    0.7611 \n    0.7642 \n    0.7673 \n    0.7704 \n    0.7734 \n    0.7764 \n    0.7794 \n    0.7823 \n    0.7852 \n  \n  \n    0.8 \n    0.7881 \n    0.7910 \n    0.7939 \n    0.7967 \n    0.7995 \n    0.8023 \n    0.8051 \n    0.8078 \n    0.8106 \n    0.8133 \n  \n  \n    0.9 \n    0.8159 \n    0.8186 \n    0.8212 \n    0.8238 \n    0.8264 \n    0.8289 \n    0.8315 \n    0.8340 \n    0.8365 \n    0.8389 \n  \n  \n    1.0 \n    0.8413 \n    0.8438 \n    0.8461 \n    0.8485 \n    0.8508 \n    0.8531 \n    0.8554 \n    0.8577 \n    0.8599 \n    0.8621 \n  \n  \n    1.1 \n    0.8643 \n    0.8665 \n    0.8686 \n    0.8708 \n    0.8729 \n    0.8749 \n    0.8770 \n    0.8790 \n    0.8810 \n    0.8830 \n  \n  \n    1.2 \n    0.8849 \n    0.8869 \n    0.8888 \n    0.8907 \n    0.8925 \n    0.8944 \n    0.8962 \n    0.8980 \n    0.8997 \n    0.9015 \n  \n  \n    1.3 \n    0.9032 \n    0.9049 \n    0.9066 \n    0.9082 \n    0.9099 \n    0.9115 \n    0.9131 \n    0.9147 \n    0.9162 \n    0.9177 \n  \n  \n    1.4 \n    0.9192 \n    0.9207 \n    0.9222 \n    0.9236 \n    0.9251 \n    0.9265 \n    0.9279 \n    0.9292 \n    0.9306 \n    0.9319 \n  \n  \n    1.5 \n    0.9332 \n    0.9345 \n    0.9357 \n    0.9370 \n    0.9382 \n    0.9394 \n    0.9406 \n    0.9418 \n    0.9429 \n    0.9441 \n  \n  \n    1.6 \n    0.9452 \n    0.9463 \n    0.9474 \n    0.9484 \n    0.9495 \n    0.9505 \n    0.9515 \n    0.9525 \n    0.9535 \n    0.9545 \n  \n  \n    1.7 \n    0.9554 \n    0.9564 \n    0.9573 \n    0.9582 \n    0.9591 \n    0.9599 \n    0.9608 \n    0.9616 \n    0.9625 \n    0.9633 \n  \n  \n    1.8 \n    0.9641 \n    0.9649 \n    0.9656 \n    0.9664 \n    0.9671 \n    0.9678 \n    0.9686 \n    0.9693 \n    0.9699 \n    0.9706 \n  \n  \n    1.9 \n    0.9713 \n    0.9719 \n    0.9726 \n    0.9732 \n    0.9738 \n    0.9744 \n    0.9750 \n    0.9756 \n    0.9761 \n    0.9767 \n  \n  \n    2.0 \n    0.9772 \n    0.9778 \n    0.9783 \n    0.9788 \n    0.9793 \n    0.9798 \n    0.9803 \n    0.9808 \n    0.9812 \n    0.9817 \n  \n  \n    2.1 \n    0.9821 \n    0.9826 \n    0.9830 \n    0.9834 \n    0.9838 \n    0.9842 \n    0.9846 \n    0.9850 \n    0.9854 \n    0.9857 \n  \n  \n    2.2 \n    0.9861 \n    0.9864 \n    0.9868 \n    0.9871 \n    0.9875 \n    0.9878 \n    0.9881 \n    0.9884 \n    0.9887 \n    0.9890 \n  \n  \n    2.3 \n    0.9893 \n    0.9896 \n    0.9898 \n    0.9901 \n    0.9904 \n    0.9906 \n    0.9909 \n    0.9911 \n    0.9913 \n    0.9916 \n  \n  \n    2.4 \n    0.9918 \n    0.9920 \n    0.9922 \n    0.9925 \n    0.9927 \n    0.9929 \n    0.9931 \n    0.9932 \n    0.9934 \n    0.9936 \n  \n  \n    2.5 \n    0.9938 \n    0.9940 \n    0.9941 \n    0.9943 \n    0.9945 \n    0.9946 \n    0.9948 \n    0.9949 \n    0.9951 \n    0.9952 \n  \n  \n    2.6 \n    0.9953 \n    0.9955 \n    0.9956 \n    0.9957 \n    0.9959 \n    0.9960 \n    0.9961 \n    0.9962 \n    0.9963 \n    0.9964 \n  \n  \n    2.7 \n    0.9965 \n    0.9966 \n    0.9967 \n    0.9968 \n    0.9969 \n    0.9970 \n    0.9971 \n    0.9972 \n    0.9973 \n    0.9974 \n  \n  \n    2.8 \n    0.9974 \n    0.9975 \n    0.9976 \n    0.9977 \n    0.9977 \n    0.9978 \n    0.9979 \n    0.9979 \n    0.9980 \n    0.9981 \n  \n  \n    2.9 \n    0.9981 \n    0.9982 \n    0.9982 \n    0.9983 \n    0.9984 \n    0.9984 \n    0.9985 \n    0.9985 \n    0.9986 \n    0.9986 \n  \n  \n    3.0 \n    0.9987 \n    0.9987 \n    0.9987 \n    0.9988 \n    0.9988 \n    0.9989 \n    0.9989 \n    0.9989 \n    0.9990 \n    0.9990 \n  \n  \n    3.1 \n    0.9990 \n    0.9991 \n    0.9991 \n    0.9991 \n    0.9992 \n    0.9992 \n    0.9992 \n    0.9992 \n    0.9993 \n    0.9993 \n  \n  \n    3.2 \n    0.9993 \n    0.9993 \n    0.9994 \n    0.9994 \n    0.9994 \n    0.9994 \n    0.9994 \n    0.9995 \n    0.9995 \n    0.9995 \n  \n  \n    3.3 \n    0.9995 \n    0.9995 \n    0.9995 \n    0.9996 \n    0.9996 \n    0.9996 \n    0.9996 \n    0.9996 \n    0.9996 \n    0.9997 \n  \n  \n    3.4 \n    0.9997 \n    0.9997 \n    0.9997 \n    0.9997 \n    0.9997 \n    0.9997 \n    0.9997 \n    0.9997 \n    0.9997 \n    0.9998 \n  \n\n\n\n\n\n\nSome values of particular interest:\n\\[F(1.64) = 0.95\\] \\[F(1.96) = 0.975\\]\nAs the normal distribution is symmetric F(-z) = 1 - F(z)\n\\[F(-1.64) = 0.05\\] \\[F(-1.96) = 0.025\\] \\[P(-1.96 < Z < 1.96) = 0.95\\]\n\n\n\n\n\n3.2.1 Sum of two normal random variables\nIf \\(X \\sim N(\\mu_1, \\sigma_1)\\) and \\(Y \\sim N(\\mu_2, \\sigma_2)\\) are two independent normal random variables, then their sum is also a random variable:\n\\[X + Y \\sim N(\\mu_1 + \\mu_2, \\sqrt{\\sigma_1^2 + \\sigma_2^2})\\]\nand\n\\[X - Y \\sim N(\\mu_1 - \\mu_2, \\sqrt{\\sigma_1^2 + \\sigma_2^2})\\] This can be extended to the case with \\(n\\) independent and identically distributed random variables \\(X_i\\) (\\(i=1 \\dots n\\)). If all \\(X_i\\) are normally distributed with mean \\(\\mu\\) and standard deviation \\(\\sigma\\), \\(X_i \\in N(\\mu, \\sigma)\\), then the sum of all \\(n\\) random variables will also be normally distributed with mean \\(n\\mu\\) and standard deviation \\(\\sqrt{n} \\sigma\\)."
  },
  {
    "objectID": "prob_03contrv.html#central-limit-theorem",
    "href": "prob_03contrv.html#central-limit-theorem",
    "title": "3  Continuous random variable",
    "section": "3.3 Central limit theorem",
    "text": "3.3 Central limit theorem\n\nTheorem 3.1 (CLT) The sum of \\(n\\) independent and equally distributed random variables is normally distributed, if \\(n\\) is large enough.\n\nAs a result of the central limit theorem, the distribution of fractions or mean values of a sample follow the normal distribution, at least if the sample is large enough (a rule of thumb is that the sample size \\(n>30\\)).\n\n\n\n\n\nExample 3.1 (A skewed distribution) A left skewed distribution has a heavier left tail than right tail. An example might be age at death of natural causes.\n\n\n\n\n\nFigure 3.7: A left skewed distribution. Can for example show the distribution of age of a mouse who died of natural causes.\n\n\n\n\nRandomly sample 3, 5, 10, 15, 20, 30 values and compute the mean value, \\(m\\). Repeat many times to get the distribution of mean values.\n\n\n\n\n\nFigure 3.8: Distribution of sample means, where the means are computed based on random samples of sizes 3, 5, 10, 15, 20 and 30, respectively.\n\n\n\n\nNote, mean is just the sum divided by the number of samples \\(n\\)."
  },
  {
    "objectID": "prob_03contrv.html#chi2-distribution",
    "href": "prob_03contrv.html#chi2-distribution",
    "title": "3  Continuous random variable",
    "section": "3.4 \\(\\chi^2\\)-distribution",
    "text": "3.4 \\(\\chi^2\\)-distribution\nThe random variable \\(Y = \\sum_{i=1}^n X_i^2\\) is \\(\\chi^2\\) distributed with \\(n-1\\) degrees of freedom, if \\(X_i\\) are independent identically distributed random variables \\(X_i \\in N(0,1)\\).\nIn short \\(Y \\in \\chi^2(n-1)\\).\n\n\n\n\n\nFigure 3.9: The \\(\\chi^2\\)-distribution.\n\n\n\n\n::: {#exm-chisq} The sample variance \\(S^2 = \\frac{1}{n-1} \\sum_{i=1}^n (X_i-\\bar X)^2\\) is such that \\(\\frac{(n-1)S^2}{\\sigma^2}\\) is \\(\\chi^2\\) distributed with \\(n-1\\) degrees of freedom. ::"
  },
  {
    "objectID": "prob_03contrv.html#f-distribution",
    "href": "prob_03contrv.html#f-distribution",
    "title": "3  Continuous random variable",
    "section": "3.5 F-distribution",
    "text": "3.5 F-distribution\nThe ratio of two \\(\\chi^2\\)-distributed variables divided by their degrees of freedom is F-distributed\n\n\n\n\n\nFigure 3.10: The F-distribution\n\n\n\n\n\nExample 3.2 The ratio of two sample variances is F-distributed"
  },
  {
    "objectID": "prob_03contrv.html#t-distribution",
    "href": "prob_03contrv.html#t-distribution",
    "title": "3  Continuous random variable",
    "section": "3.6 t-distribution",
    "text": "3.6 t-distribution\nThe ratio of a normally distributed variable and a \\(\\chi^2\\)-distributed variable is t-distributed.\n\n\n\n\n\nFigure 3.11: The t-distribution.\n\n\n\n\n\nExample 3.3 The ratio between sample mean and sample variance is t-distributed."
  },
  {
    "objectID": "prob_03contrv.html#distributions-in-r",
    "href": "prob_03contrv.html#distributions-in-r",
    "title": "3  Continuous random variable",
    "section": "3.7 Distributions in R",
    "text": "3.7 Distributions in R\nProbability density functions for the normal, t, \\(\\chi^2\\) and F distributions can in R can be computed using functions dnorm, dt, dchisq, and df, respectively.\nCumulative distribution functions can be computed using pnorm, pt, pchisq and pf.\nAlso, functions for computing an \\(x\\) such that \\(P(X<x) = q\\), where \\(q\\) is a probability of interest are available using qnorm, qt, qchisq and qf."
  },
  {
    "objectID": "prob_04sample.html#random-sampling",
    "href": "prob_04sample.html#random-sampling",
    "title": "4  Sampling and experimental design",
    "section": "4.1 Random sampling",
    "text": "4.1 Random sampling\nIn many (most) experiments it is not feasible (or even possible) to examine the entire population. Instead a random sample is studied.\nA random sample is a random subset of individuals from a population.\nThere are different techniques for performing random sampling, two common techniques are simple random sampling and stratified random sampling.\nA simple random sample is a random subset of individuals from a population, where every individual has the same probability of being choosen. Simple random sampling can be performed using the urn model. If every individual in the population is represented by one ball, a simple random sample of size \\(n\\) can be achieved by drawing \\(n\\) balls from the urn, without replacement.\n\n\n\n\n\nIn stratified random sampling the population is first divided into subpopulations based on important attributes, e.g. sex (male/female), age (young/middle aged/old) or BMI (underweight/normal weight/overweight/obese). Simple random sampling is then performed within each subpopulation."
  },
  {
    "objectID": "prob_04sample.html#principles-of-experimental-design",
    "href": "prob_04sample.html#principles-of-experimental-design",
    "title": "4  Sampling and experimental design",
    "section": "4.2 Principles of experimental design",
    "text": "4.2 Principles of experimental design\nWhen you plan your experiment and assign experimental units to treatment/control group (or similar), it is important to consider extraneous variables, i.e. variables that are not your main interest but that might affect the studied experimental outcome or the variable of interest. These variables can be properties of the experimental units such as age, sex etc. but also variables introduced in the experiment, like batch, experiment date, laboratory personell etc.\nFundamental to experimental design are the three principles; replication, randomization and blocking.\nReplication. Replication is the repetition of the same experiment, with the same conditions. Biological replicates are measurements of different biological units under the same conditions, whereas technical replicates are repeated measurements of the same biological unit under the same conditions.\nRandomization. Experimental units are not identical, hence by assigning experimental units to treatment/control at random we can avoid unnecessary bias. It is also important to perform the measurements in random order.\n\n\nBlocking. Blocking is grouping experimental units into blocks consisting of units that are similar to one another and assigning units within a block to treatment/control at random. Blocking reduces known but irrelevant sources of variation between units and thus allows greater precision in the estimation of the source of variation under study.\nThe experimental units can be grouped into blocks according to their properies (e.g. age, sex, etc). Units within a block will be more similar than between blocks. By assigning units within a block to treatment/control at random, the variation due to differences between blocks (that are not relevant to the studied outcome) can be reduced.\nIn many retrospective studies it is not possible to assign patients into treatment/control or sick/healthy. Experimental design is still important for controling sources of variation introduced during the experiment.\nBlock what you can; randomize what you cannot."
  },
  {
    "objectID": "prob_04sample.html#sample-properties",
    "href": "prob_04sample.html#sample-properties",
    "title": "4  Sampling and experimental design",
    "section": "4.3 Sample properties",
    "text": "4.3 Sample properties\nSummary statistics can be computed for a sample, such as the sum, proportion, mean and variance.\nNotation: A random sample \\(x_1,x_2,\\dots,x_n\\) from a distribution, \\(D\\), consists of \\(n\\) observations of the independent random variables \\(X_1, X_2,\\dots,X_n\\) all with the probability distribution \\(D\\).\n\n4.3.1 Sample proportion\nThe proportion of a population with a particular property, the population proportion, is denoted \\(\\pi\\).\nThe number of individuals with the property in a simple random sample of size \\(n\\) is a random variable \\(X\\). The proportion of individuals in a sample with the property is also a random variable;\n\\[P = \\frac{X}{n}\\] with expected value \\[E[P] = \\frac{E[X]}{n} = \\frac{n\\pi}{n} = \\pi\\].\nThe sample proportion, \\(p\\), is said to be an unbiased estimate of the population proportion, as it’s expected value is the population proportion \\(\\pi\\).\n\n\n4.3.2 Sample mean\nFor a particular sample of size \\(n\\); \\(x_1, \\dots, x_n\\), the sample mean is denoted \\(m = \\bar x\\). The sample mean is calculated as;\n\\[m = \\bar x = \\frac{1}{n}\\displaystyle\\sum_{i=1}^n x_i.\\]\nNote that the mean of \\(n\\) independent identically distributed random variables, \\(X_i\\), is itself a random variable;\n\\[\\bar X = \\frac{1}{n}\\sum_{i=1}^n X_i.\\]\nIf \\(X_i\\) are normaly distributed \\(X_i \\sim N(\\mu, \\sigma)\\), then \\(\\bar X \\sim N\\left(\\mu, \\frac{\\sigma}{\\sqrt{n}}\\right)\\).\nWhen we only have a sample of size \\(n\\), the sample mean \\(m\\) is our best estimate of the population mean. It is possible to show that the sample mean is an unbiased estimate of the population mean, i.e. the average (over many size \\(n\\) samples) of the sample mean is \\(\\mu\\).\n\\[E[\\bar X] = E\\left[\\frac{1}{n}\\sum_{i=1}^n X_i\\right] = \\frac{1}{n} \\sum_{i=1}^{n} E[X_i] = \\frac{1}{n} n \\mu = E[X] = \\mu\\]\n\n\n4.3.3 Sample variance\nThe sample variance is computed as;\n\\[s^2 = \\frac{1}{n-1} \\sum_{i=1}^n (x_i-m)^2.\\]\nThe sample variance is an unbiased estimate of the population variance.\n\n\n4.3.4 Sampling distribution\nA sampling distribution is a probability distribution of a sample property. A sampling distribution is obtained by sampling many times from the studied population.\n\n\n4.3.5 Standard error\nEventhough the sample can be used to calculate unbiased estimates of the population property, the sample estimate will not be perfect. The standard deviation of the sampling distribution is called the standard error, \\(SE\\).\nFor the sample mean, \\(\\bar X\\), the variance is\n\\[E[(\\bar X - \\mu)] = var(\\bar X) = var(\\frac{1}{n}\\sum_i X_i) = \\frac{1}{n^2} \\sum_i var(X_i) = \\frac{1}{n^2} n var(X) = \\frac{\\sigma^2}{n}\\]\nThe standard error of the mean is thus;\n\\[SEM = \\frac{\\sigma}{\\sqrt{n}}\\]\nReplacing \\(\\sigma\\) with the sample standard deviation, \\(s\\), we get an estimate of the standard error of the mean;\n\\[SEM \\approx \\frac{s}{\\sqrt{n}}\\]"
  },
  {
    "objectID": "prob_exr2_contrv_solutions.html#parametric-continuous-distribution",
    "href": "prob_exr2_contrv_solutions.html#parametric-continuous-distribution",
    "title": "Exercises: Continuous random variables",
    "section": "Parametric continuous distribution",
    "text": "Parametric continuous distribution\n\nExercise 1 (The normal table) Let \\(Z \\sim N(0,1)\\) be a standard normal random variable, and compute;\n\n\\(P(Z<1.64)\\)\n\\(P(Z>-1.64)\\)\n\\(P(-1.96<Z)\\)\n\\(P(Z<2.36)\\)\nAn \\(a\\) such that \\(P(Z<a) = 0.95\\)\nA \\(b\\) such that \\(P(Z>b) = 0.975\\)\n\nNote, this exercise can be solved using the standard normal table or using the R functions pnormand qnorm.\n\n​Solution\n\n\n\n\n\n\n\\(P(Z<1.64) = P(Z \\leq 1.64) = [\\textrm{from table}] = 0.9495\\)\n\\(P(Z>-1.64) = [\\textrm{symmetry}] = P(Z<1.64) = 0.9495\\)\n\\(P(-1.96<Z) = [\\textrm{symmetry}] = P(Z<1.96) = [\\textrm{from table}] = 0.975\\)\n\\(P(Z<2.36) = [\\textrm{from table}] = 0.9909\\)\nStandard normal table gives that \\(a=1.64\\)\n\\(P(Z>b) = 0.975\\), symmetry gives that \\(P(Z<-b)=0.975\\). Look-up in the standard normal table gives that \\(-b=1.96\\), hence \\(b=-1.96\\).\n\n\n\n\n\n\nExercise 2 (Exercise in standardization/transformation) If \\(X \\sim N(3,2)\\), compute the probabilities\n\n\\(P(X<5)\\)\n\\(P(3<X<5)\\)\n\\(P(X \\geq 7)\\)\n\n\n​Solution\n\n\n\n\n\n\n\\(P(X<5) = P\\left(\\frac{X-3}{2} < \\frac{5-3}{2}\\right) = P(Z<1) = [\\textrm{from table}] = 0.8413\\)\n\\(P(3<X<5) = P\\left(\\frac{3-3}{2} < \\frac{X-3}{2} < \\frac{5-3}{2}\\right) = P(0<Z<1) = P(Z<1) - P(Z<0) = 0.8413 - 0.5000 = 0.3413\\)\n\\(P(X \\geq 7) = P\\left(\\frac{X-3}{2} \\geq \\frac{7-3}{2}\\right) = P(Z \\geq 2) = 1 - P(Z < 2) = 1 - 0.9772 = 0.0228\\)\n\n\n\n\n\n\nExercise 3 (Hemoglobin) The hemoglobin (Hb) value in a male population is normally distributed with mean 188 g/L and standard deviation 14 g/L.\n\nMen with Hb below 158 g/L are considered anemic. What is the probability of a random man being anemic?\nWhen randomly selecting 10 men from the population, what is the probability that none of them are anemic?\n\n\n​Solution\n\n\n\n\n\n\n\\(P(Hb<158) = P(Z<\\frac{158-188}{14}) = P(Z<-2.14) = [table] = 0.016\\) or use R\n\n\npnorm(158, mean=188, sd=14)\n\n[1] 0.01606229\n\n\n\nProbability of one man not being anemic; \\(1-0.016 = 0.984\\). Probability of 10 selected men not being anemic (binomial distribution) \\(0.984^{10} = 0.95\\)\n\n\n\n\n\n\nExercise 4 (Rare disease) A rare disease affects 3 in 100000 in a large population. If 10000 people are randomly selected from the population, what is the probability\n\nthat no one in the sample is affected?\nthat at least two in the sample are affected?\n\n\n​Solution\n\n\n\n\n\n\n\n\n\nn <- 10000\np <- 3/100000\nppois(0, n*p)\n\n[1] 0.7408182\n\n\n\n\n\n\nppois(1, n*p, lower.tail=FALSE)\n\n[1] 0.03693631\n\n\n\n\n\n\n\nExercise 5 (Pill) A drug company is producing a pill, with on average 12 mg of active substance. The amount of active substance is normally distributed with mean 12 mg and standard deviation 0.5 mg, if the production is without problems. Sometimes there is a problem with the production and the amount of active substance will be too high or too low, in which case the pill has to be discarded. What should the upper and lower critical values (limits for when a pill is acceptable) be in order not to discard more than 1/20 pills from a problem free production?\n\n​Solution\n\n\n\n\n\n\\(H_0: \\mu=12\\) \\(H_1: \\mu \\neq 12\\)\nSearch \\(x_{low}\\) and \\(x_{up}\\) such that \\(P(x_{low} < X < x_{up}) = 0.05\\)\nFrom table we know that \\(P(-1.96 < Z < 1.96) = 0.05\\)\n\\(Z = \\frac{X - \\mu_0}{\\sigma_0} = \\frac{X-12}{0.5}\\), hence\n\\(-1.96 < Z < 1.96 \\iff -1.96 < \\frac{X-12}{0.5} < 1.96 \\iff 12-1.96*0.5 < X < 12+1.96*0.5 \\iff 11.02 < X < 12.98\\)\nThe lower and upper critical values of active substance should be 11.02 and 12.98 mg.\n\n\n\n\n\nRandom sample\n\nExercise 6 (Exercise in distribution of sample mean) The total cholesterol in population (mg/dL) is normally distributed with \\(\\mu = 202\\) and \\(\\sigma = 40\\).\n\nHow is the sample mean of a sample of 4 persons distributed?\nWhat is the probability to see a sample mean of 260 mg/dL or higher?\nIs there reason to believe that the four persons with mean 260 mg/dL were sampled from another population with higher population mean?\n\n\n​Solution\n\n\n\n\n\n\n\\[\\bar X = \\frac{1}{4}\\sum_{i=1}^4 X_i \\\\\nX_i \\sim N(\\mu, \\sigma) \\\\\n\\bar X \\sim N\\left(\\mu, \\frac{\\sigma}{\\sqrt{n}}\\right) = N(202, 20)\n\\]\n0.0019\nYes\n\n\n\n\n\n\nExercise 7 (Amount of active substance) The amount of active substance in a pill is stated by the manufacturer to be normally distributed with mean 12 mg and standard deviation 0.5 mg. You take a sample of five pills and measure the amount of active substance to; 13.0, 12.3, 12.6, 12.5, 12.7 mg.\n[Note: a-c were already computed in the descriptive statistics session.]\n\nCompute the sample mean\nCompute the sample variance\nCompute the sample standard deviation\ncompute the standard error of mean, \\(SEM\\).\nIf the manufacturers claim is correct, what is the probability to see a sample mean as high as in a) or higher?\n\n\n​AnswerSolution\n\n\n\n\n\n\n12.62\n0.067\n0.26\n0.22\n0.0028\nSample mean\n\n\n\n\nx <- c(13.0, 12.3, 12.6, 12.5, 12.7)\nn <- length(x)\n(m <- sum(x)/n)\n\n[1] 12.62\n\n\n\nSample variance\n\n\n(s2 <- sum((x-m)^2)/(n-1))\n\n[1] 0.067\n\n\n\nSample standard deviation\n\n\n(s <- sqrt(s2))\n\n[1] 0.2588436\n\n\n\nStandard error of mean, SEM\n\n\n(SEM <- 0.5/sqrt(n))\n\n[1] 0.2236068\n\n\nNote, here the known standard deviation, \\(\\sigma=0.5\\) is used."
  }
]