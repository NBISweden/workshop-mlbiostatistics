---
title: "Exercises: Discrete random variables"
date: "2022-09-12"
output: bookdown::html_document2
---

```{r setup, echo=FALSE, message=FALSE}
## Required libraries
library(tidyverse)
library(kableExtra)
```


### Introduction to probability {-}

```{exercise, BRCA1, echo=TRUE}
The probability of carrying mutations (one or more) in the breast cancer gene BRCA1 is 0.01. What is the probability of not carrying any mutations in BRCA1?
```


```{exercise, probcoin, echo=TRUE}
When tossing a fair coin

a) what is the probability of heads?
b) what is the probability of tails?
```


```{exercise, children, echo=TRUE}
In a region in Sweden with many children the number of children per household is between 0 and 6. The probability mass function is as follows;
```
|x    |0    |1    |2    |3    |4    |5    |6    |
|:----|:----|:----|:----|:----|:----|:----|:----|
|p(x) |0.14 |0.20 |0.27 |0.19 |0.13 |0.05 |0.02 |

In a randomly choosen household

  a) what is the probability of exactly 3 children?
  b) what is the probability of less than 3 children?
  c) what is the probability of 3 or less children?
  d) what is the probability of an even number of children?
  
  In your answers, denote the probability with a mathematical expression (such as $P(X>4)$) and calculate its value.


```{exercise, probdie, echo=TRUE}
When tossing a fair six-sided die

  a) what is the probability of getting 6?
  b) what is the probability of an even number?
  c) what is the probability of getting 3 or more?
  d) what is the expected value of dots on the die?
```


### Simulation {-}

```{exercise, "Cointoss", echo=FALSE}
In a single coin toss the probability of heads is 0.5.

In 20 coin tosses,   
  
  a) what is the probability of exactly 15 heads?
  b) what is the probability of less than 7 heads?
  c) What is the most probable number of heads?
  d) what is the probability of 5 tails or less?
  e) what is the probability of 2 heads or less?
```


```{exercise, "randomization", echo=TRUE}
In a clinical trial, enrolled patients are randomly assigned to treatment or control group with equal probability.

For a single patient, what is the probability of being assigned to

  a) the treatment group?
  b) the control group?
  
  If 20 patients are enrolled in the study;

  c) what is the probability of exactly 15 in the treatment group?
  d) what is the probability of less than 7 in the treatment group?
  e) What is the most probable number of patients in the treatment group?
  f) what is the probability of 5 or less patients in the control group?
  g) what is the probability of 2 or less patients in the treatment group?
```


```{exercise, "Dice", echo=FALSE}
When rolling 10 six-sided dice, study the number of sixes.

  a) Define the random variable of interest
  b) What are the possible outcomes?
  c) Using simulation, estimate the probability mass function
  d) what is the probability to get at least 5 sixes?
  e) Which is the most likely number of sixes?
  f) What is the probability to get exactly 2 sixes?
  g) On average how many sixes do you get when throwing ten dice?
  <!-- The law of large numbers states that if the same experiment is performed many times the average of the result will be close to the expected value. -->
```

```{exercise, "Dicebacteria", echo=TRUE}
In a bacterial sample, 1/6 are antibiotic resistant. From bacterial colonies on an agar plate, you randomly pick 10 colonies and investigate how many that are antibiotic resistant.

a) Define the random variable of interest
b) What are the possible outcomes?
c) Using simulation, estimate the probability mass function
d) what is the probability to get at least 5 antibiotic resistant colonies?
e) Which is the most likely number of antibioitic colonies?
f) What is the probability to get exactly 2 antibiotic resistant colonies?
g) On average how many antibiotic resistant colonies would you get if the experiment is repeated many time?
<!-- The law of large numbers states that if the same experiment is performed many times the average of the result will be close to the expected value. -->
```


```{exercise, "Cards", echo=TRUE}
A deck of cards consists of 52 cards; 13 diamonds, 13 spades, 13 hearts and 13 clubs. When five cards are randomly selected (a poker hand), what is the probability of getting all hearts?
```


```{exercise, label="Pollen", echo=TRUE}
30% of a large population is allergic to pollen. If you randomly select 3 people to participate in your study, what is the probability than none of them will be allergic to pollen?
```


```{exercise, label="Pollen2", echo=TRUE}
In a class of 20 students, 6 are allergic to pollen. If you randomly select 3 of the students to participate in your study, what is the probability than none of them will be allergic to pollen?
```


```{exercise, label="Pollen3", echo=TRUE}
Of the 200 persons working at a company, 60 are allergic to pollen. If you randomly select 3 people to participate in your study, what is the probability that none of them are allergic to pollen?
```


```{exercise, label="Pollen4", echo=TRUE}
Compare your results in \@ref(exr:Pollen), \@ref(exr:Pollen2) and \@ref(exr:Pollen3). Did you get the same results? Why/why not?
```


### Parametric discrete distribution {-}

```{exercise, label="pollenparam", echo=TRUE}
Do exercises \@ref(exr:Pollen), \@ref(exr:Pollen2) and \@ref(exr:Pollen3) again, but using parametric distributions. Compare your results.
```



```{exercise, label="GSEA", echo=TRUE}
**Gene set enrichment analysis**
  
You have analyzed 20000 genes and a bioinformatician you are collaborating with has sent you a list of 1000 genes that she says are important. You are interested in a particular pathway A. 200 genes in pathway A are represented among the 20000 genes, 20 of these are in the bioinformaticians important list.

If the bioinformatician selected the 1000 genes at random, what is the probability to see 20 or more genes from pathway A in this list?
```


```{exercise, label="meetboss", echo=TRUE}
**Chance of meeting boss**
  
  Your boss comes in to the office three days per week. You do also come in to work three days per week. If you both choose which days to come in to work at random, what is the probability that a particular week you are in the office at the same time 0, 1, 2 or 3 days, respectively?
```


### Conditional probability {-}

```{exercise, label="diagnostictests", echo=TRUE}
**Diagnostic tests**

A study of a method for cancer prediction is evaluated. Based on the results in the below table estimate;
```

```{r diagtesttable, echo=FALSE}
kable(matrix(c(98,882,980, 16, 4, 20, 114, 886, 1000), byrow = TRUE, ncol=3, dimnames=list(c("not cancer", "cancer", "total"), c("pos", "neg", "tot")))) %>% kable_styling("striped", full_width = FALSE)
```

  a) the probability of a positive test result from a person with cancer?
  b) the probability of a negative test result from a person without cancer?
  c) the probability of having cancer, if the test is positive?
  d) the probability of not having cancer, if the test is negative?
  e) Connect the four computed probabilities with the following four terms;

- Sensitivity
- Specificity
- Positive predictive value (PPV)
- Negative predictive value (NPV)

