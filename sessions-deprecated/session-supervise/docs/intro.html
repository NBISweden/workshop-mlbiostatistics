<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.36">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Introduction to supervised learning - 1&nbsp; Introduction to supervised learning</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./knn-demo-kfolds.html" rel="next">
<link href="./index.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to supervised learning</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Introduction to supervised learning</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to supervised learning</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./knn-demo-kfolds.html" class="sidebar-item-text sidebar-link">KNN demo with k-fold cross-validation</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro-exercises.html" class="sidebar-item-text sidebar-link">Exercises</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#what-is-supervised-learning" id="toc-what-is-supervised-learning" class="nav-link active" data-scroll-target="#what-is-supervised-learning"> <span class="header-section-number">1.1</span> What is supervised learning?</a></li>
  <li><a href="#supervised-classification" id="toc-supervised-classification" class="nav-link" data-scroll-target="#supervised-classification"> <span class="header-section-number">1.2</span> Supervised classification</a></li>
  <li><a href="#knn-example" id="toc-knn-example" class="nav-link" data-scroll-target="#knn-example"> <span class="header-section-number">1.3</span> KNN example</a></li>
  <li><a href="#data-splitting" id="toc-data-splitting" class="nav-link" data-scroll-target="#data-splitting"> <span class="header-section-number">1.4</span> Data splitting</a>
  <ul class="collapse">
  <li><a href="#train-validation-test-sets" id="toc-train-validation-test-sets" class="nav-link" data-scroll-target="#train-validation-test-sets"> <span class="header-section-number">1.4.1</span> train, validation &amp; test sets</a></li>
  <li><a href="#cross-validation" id="toc-cross-validation" class="nav-link" data-scroll-target="#cross-validation"> <span class="header-section-number">1.4.2</span> cross validation</a></li>
  </ul></li>
  <li><a href="#evaluating-classification-model-performance" id="toc-evaluating-classification-model-performance" class="nav-link" data-scroll-target="#evaluating-classification-model-performance"> <span class="header-section-number">1.5</span> Evaluating Classification Model Performance</a></li>
  <li><a href="#putting-it-together-k-nearest-neighbours" id="toc-putting-it-together-k-nearest-neighbours" class="nav-link" data-scroll-target="#putting-it-together-k-nearest-neighbours"> <span class="header-section-number">1.6</span> Putting it together: k-nearest neighbours</a></li>
  <li><a href="#going-back-to-regression" id="toc-going-back-to-regression" class="nav-link" data-scroll-target="#going-back-to-regression"> <span class="header-section-number">1.7</span> Going back to regression</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to supervised learning</span></h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<section id="what-is-supervised-learning" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="what-is-supervised-learning"><span class="header-section-number">1.1</span> What is supervised learning?</h2>
<ul>
<li>When we talked earlier about PCA and clustering, we were interested in finding patterns in the data. We treated data set as a whole, using all the samples, and we did not use samples labels in any way to find the components with the highest variables (PCA) or the number of clusters (k-means).</li>
<li>In supervised learning, we are using samples <strong>labels</strong> to build (train) our models. When then use these trained models for interpretation and <strong>prediction</strong>.</li>
</ul>
</section>
<section id="supervised-classification" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="supervised-classification"><span class="header-section-number">1.2</span> Supervised classification</h2>
<ul>
<li>Classification methods are algorithms used to categorize (classify) objects based on their measurements.</li>
<li>They belong under <strong>supervised learning</strong> as we usually start off with <strong>labeled</strong> data, i.e.&nbsp;observations with measurements for which we know the label (class) of.</li>
<li>If we have a pair <span class="math inline">\(\{\mathbf{x_i}, g_i\}\)</span> for each observation <span class="math inline">\(i\)</span>, with <span class="math inline">\(g_i \in \{1, \dots, G\}\)</span> being the class label, where <span class="math inline">\(G\)</span> is the number of different classes and <span class="math inline">\(\mathbf{x_i}\)</span> a set of exploratory variables, that can be continuous, categorical or a mix of both, then we want to find a <strong>classification rule</strong> <span class="math inline">\(f(.)\)</span> (model) such that <span class="math display">\[f(\mathbf{x_i})=g_i\]</span></li>
</ul>
</section>
<section id="knn-example" class="level2 page-columns page-full" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="knn-example"><span class="header-section-number">1.3</span> KNN example</h2>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="cell-output-display page-columns page-full">
<div id="fig-knn" class="quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="intro_files/figure-html/fig-knn-1.png" class="img-fluid figure-img" width="768"></p>
<p></p><figcaption class="figure-caption margin-caption">Figure 1.1: An example of k-nearest neighbours algorithm with k=3; in the top new observation (blue) is closest to three red triangales and thus classified as a red triangle; in the bottom, a new observation (blue) is closest to 2 black dots and 1 red triangle thus classified as a black dot (majority vote)</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="data-splitting" class="level2 page-columns page-full" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="data-splitting"><span class="header-section-number">1.4</span> Data splitting</h2>
<section id="train-validation-test-sets" class="level3 page-columns page-full" data-number="1.4.1">
<h3 data-number="1.4.1" class="anchored" data-anchor-id="train-validation-test-sets"><span class="header-section-number">1.4.1</span> train, validation &amp; test sets</h3>
<ul>
<li>Part of the issue of fitting complex models to data is that the model can be continually tweaked to adapt as well as possible.</li>
<li>As a results the trained model may not be generalizable to future data due to the added complexity that only works for given unique data set, leading to so called overfitting.</li>
<li>To deal with overconfident estimation of future performance we randomly split data into training data, validation data and test data.</li>
<li>Common split strategies include 50%/25%/25% and 33%/33%/33% splits for training/validation/test respectively</li>
<li><strong>Training data</strong>: this is data used to fit (train) the classification model, i.e.&nbsp;derive the classification rule</li>
<li><strong>Validation data</strong>: this is data used to select which parameters or types of model perform best, i.e.&nbsp;to validate the performance of model parameters</li>
<li><strong>Test data</strong>: this data is used to give an estimate of future prediction performance for the model and parameters chosen</li>
</ul>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="cell-output-display page-columns page-full">
<div id="fig-data-split" class="quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figures/split.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption class="figure-caption margin-caption">Figure 1.2: Example of splitting data into train (50%), validation (25%) and test (25%) set</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="cross-validation" class="level3 page-columns page-full" data-number="1.4.2">
<h3 data-number="1.4.2" class="anchored" data-anchor-id="cross-validation"><span class="header-section-number">1.4.2</span> cross validation</h3>
<ul>
<li>It could happen that despite random splitting in train/validation/test dataset one of the subsets does not represent data. e.g.&nbsp;gets all the difficult observation to classify.</li>
<li>Or that we do not have enough data in each subset after performing the split.</li>
<li>In <strong>K-fold cross-validation</strong> we split data into <span class="math inline">\(K\)</span> roughly equal-sized parts.</li>
<li>We start by setting the validation data to be the first set of data and the training data to be all other sets.</li>
<li>We estimate the validation error rate / correct classification rate for the split.</li>
<li>We then repeat the process <span class="math inline">\(K-1\)</span> times, each time with a different part of the data set to be the validation data and the remainder being the training data.</li>
<li>We finish with <span class="math inline">\(K\)</span> different error of correct classification rates.</li>
<li>In this way, every data point has its class membership predicted once.</li>
<li>The final reported error rate is usually the average of <span class="math inline">\(K\)</span> error rates.</li>
</ul>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="cell-output-display page-columns page-full">
<div id="fig-data-split-kfold" class="quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figures/split-kfold.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption class="figure-caption margin-caption">Figure 1.3: Example of k-fold cross validaiton split (k = 3)</figcaption><p></p>
</figure>
</div>
</div>
</div>
<ul>
<li>Leave-one-out cross-validation is a special case of cross-validation where the number of folds equals the number of instances in the data set.</li>
</ul>
<div class="cell page-columns page-full" data-layout-align="center">
<div class="cell-output-display page-columns page-full">
<div id="fig-data-split-loocv" class="quarto-figure quarto-figure-center anchored page-columns page-full">
<figure class="figure page-columns page-full">
<p><img src="figures/split-loocv.png" class="img-fluid figure-img" style="width:100.0%"></p>
<p></p><figcaption class="figure-caption margin-caption">Figure 1.4: Example of LOOCV, leave-out-out cross validation</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="evaluating-classification-model-performance" class="level2" data-number="1.5">
<h2 data-number="1.5" class="anchored" data-anchor-id="evaluating-classification-model-performance"><span class="header-section-number">1.5</span> Evaluating Classification Model Performance</h2>
<ul>
<li>To train the model we need some way of evaluating how well it works so we know how to tune the model parameters, e.g.&nbsp;change the value of <span class="math inline">\(k\)</span> in KNN.</li>
<li>There are few measures being used that involve looking at the truth (labels) and comparing it to what was predicted by the model.</li>
<li>Common measures include: correct (overall) classification rate, missclassification rate, class specific rates, cross classification tables, sensitivity and specificity and ROC curves.</li>
</ul>
<p><strong>Correct (miss)classification rate</strong></p>
<ul>
<li>The simplest way to evaluate in which we count for all the <span class="math inline">\(n\)</span> predictions how many times we got the classification right.</li>
</ul>
<p><span class="math display">\[Correct\; Classifcation \; Rate = \frac{\sum_{i=1}^{n}1[f(x_i)=g_i]}{n}\]</span></p>
<p>where <span class="math inline">\(1[]\)</span> is an indicator function equal to 1 if the statement in the bracket is true and 0 otherwise</p>
<p>Missclassification Rate = 1 - Correct Classification Rate</p>
</section>
<section id="putting-it-together-k-nearest-neighbours" class="level2" data-number="1.6">
<h2 data-number="1.6" class="anchored" data-anchor-id="putting-it-together-k-nearest-neighbours"><span class="header-section-number">1.6</span> Putting it together: k-nearest neighbours</h2>
<p><strong>Algorithm</strong></p>
<ul>
<li>Decide on the value of <span class="math inline">\(k\)</span></li>
<li>Calculate the distance between the query-instance (new observation) and all the training samples</li>
<li>Sort the distances and determine the nearest neighbors based on the <span class="math inline">\(k\)</span>-th minimum distance</li>
<li>Gather the categories of the nearest neighbors</li>
<li>Use simple majority of the categories of the nearest neighbors as the prediction value of the new observation</li>
</ul>
<p><em>Euclidean distance is a classic distance used with KNN; other distance measures are also used incl.&nbsp;weighted Euclidean distance, Mahalanobis distance, Manhatan distance, maximum distance etc.</em></p>
<p><strong>choosing k</strong></p>
<ul>
<li>for problems with 2 classes, choose an odd number of <span class="math inline">\(k\)</span> to avoid ties</li>
<li>use validation data to fit the model for a series of <span class="math inline">\(k\)</span> values</li>
<li>pick the value of <span class="math inline">\(k\)</span> which results in the best model (as assessed by the method of choice, e.g.&nbsp;overall classification rate)</li>
</ul>
<p>Let’s see how it works in practice on a classical iris dataset containing measurements on petals and sepals as well as species information (setosa, versicolor, virginica)</p>
<div class="cell" data-layout-align="center" data-fig.heigth="4">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(class) <span class="co"># library with knn() function</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(splitTools) <span class="co"># load library for data splitting</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Warning: package 'splitTools' was built under R version 4.0.5</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># preview iris dataset</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(iris)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="do">##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="do">## 1          5.1         3.5          1.4         0.2  setosa</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="do">## 2          4.9         3.0          1.4         0.2  setosa</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="do">## 3          4.7         3.2          1.3         0.2  setosa</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="do">## 4          4.6         3.1          1.5         0.2  setosa</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="do">## 5          5.0         3.6          1.4         0.2  setosa</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="do">## 6          5.4         3.9          1.7         0.4  setosa</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(iris)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="do">##     Sepal.Length Sepal.Width Petal.Length Petal.Width   Species</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="do">## 145          6.7         3.3          5.7         2.5 virginica</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="do">## 146          6.7         3.0          5.2         2.3 virginica</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="do">## 147          6.3         2.5          5.0         1.9 virginica</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="do">## 148          6.5         3.0          5.2         2.0 virginica</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="do">## 149          6.2         3.4          5.4         2.3 virginica</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="do">## 150          5.9         3.0          5.1         1.8 virginica</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="co"># summary statistics</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(iris)</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a><span class="do">##   Sepal.Length    Sepal.Width     Petal.Length    Petal.Width   </span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a><span class="do">##  Min.   :4.300   Min.   :2.000   Min.   :1.000   Min.   :0.100  </span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a><span class="do">##  1st Qu.:5.100   1st Qu.:2.800   1st Qu.:1.600   1st Qu.:0.300  </span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a><span class="do">##  Median :5.800   Median :3.000   Median :4.350   Median :1.300  </span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a><span class="do">##  Mean   :5.843   Mean   :3.057   Mean   :3.758   Mean   :1.199  </span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a><span class="do">##  3rd Qu.:6.400   3rd Qu.:3.300   3rd Qu.:5.100   3rd Qu.:1.800  </span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="do">##  Max.   :7.900   Max.   :4.400   Max.   :6.900   Max.   :2.500  </span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a><span class="do">##        Species  </span></span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a><span class="do">##  setosa    :50  </span></span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a><span class="do">##  versicolor:50  </span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a><span class="do">##  virginica :50  </span></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a><span class="do">##                 </span></span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a><span class="do">##                 </span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a><span class="co"># split data into train 50%, validation 25% and test dataset 25%</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>randseed <span class="ot">&lt;-</span> <span class="dv">102</span></span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(randseed)</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>inds <span class="ot">&lt;-</span> <span class="fu">partition</span>(iris<span class="sc">$</span>Species, <span class="at">p =</span> <span class="fu">c</span>(<span class="at">train =</span> <span class="fl">0.5</span>, <span class="at">valid =</span> <span class="fl">0.25</span>, <span class="at">test =</span> <span class="fl">0.25</span>), <span class="at">seed =</span> randseed)</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(inds)</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a><span class="do">## List of 3</span></span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ train: int [1:74] 1 4 5 6 8 11 13 15 17 19 ...</span></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ valid: int [1:38] 3 10 12 18 21 27 28 30 32 33 ...</span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a><span class="do">##  $ test : int [1:38] 2 7 9 14 16 20 23 29 31 35 ...</span></span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>data.train <span class="ot">&lt;-</span> iris[inds<span class="sc">$</span>train, ]</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>data.valid <span class="ot">&lt;-</span> iris[inds<span class="sc">$</span>valid,]</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>data.test <span class="ot">&lt;-</span> iris[inds<span class="sc">$</span>test, ]</span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(data.train)</span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 74  5</span></span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(data.valid)</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 38  5</span></span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(data.test)</span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 38  5</span></span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data.train<span class="sc">$</span>Species)</span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a><span class="do">##     setosa versicolor  virginica </span></span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a><span class="do">##         24         25         25</span></span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data.valid<span class="sc">$</span>Species)</span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a><span class="do">##     setosa versicolor  virginica </span></span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a><span class="do">##         13         12         13</span></span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data.test<span class="sc">$</span>Species)</span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a><span class="do">##     setosa versicolor  virginica </span></span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a><span class="do">##         13         13         12</span></span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a><span class="co"># run knn with different values of k from 1, 3, 5 to 51</span></span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>k.values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">51</span>, <span class="dv">2</span>)</span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>class.rate <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(k.values)) <span class="co"># allocate empty vector to collect correct classification rates</span></span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (k <span class="cf">in</span> <span class="fu">seq_along</span>(k.values))</span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a>  pred.class <span class="ot">&lt;-</span> <span class="fu">knn</span>(<span class="at">train =</span> data.train[, <span class="sc">-</span><span class="dv">5</span>], </span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a>                    <span class="at">test =</span> data.valid[, <span class="sc">-</span><span class="dv">5</span>], </span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a>                    <span class="at">cl =</span> data.train[, <span class="dv">5</span>], k.values[k])</span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>  class.rate[k] <span class="ot">&lt;-</span> <span class="fu">sum</span>((pred.class<span class="sc">==</span>data.valid[,<span class="dv">5</span>]))<span class="sc">/</span><span class="fu">length</span>(pred.class)</span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a><span class="co"># for which value of k we reach the highest classification rate</span></span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>k.best <span class="ot">&lt;-</span> k.values[<span class="fu">which.max</span>(class.rate)]</span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(k.best)</span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 7</span></span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a><span class="co"># plot classification rate as a function of k</span></span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(k.values, class.rate, <span class="at">type=</span><span class="st">"l"</span>, <span class="at">xlab=</span><span class="st">"k"</span>, <span class="at">ylab=</span><span class="st">"class. rate"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="intro_files/figure-html/knn-code-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># how would our model perform on the future data using the optimal k?</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>pred.class <span class="ot">&lt;-</span> <span class="fu">knn</span>(<span class="at">train =</span> data.train[, <span class="sc">-</span><span class="dv">5</span>], data.test[, <span class="sc">-</span><span class="dv">5</span>], data.train[,<span class="dv">5</span>], <span class="at">k=</span>k.best)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>class.rate <span class="ot">&lt;-</span> <span class="fu">sum</span>((pred.class<span class="sc">==</span>data.test[,<span class="dv">5</span>]))<span class="sc">/</span><span class="fu">length</span>(pred.class)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(class.rate)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.9473684</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="going-back-to-regression" class="level2" data-number="1.7">
<h2 data-number="1.7" class="anchored" data-anchor-id="going-back-to-regression"><span class="header-section-number">1.7</span> Going back to regression</h2>
<ul>
<li>The idea of using data splits to train the model holds for fitting (training) regression models.</li>
<li>Earlier, we used the entire data set to fit the model and we used the fitted model for prediction given a new observation.</li>
<li>If we were to use regression in supervised learning context, we would use data splits to train and assess the regression model.</li>
<li>For instance, given a number of variables of interest, we could try to find the best regression model using train data to fit the model and assess on the validation data; while keeping the test to assess the performance on the final model. Or we could use cross validation (We have seen before how to fit the model and assess the model fit, e.g.&nbsp;with <span class="math inline">\(R^2\)</span>.)</li>
<li>Other popular regression performance metrics include <strong>RMSE</strong>, root mean square error <span class="math display">\[RMSE = \sqrt{\frac{1}{N}\sum_{i=1}^{N}({y_i}-\hat{y_i})^2}\]</span></li>
<li>and <strong>MAE</strong>, mean absolute error, <span class="math display">\[MAE = \frac{1}{N}\sum_{i=1}^{N}|{y_i}-\hat{y_i}|\]</span></li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./index.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Preface</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./knn-demo-kfolds.html" class="pagination-link">
        <span class="nav-page-text">KNN demo with k-fold cross-validation</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>