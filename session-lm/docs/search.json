[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Introduction to linear models",
    "section": "",
    "text": "Preface\nLinear models allows us to answer questions such as:\n\nis there a relationship between exposure and outcome, e.g. height and weight?\nhow strong is the relationship between the two variables?\nwhat will be a predicted value of the outcome given a new set of exposure values?\nhow accurately can we predict outcome?\nwhich variables are associated with the response, e.g. is it only height that explains weight or could it be height and age that are both associated with the response?\n\nLearning outcomes\n\nto understand what a linear model is and be familiar with the terminology\nto be able to state linear model in the general vector-matrix notation\nto be able to use the general vector-matrix notation to numerically estimate model parameters\nto be able to use lm() function for model fitting, parameter estimation, hypothesis testing and prediction\nto be able to evaluate model fit by interpreting \\(R^2\\) and \\(R^2(adj)\\) values\nto be able to check model assumptions\nto be able to use glm() for extending linear models into generalized linear models\n\nDo you see a mistake or a typo? I would be grateful if you let me know via olga.dethlefsen@nbis.se\nThis repository contains teaching and learning materials prepared and used during “Introduction to biostatistics and machine learning” course, organized by NBIS, National Bioinformatics Infrastructure Sweden. The course is open for PhD students, postdoctoral researcher and other employees within Swedish universities. The materials are geared towards life scientists wanting to be able to understand and use basic statistical and machine learning methods. More about the course https://nbisweden.github.io/workshop-mlbiostatistics/"
  },
  {
    "objectID": "lm-intro.html#why-linear-models",
    "href": "lm-intro.html#why-linear-models",
    "title": "1  Introduction to linear models",
    "section": "1.1 Why linear models?",
    "text": "1.1 Why linear models?\nWith linear models we can answer questions such as:\n\nis there a relationship between exposure and outcome, e.g. height and weight?\nhow strong is the relationship between the two variables?\nwhat will be a predicted value of the outcome given a new set of exposure values?\nhow accurately can we predict outcome?\nwhich variables are associated with the response, e.g. is it only height that explains weight or could it be height and age that are both associated with the response?\n\n\n\nCode\ndata_diabetes %&gt;%\n  ggplot(aes(x = height, y = weight)) + \n  geom_point() + \n  geom_smooth(method = \"lm\", se = FALSE) + \n  my.ggtheme + \n  xlab(\"height [m]\") + \n  ylab(\"weight [kg]\")\n\n\n\n\n\nFigure 1.1: Scatter plot of weight vs. height for the 130 study participants based on the diabetes data set collected to understand the prevalence of obesity, diabetes, and other cardiovascular risk factors in central Virginia, USA."
  },
  {
    "objectID": "lm-intro.html#statistical-vs.-deterministic-relationship",
    "href": "lm-intro.html#statistical-vs.-deterministic-relationship",
    "title": "1  Introduction to linear models",
    "section": "1.2 Statistical vs. deterministic relationship",
    "text": "1.2 Statistical vs. deterministic relationship\nRelationships in probability and statistics can generally be one of three things: deterministic, random, or statistical:\n\na deterministic relationship involves an exact relationship between two variables, for instance Fahrenheit and Celsius degrees is defined by an equation \\(Fahrenheit=\\frac{9}{5}\\cdot Celcius+32\\)\nthere is no relationship between variables in the random relationship, for instance number of succulents Olga buys and time of the year as Olga keeps buying succulents whenever she feels like it throughout the entire year\na statistical relationship is a mixture of deterministic and random relationship, e.g. the savings that Olga has left in the bank account depend on Olga’s monthly salary income (deterministic part) and the money spent on buying succulents (random part)\n\n\n\n\n\n\nFigure 1.2: Deterministic vs. statistical relationship: a) deterministic: equation exactly describes the relationship between the two variables e.g. Ferenheit and Celcius relationship, b) statistical relationship between \\(x\\) and \\(y\\) is not perfect (increasing relationship), c) statistical relationship between \\(x\\) and \\(y\\) is not perfect (decreasing relationship), d) random signal"
  },
  {
    "objectID": "lm-intro.html#what-linear-models-are-and-are-not",
    "href": "lm-intro.html#what-linear-models-are-and-are-not",
    "title": "1  Introduction to linear models",
    "section": "1.3 What linear models are and are not",
    "text": "1.3 What linear models are and are not\n\nIn an linear model we model (explain) the relationship between a single continuous variable \\(Y\\) and one or more variables \\(X\\). The \\(X\\) variables can be numerical, categorical or a mixture of both.\nOne very general form for the model would be: \\[Y = f(X_1, X_2, \\dots X_p) + \\epsilon\\] where \\(f\\) is some unknown function and \\(\\epsilon\\) is the error in this representation.\nFor instance a simple linear regression through the origin is a simple linear model of the form \\[Y_i = \\beta \\cdot x + \\epsilon\\] often used to express a relationship of one numerical variable to another, e.g. the calories burnt and the kilometers cycled.\nLinear models can become quite advanced by including many variables, e.g. the calories burnt could be a function of the kilometers cycled, road incline and status of a bike, or the transformation of the variables, e.g. a function of kilometers cycled squared\nFormally, linear models are a way of describing a response variable in terms of linear combination of predictor variables, i.e. expression constructed from a a set of terms by multiplying each term by a constant and/or adding the results.\nFor instance these are all models that can be constructed using linear combinations of predictors:\n\n\n\n\n\n\nFigure 1.3: Examples of a linear models: A) \\(y_i = x_1 + e_i\\), B) \\(x_1 + I_{x_i} + e_i\\) C) \\(y_i = x_i^2 + e_i\\), D) \\(y_i = x + x_i^3 + e_i\\) showing that linear models can get more complex and/or capture more than a straight line relationship.\n\n\n\n\n\n\\(Y_i = \\alpha + \\beta x_i + \\gamma y_i + \\epsilon_i\\)\n\\(Y_i = \\alpha + \\beta x_i^2 \\epsilon\\)\n\\(Y_i = \\alpha + \\beta x_i^2 + \\gamma x_i^3 + \\epsilon\\)\n\\(Y_i = \\beta_0 + \\beta_1 x_i + \\beta_2 x_i^2 + \\beta_3 y_i + \\beta_4 \\sqrt {y_i} + \\beta_5 x_i y_i + \\epsilon\\)\n\nvs. an example of a non-linear model where parameter \\(\\beta\\) appears in the exponent of \\(x_i\\)\n\n\\(Y_i = \\alpha + x_i^\\beta + \\epsilon\\)"
  },
  {
    "objectID": "lm-intro.html#terminology",
    "href": "lm-intro.html#terminology",
    "title": "1  Introduction to linear models",
    "section": "1.4 Terminology",
    "text": "1.4 Terminology\nThere are many terms and notations used interchangeably:\n\n\\(y\\) is being called:\n\nresponse\noutcome\ndependent variable\n\n\\(x\\) is being called:\n\nexposure\nexplanatory variable\ndependent variable\npredictor\ncovariate"
  },
  {
    "objectID": "lm-intro.html#simple-linear-regression",
    "href": "lm-intro.html#simple-linear-regression",
    "title": "1  Introduction to linear models",
    "section": "1.5 Simple linear regression",
    "text": "1.5 Simple linear regression\n\nIt is used to check the association between the numerical outcome and one numerical explanatory variable\nIn practice, we are finding the best-fitting straight line to describe the relationship between the outcome and exposure\n\n\nExample 1.1 (Weight and plasma volume) Let’s look at the example data containing body weight (kg) and plasma volume (liters) for eight healthy men to see what the best-fitting straight line is.\nExample data:\n\nweight &lt;- c(58, 70, 74, 63.5, 62.0, 70.5, 71.0, 66.0) # body weight (kg)\nplasma &lt;- c(2.75, 2.86, 3.37, 2.76, 2.62, 3.49, 3.05, 3.12) # plasma volume (liters)\n\n\n\n\n\n\n\nFigure 1.4: Scatter plot of the data shows that high plasma volume tends to be associated with high weight and vice verca.\n\n\n\n\n\n\n\n\n\nFigure 1.5: Scatter plot of the data shows that high plasma volume tends to be associated with high weight and vice verca. Linear regression gives the equation of the straight line (red) that best describes how the outcome changes (increase or decreases) with a change of exposure variable\n\n\n\n\nThe equation for the red line is: \\[Y_i=0.086 +  0.044 \\cdot x_i \\quad for \\;i = 1 \\dots 8\\] and in general: \\[Y_i=\\alpha + \\beta \\cdot x_i \\quad for \\; i = 1 \\dots n\\]\n\nIn other words, by finding the best-fitting straight line we are building a statistical model to represent the relationship between plasma volume (\\(Y\\)) and explanatory body weight variable (\\(x\\))\nIf we were to use our model \\(Y_i=0.086 + 0.044 \\cdot x_i\\) to find plasma volume given a weight of 58 kg (our first observation, \\(i=1\\)), we would notice that we would get \\(Y=0.086 + 0.044 \\cdot 58 = 2.638\\), not exactly \\(2.75\\) as we have for our first man in our dataset that we started with, i.e. \\(2.75 - 2.638 = 0.112 \\neq 0\\).\nWe thus add to the above equation an error term to account for this and now we can write our simple regression model more formally as:\n\n\\[Y_i = \\alpha + \\beta \\cdot x_i + \\epsilon_i \\tag{1.1}\\] where:\n\n\\(x\\): is called: exposure variable, explanatory variable, dependent variable, predictor, covariate\n\\(y\\): is called: response, outcome, dependent variable\n\\(\\alpha\\) and \\(\\beta\\) are model coefficients\nand \\(\\epsilon_i\\) is an error terms"
  },
  {
    "objectID": "lm-intro.html#least-squares",
    "href": "lm-intro.html#least-squares",
    "title": "1  Introduction to linear models",
    "section": "1.6 Least squares",
    "text": "1.6 Least squares\n\nin the above “body weight - plasma volume” example, the values of \\(\\alpha\\) and \\(\\beta\\) have just appeared\nin practice, \\(\\alpha\\) and \\(\\beta\\) values are unknown and we use data to estimate these coefficients, noting the estimates with a hat, \\(\\hat{\\alpha}\\) and \\(\\hat{\\beta}\\)\nleast squares is one of the methods of parameters estimation, i.e. finding \\(\\hat{\\alpha}\\) and \\(\\hat{\\beta}\\)\n\n\n\n\n\n\nFigure 1.6: Scatter plot of the data shows that high plasma volume tends to be associated with high weight and vice verca. Linear regrssion gives the equation of the straight line (red) that best describes how the outcome changes with a change of exposure variable. Blue lines represent error terms, the vertical distances to the regression line\n\n\n\n\n\nLet \\(\\hat{y_i}=\\hat{\\alpha} + \\hat{\\beta}x_i\\) be the prediction \\(y_i\\) based on the \\(i\\)-th value of \\(x\\):\n\nThen \\(\\epsilon_i = y_i - \\hat{y_i}\\) represents the \\(i\\)-th residual, i.e. the difference between the \\(i\\)-th observed response value and the \\(i\\)-th response value that is predicted by the linear model\nRSS, the residual sum of squares is defined as: \\[RSS = \\epsilon_1^2 + \\epsilon_2^2 + \\dots + \\epsilon_n^2\\] or equivalently as: \\[RSS=(y_1-\\hat{\\alpha}-\\hat{\\beta}x_1)^2+(y_2-\\hat{\\alpha}-\\hat{\\beta}x_2)^2+...+(y_n-\\hat{\\alpha}-\\hat{\\beta}x_n)^2\\]\nthe least squares approach chooses \\(\\hat{\\alpha}\\) and \\(\\hat{\\beta}\\) to minimize the RSS. With some calculus, a good video explanation for the interested ones is here, we get Theorem 1.1\n\n\nTheorem 1.1 (Least squares estimates for a simple linear regression) \\[\\hat{\\beta} = \\frac{S_{xy}}{S_{xx}}\\] \\[\\hat{\\alpha} = \\bar{y}-\\frac{S_{xy}}{S_{xx}}\\cdot \\bar{x}\\]\nwhere:\n\n\\(\\bar{x}\\): mean value of \\(x\\)\n\\(\\bar{y}\\): mean value of \\(y\\)\n\\(S_{xx}\\): sum of squares of \\(X\\) defined as \\(S_{xx} = \\displaystyle \\sum_{i=1}^{n}(x_i-\\bar{x})^2\\)\n\\(S_{yy}\\): sum of squares of \\(Y\\) defined as \\(S_{yy} = \\displaystyle \\sum_{i=1}^{n}(y_i-\\bar{y})^2\\)\n\\(S_{xy}\\): sum of products of \\(X\\) and \\(Y\\) defined as \\(S_{xy} = \\displaystyle \\sum_{i=1}^{n}(x_i-\\bar{x})(y_i-\\bar{y})\\)\n\n\n\n\n\n\n\nExample 1.2 (Least squares) Let’s try least squares method to find coefficient estimates in the “body weight and plasma volume example”\n\n# initial data\nweight &lt;- c(58, 70, 74, 63.5, 62.0, 70.5, 71.0, 66.0) # body weight (kg)\nplasma &lt;- c(2.75, 2.86, 3.37, 2.76, 2.62, 3.49, 3.05, 3.12) # plasma volume (liters)\n\n# rename variables for convenience\nx &lt;- weight\ny &lt;- plasma\n\n# mean values of x and y\nx.bar &lt;- mean(x)\ny.bar &lt;- mean(y)\n\n# Sum of squares\nSxx &lt;-  sum((x - x.bar)^2)\nSxy &lt;- sum((x-x.bar)*(y-y.bar))\n\n# Coefficient estimates\nbeta.hat &lt;- Sxy / Sxx\nalpha.hat &lt;- y.bar - Sxy/Sxx*x.bar\n\n# Print estimated coefficients alpha and beta\nprint(alpha.hat)\n\n[1] 0.08572428\n\nprint(beta.hat)\n\n[1] 0.04361534\n\n\n\nIn R we can use lm(), the built-in function, to fit a linear regression model and we can replace the above code with one line\n\nlm(plasma ~ weight)\n\n\nCall:\nlm(formula = plasma ~ weight)\n\nCoefficients:\n(Intercept)       weight  \n    0.08572      0.04362"
  },
  {
    "objectID": "lm-intro.html#intercept-and-slope",
    "href": "lm-intro.html#intercept-and-slope",
    "title": "1  Introduction to linear models",
    "section": "1.7 Intercept and Slope",
    "text": "1.7 Intercept and Slope\n\nLinear regression gives us estimates of model coefficient \\(Y_i = \\alpha + \\beta x_i + \\epsilon_i\\)\n\\(\\alpha\\) is known as the intercept\n\\(\\beta\\) is known as the slope\n\n\n\n\n\n\nFigure 1.7: Scatter plot of the data shows that high plasma volume tends to be associated with high weight and vice verca. Linear regression gives the equation of the straight line that best describes how the outcome changes (increase or decreases) with a change of exposure variable (in red)"
  },
  {
    "objectID": "lm-intro.html#hypothesis-testing",
    "href": "lm-intro.html#hypothesis-testing",
    "title": "1  Introduction to linear models",
    "section": "1.8 Hypothesis testing",
    "text": "1.8 Hypothesis testing\nIs there a relationship between the response and the predictor?\n\nthe calculated \\(\\hat{\\alpha}\\) and \\(\\hat{\\beta}\\) are estimates of the population values of the intercept and slope and are therefore subject to sampling variation\ntheir precision is measured by their estimated standard errors, e.s.e(\\(\\hat{\\alpha}\\)) and e.s.e(\\(\\hat{\\beta}\\))\nthese estimated standard errors are used in hypothesis testing and in constructing confidence and prediction intervals\n\nThe most common hypothesis test involves testing the null hypothesis of:\n\n\\(H_0:\\) There is no relationship between \\(X\\) and \\(Y\\)\nversus the alternative hypothesis \\(H_a:\\) there is some relationship between \\(X\\) and \\(Y\\)\n\nMathematically, this corresponds to testing:\n\n\\(H_0: \\beta=0\\)\nversus \\(H_a: \\beta\\neq0\\)\nsince if \\(\\beta=0\\) then the model \\(Y_i=\\alpha+\\beta x_i + \\epsilon_i\\) reduces to \\(Y=\\alpha + \\epsilon_i\\)\n\nUnder the null hypothesis \\(H_0: \\beta = 0\\)  \n\n\\(n\\) is number of observations\n\\(p\\) is number of model parameters\n\\(\\frac{\\hat{\\beta}-\\beta}{e.s.e(\\hat{\\beta})}\\) is the ratio of the departure of the estimated value of a parameter, \\(\\hat\\beta\\), from its hypothesized value, \\(\\beta\\), to its standard error, called t-statistics\nthe t-statistics follows Student’s t distribution with \\(n-p\\) degrees of freedom\n\n\nExample 1.3 (Hypothesis testing) Let’s look again at our example data. This time we will not only fit the linear regression model but also look a bit more closely at the R summary of the model\n\nweight &lt;- c(58, 70, 74, 63.5, 62.0, 70.5, 71.0, 66.0) # body weight (kg)\nplasma &lt;- c(2.75, 2.86, 3.37, 2.76, 2.62, 3.49, 3.05, 3.12) # plasma volume (liters)\n\nmodel &lt;- lm(plasma ~ weight)\nprint(summary(model))\n\n\nCall:\nlm(formula = plasma ~ weight)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.27880 -0.14178 -0.01928  0.13986  0.32939 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)  \n(Intercept)  0.08572    1.02400   0.084   0.9360  \nweight       0.04362    0.01527   2.857   0.0289 *\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.2188 on 6 degrees of freedom\nMultiple R-squared:  0.5763,    Adjusted R-squared:  0.5057 \nF-statistic:  8.16 on 1 and 6 DF,  p-value: 0.02893\n\n\n\n\nUnder Estimate we see estimates of our model coefficients, \\(\\hat{\\alpha}\\) (intercept) and \\(\\hat{\\beta}\\) (slope, here weight), followed by their estimated standard errors, Std. Errors\nIf we were to test if there is an association between weight and plasma volume we would write under the null hypothesis \\(H_0: \\beta = 0\\) \\[\\frac{\\hat{\\beta}-\\beta}{e.s.e(\\hat{\\beta})} = \\frac{0.04362-0}{0.01527} = 2.856582\\]\nand we would compare t-statistics to Student's t distribution with \\(n-p = 8 - 2 = 6\\) degrees of freedom (as we have 8 observations and two model parameters, \\(\\alpha\\) and \\(\\beta\\))\nwe can use Student’s t distribution table or R code to obtain the associated P-value\n\n\n2*pt(2.856582, df=6, lower=F)\n\n[1] 0.02893095\n\n\n\nhere the observed t-statistics is large and therefore yields a small P-value, meaning that there is sufficient evidence to reject null hypothesis in favor of the alternative and conclude that there is a significant association between weight and plasma volume"
  },
  {
    "objectID": "lm-intro.html#vector-matrix-notations",
    "href": "lm-intro.html#vector-matrix-notations",
    "title": "1  Introduction to linear models",
    "section": "1.9 Vector-matrix notations",
    "text": "1.9 Vector-matrix notations\nWhile in simple linear regression it is feasible to arrive at the parameters estimates using calculus in more realistic settings of multiple regression, with more than one explanatory variable in the model, it is more efficient to use vectors and matrices to define the regression model.\nLet’s rewrite our simple linear regression model \\(Y_i = \\alpha + \\beta_i + \\epsilon_i \\quad i=1,\\dots n\\) into vector-matrix notation in 6 steps.\n\nFirst we rename our \\(\\alpha\\) to \\(\\beta_0\\) and \\(\\beta\\) to \\(\\beta_1\\) as it is easier to keep tracking the number of model parameters this way\nThen we notice that we actually have \\(n\\) equations such as: \\[y_1 = \\beta_0 + \\beta_1 x_1 + \\epsilon_1\\] \\[y_2 = \\beta_0 + \\beta_1 x_2 + \\epsilon_2\\] \\[y_3 = \\beta_0 + \\beta_1 x_3 + \\epsilon_3\\] \\[\\dots\\] \\[y_n = \\beta_0 + \\beta_1 x_n + \\epsilon_n\\]\nWe group all \\(Y_i\\) and \\(\\epsilon_i\\) into column vectors: \\(\\mathbf{Y}=\\begin{bmatrix}  y_1 \\\\  y_2 \\\\  \\vdots \\\\  y_{n} \\end{bmatrix}\\) and \\(\\boldsymbol\\epsilon=\\begin{bmatrix}  \\epsilon_1 \\\\  \\epsilon_2 \\\\  \\vdots \\\\  \\epsilon_{n} \\end{bmatrix}\\)\nWe stack two parameters \\(\\beta_0\\) and \\(\\beta_1\\) into another column vector:\\[\\boldsymbol\\beta=\\begin{bmatrix}\n  \\beta_0  \\\\\n  \\beta_1\n\\end{bmatrix}\\]\nWe append a vector of ones with the single predictor for each \\(i\\) and create a matrix with two columns called design matrix \\[\\mathbf{X}=\\begin{bmatrix}\n  1 & x_1  \\\\\n  1 & x_2  \\\\\n  \\vdots & \\vdots \\\\\n  1 & x_{n}\n\\end{bmatrix}\\]\nWe write our linear model in a vector-matrix notations as: \\[\\mathbf{Y} = \\mathbf{X}\\boldsymbol\\beta + \\boldsymbol\\epsilon\\]\n\n\nDefinition 1.1 (vector matrix form of the linear model) The vector-matrix representation of a linear model with \\(p-1\\) predictors can be written as \\[\\mathbf{Y} = \\mathbf{X}\\boldsymbol\\beta + \\boldsymbol\\epsilon\\]\nwhere:\n\n\\(\\mathbf{Y}\\) is \\(n \\times1\\) vector of observations\n\\(\\mathbf{X}\\) is \\(n \\times p\\) design matrix\n\\(\\boldsymbol\\beta\\) is \\(p \\times1\\) vector of parameters\n\\(\\boldsymbol\\epsilon\\) is \\(n \\times1\\) vector of vector of random errors, indepedent and identically distributed (i.i.d) N(0, \\(\\sigma^2\\))\n\nIn full, the above vectors and matrix have the form:\n\\(\\mathbf{Y}=\\begin{bmatrix}  y_1 \\\\  y_2 \\\\  \\vdots \\\\  y_{n} \\end{bmatrix}\\) \\(\\boldsymbol\\beta=\\begin{bmatrix}  \\beta_0 \\\\  \\beta_1 \\\\  \\vdots \\\\  \\beta_{p} \\end{bmatrix}\\) \\(\\boldsymbol\\epsilon=\\begin{bmatrix}  \\epsilon_1 \\\\  \\epsilon_2 \\\\  \\vdots \\\\  \\epsilon_{n} \\end{bmatrix}\\) \\(\\mathbf{X}=\\begin{bmatrix}  1 & x_{1,1} & \\dots & x_{1,p-1} \\\\  1 & x_{2,1} & \\dots & x_{2,p-1} \\\\  \\vdots & \\vdots & \\vdots & \\vdots \\\\  1 & x_{n,1} & \\dots & x_{n,p-1} \\end{bmatrix}\\)\n\n\nTheorem 1.2 (Least squares in vector-matrix notation) The least squares estimates for a linear regression of the form: \\[\\mathbf{Y} = \\mathbf{X}\\boldsymbol\\beta + \\boldsymbol\\epsilon\\]\nis given by: \\[\\hat{\\mathbf{\\beta}}= (\\mathbf{X}^T\\mathbf{X})^{-1}\\mathbf{X}^T\\mathbf{Y}\\]\n\n\nExample 1.4 (vector-matrix-notation) Following the above definition we can write the “weight - plasma volume model” as: \\[\\mathbf{Y} = \\mathbf{X}\\boldsymbol\\beta + \\boldsymbol\\epsilon\\] where:\n\\(\\mathbf{Y}=\\begin{bmatrix}  2.75 \\\\ 2.86 \\\\ 3.37 \\\\ 2.76 \\\\ 2.62 \\\\ 3.49 \\\\ 3.05 \\\\ 3.12 \\end{bmatrix}\\)\n\\(\\boldsymbol\\beta=\\begin{bmatrix}  \\beta_0 \\\\  \\beta_1 \\end{bmatrix}\\) \\(\\boldsymbol\\epsilon=\\begin{bmatrix}  \\epsilon_1 \\\\  \\epsilon_2 \\\\  \\vdots \\\\  \\epsilon_{8} \\end{bmatrix}\\) \\(\\mathbf{X}=\\begin{bmatrix}  1 & 58.0 \\\\  1 & 70.0 \\\\  1 & 74.0 \\\\  1 & 63.5 \\\\  1 & 62.0 \\\\  1 & 70.5 \\\\  1 & 71.0 \\\\  1 & 66.0 \\\\ \\end{bmatrix}\\)\nand we can estimate model parameters using \\(\\hat{\\mathbf{\\beta}}= (\\mathbf{X}^T\\mathbf{X})^{-1}\\mathbf{X}^T\\mathbf{Y}\\).\nWe can do it by hand or in R as follows:\n\nn &lt;- length(plasma) # no. of observation\nY &lt;- as.matrix(plasma, ncol=1)\nX &lt;- cbind(rep(1, length=n), weight)\nX &lt;- as.matrix(X)\n\n# print Y and X to double-check that the format is according to the definition\nprint(Y)\n\n     [,1]\n[1,] 2.75\n[2,] 2.86\n[3,] 3.37\n[4,] 2.76\n[5,] 2.62\n[6,] 3.49\n[7,] 3.05\n[8,] 3.12\n\nprint(X)\n\n       weight\n[1,] 1   58.0\n[2,] 1   70.0\n[3,] 1   74.0\n[4,] 1   63.5\n[5,] 1   62.0\n[6,] 1   70.5\n[7,] 1   71.0\n[8,] 1   66.0\n\n# least squares estimate\n# solve() finds inverse of matrix\nbeta.hat &lt;- solve(t(X)%*%X)%*%t(X)%*%Y\nprint(beta.hat)\n\n             [,1]\n       0.08572428\nweight 0.04361534"
  },
  {
    "objectID": "lm-intro.html#confidence-intervals-and-prediction-intervals",
    "href": "lm-intro.html#confidence-intervals-and-prediction-intervals",
    "title": "1  Introduction to linear models",
    "section": "1.10 Confidence intervals and prediction intervals",
    "text": "1.10 Confidence intervals and prediction intervals\n\nwhen we estimate coefficients we can also find their confidence intervals, typically 95% confidence intervals, i.e. a range of values that contain the true unknown value of the parameter\nwe can also use linear regression models to predict the response value given a new observation and find prediction intervals. Here, we look at any specific value of \\(x_i\\), and find an interval around the predicted value \\(y_i'\\) for \\(x_i\\) such that there is a 95% probability that the real value of y (in the population) corresponding to \\(x_i\\) is within this interval\n\n\nExample 1.5 (Prediction and intervals) Let’s:\n\nfind confidence intervals for our coefficient estimates\npredict plasma volume for a men weighting 60 kg\nfind prediction interval\nplot original data, fitted regression model, predicted observation and prediction interval\n\n\n# fit regression model\nmodel &lt;- lm(plasma ~ weight)\nprint(summary(model))\n\n\nCall:\nlm(formula = plasma ~ weight)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.27880 -0.14178 -0.01928  0.13986  0.32939 \n\nCoefficients:\n            Estimate Std. Error t value Pr(&gt;|t|)  \n(Intercept)  0.08572    1.02400   0.084   0.9360  \nweight       0.04362    0.01527   2.857   0.0289 *\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.2188 on 6 degrees of freedom\nMultiple R-squared:  0.5763,    Adjusted R-squared:  0.5057 \nF-statistic:  8.16 on 1 and 6 DF,  p-value: 0.02893\n\n# find confidence intervals for the model coefficients\nconfint(model)\n\n                   2.5 %     97.5 %\n(Intercept) -2.419908594 2.59135716\nweight       0.006255005 0.08097567\n\n# predict plasma volume for a new observation of 60 kg\n# we have to create data frame with a variable name matching the one used to build the model\nnew.obs &lt;- data.frame(weight = 60)\npredict(model, newdata = new.obs)\n\n       1 \n2.702645 \n\n# find prediction intervals\nprediction.interval &lt;- predict(model, newdata = new.obs,  interval = \"prediction\")\nprint(prediction.interval)\n\n       fit      lwr      upr\n1 2.702645 2.079373 3.325916\n\n# plot the original data, fitted regression and predicted value\nplot(weight, plasma, pch=19, xlab=\"weight [kg]\", ylab=\"plasma [l]\", ylim=c(2,4))\nlines(weight, model$fitted.values, col=\"red\") # fitted model in red\npoints(new.obs, predict(model, newdata = new.obs), pch=19, col=\"blue\") # predicted value at 60kg\nsegments(60, prediction.interval[2], 60, prediction.interval[3], lty = 3) # add prediction interval"
  },
  {
    "objectID": "lm-intro.html#assessing-model-fit",
    "href": "lm-intro.html#assessing-model-fit",
    "title": "1  Introduction to linear models",
    "section": "1.11 Assessing model fit",
    "text": "1.11 Assessing model fit\n\nEarlier we learned how to estimate parameters in a liner model using least squares estimation.\nNow we will consider how to assess the goodness of fit of a model, i.e. how well does the model explain our data.\nWe do that by calculating the amount of variability in the response that is explained by the model.\n\n\n\\(R^2\\): summary of the fitted model\n\nconsidering a simple linear regression, the simplest model, Model 0, we could consider fitting is \\[Y_i = \\beta_0+ \\epsilon_i\\] that corresponds to a line that run through the data but lies parallel to the horizontal axis\nin our plasma volume example that would correspond the mean value of plasma volume being predicted for any value of weight (in purple)\n\n\n\n\n\n\n\n\n\n\n\nTSS, denoted Total corrected sum-of-squares is the residual sum-of-squares for Model 0 \\[S(\\hat{\\beta_0}) = TSS = \\sum_{i=1}^{n}(y_i - \\bar{y})^2 = S_{yy}\\] corresponding the to the sum of squared distances to the purple line\n\n\n\n\n\n\n\n\n\n\n\nFitting Model 1 of the form \\[Y_i = \\beta_0 + \\beta_1x + \\epsilon_i\\] we have earlier defined\nRSS, the residual sum-of-squares as: \\[RSS = \\displaystyle \\sum_{i=1}^{n}(y_i - \\{\\hat{\\beta_0} + \\hat{\\beta}_1x_{1i} + \\dots + \\hat{\\beta}_px_{pi}\\}) = \\sum_{i=1}^{n}(y_i - \\hat{y_i})^2\\]\nthat corresponds to the squared distances between the observed values \\(y_i, \\dots,y_n\\) to fitted values \\(\\hat{y_1}, \\dots \\hat{y_n}\\), i.e. distances to the red fitted line\n\n\n\n\n\n\n\n\n\n\n\nDefinition 1.2 (\\(R^2\\)) A simple but useful measure of model fit is given by \\[R^2 = 1 - \\frac{RSS}{TSS}\\] where:\n\nRSS is the residual sum-of-squares for Model 1, the fitted model of interest\nTSS is the sum of squares of the null model\n\n\n\n\\(R^2\\) quantifies how much of a drop in the residual sum-of-squares is accounted for by fitting the proposed model\n\\(R^2\\) is also referred as coefficient of determination\nIt is expressed on a scale, as a proportion (between 0 and 1) of the total variation in the data\nValues of \\(R^2\\) approaching 1 indicate the model to be a good fit\nValues of \\(R^2\\) less than 0.5 suggest that the model gives rather a poor fit to the data\n\n\n\n\\(R^2\\) and correlation coefficient\n\nTheorem 1.3 (\\(R^2\\)) In the case of simple linear regression:\nModel 1: \\(Y_i = \\beta_0 + \\beta_1x + \\epsilon_i\\) \\[R^2 = r^2\\] where:\n\n\\(R^2\\) is the coefficient of determination\n\\(r^2\\) is the sample correlation coefficient\n\n\n\n\n\\(R^2(adj)\\)\n\nin the case of multiple linear regression, where there is more than one explanatory variable in the model\nwe are using the adjusted version of \\(R^2\\) to assess the model fit\nas the number of explanatory variables increase, \\(R^2\\) also increases\n\\(R^2(adj)\\) takes this into account, i.e. adjusts for the fact that there is more than one explanatory variable in the model\n\n\nTheorem 1.4 (\\(R^2(adj)\\)) For any multiple linear regression \\[Y_i = \\beta_0 + \\beta_1x_{1i} + \\dots + \\beta_{p-1}x_{(p-1)i} +  \\epsilon_i\\] \\(R^2(adj)\\) is defined as \\[R^2(adj) = 1-\\frac{\\frac{RSS}{n-p-1}}{\\frac{TSS}{n-1}}\\] where\n\n\\(p\\) is the number of independent predictors, i.e. the number of variables in the model, excluding the constant\n\n\\(R^2(adj)\\) can also be calculated from \\(R^2\\): \\[R^2(adj) = 1 - (1-R^2)\\frac{n-1}{n-p-1}\\]"
  },
  {
    "objectID": "lm-intro.html#the-assumptions-of-a-linear-model",
    "href": "lm-intro.html#the-assumptions-of-a-linear-model",
    "title": "1  Introduction to linear models",
    "section": "1.12 The assumptions of a linear model",
    "text": "1.12 The assumptions of a linear model\nUp until now we were fitting models and discussed how to assess the model fit. Before making use of a fitted model for explanation or prediction, it is wise to check that the model provides an adequate description of the data. Informally we have been using box plots and scatter plots to look at the data. There are however formal definitions of the assumptions.\nAssumption A: The deterministic part of the model captures all the non-random structure in the data\n\nThis implies that the mean of the errors \\(\\epsilon_i\\) is zero.\nTt applies only over the range of explanatory variables.\n\nAssumption B: the scale of variability of the errors is constant at all values of the explanatory variables\n\nPractically we are looking at whether the observations are equally spread on both side of the regression line.\n\nAssumption C: the errors are independent\n\nBroadly speaking this means that knowledge of errors attached to one observation does not give us any information about the error attached to another.\n\nAssumptions D: the errors are normally distributed\n\nThis will allow us to describe the variation in the model’s parameters estimates and therefore make inferences about the population from which our sample was taken.\n\nAssumption E: the values of the explanatory variables are recorded without error\n\nThis one is not possible to check via examining the data, instead we have to consider the nature of the experiment.\n\n\n1.12.1 Checking assumptions\nResiduals, \\(\\hat{\\epsilon_i} = y_i - \\hat{y_i}\\) are the main ingredient to check model assumptions. We use plots such as:\n\nHistograms or normal probability plots of \\(\\hat{\\epsilon_i}\\)\n\n\nuseful to check the assumption of normality\n\n\nPlots of \\(\\hat{\\epsilon_i}\\) versus the fitted values \\(\\hat{y_i}\\)\n\n\nused to detect changes in error variance\nused to check if the mean of the errors is zero\n\n\nPlots of \\(\\hat{\\epsilon_i}\\) vs. an explanatory variable \\(x_{ij}\\)\n\n\nthis helps to check that the variable \\(x_j\\) has a linear relationship with the response variable\n\n\nPlots of \\(\\hat{\\epsilon_i}\\) vs. an explanatory variable \\(x_{kj}\\) that is not in the model\n\n\nthis helps to check whether the additional variable \\(x_k\\) might have a relationship with the response variable\n\n\nPlots of \\(\\hat{\\epsilon_i}\\) in the order of the observations were collected\n\n\nthis is useful to check whether errors might be correlated over time\n\nLet’s fit a simple model to predict BMI given waist for the diabetes study and see if the model meets the assumptions of linear models.\n\n# fit simple linear regression model\nmodel &lt;- lm(BMI ~ waist, data = data_diabetes)\n\n# plot diagnostic plots of the linear model\n# by default plot(model) calls four diagnostics plots\n# par() divides plot window in 2 x 2 grid\npar(mfrow=c(2,2))\nplot(model)\n\n\n\n\nDefault diagnostic residual plots based on the lm() model used to assess whether the assumptions of linear models are met. Simple regression to model BMI with waist explanatory variable.\n\n\n\n\n\nThe residual plots provides examples of a situation where the assumptions appear to be met.\nThe linear regression appears to describe data quite well.\nThere is no obvious trend of any kind in the residuals vs. fitted values (the shape is scattered) with potential few outliers that we may want to decided to exclude later.\nPoints lie reasonably well along the line in the normal probability plot, hence normality appears to be met.\n\nExamples of assumptions not being met\n\n\n\n\n\nExample of data with a typical seasonal variation (up and down) coupled wtih a linear trend. The blue line gives the linear regression fit to the data, which clearly is not adequate. In comparison, if we used a non-parametric fit, we will get the red line as the fitted relationship. The residual plot retains pattern, given by orange line, indicating that the linear model is not appropriate in this case\n\n\n\n\n\n\n\n\n\nExample of non-constant variance\n\n\n\n\n\n\n\n\n\nExample of residulas deviating from QQ plot, i.e. not following normal distribution. The residuals can deviate in both upper and lower tail. On the left tails are lighter meaning that they have smaller values that what would be expected, on the right there are heavier tails with values larger than expected\n\n\n\n\n\n\n1.12.2 Influential observations\n\nSometimes individual observations can exert a great deal of influence on the fitted model.\nOne routine way of checking for this is to fit the model \\(n\\) times, missing out each observation in turn.\nIf we removed i-th observation and compared the fitted value from the full model, say \\(\\hat{y_j}\\) to those obtained by removing this point, denoted \\(\\hat{y_{j(i)}}\\) then\nobservations with a high Cook’s distance (measuring the effect of deleting a given observation) could be influential.\n\nLet’s remove some observation with higher Cook’s distance from protein data set, re-fit our model and compare the diagnostics plots\n\n# observations to be removed (based on Residuals vs. Leverage plot)\nobs &lt;- c(13, 78, 83, 84)\n\n# fit models removing observations\ndata_diabetes_flr &lt;- data_diabetes[-obs, ]\n\nmodel_flr &lt;- lm(BMI ~ waist, data = data_diabetes_flr)\n\n# plot diagnostics plot\npar(mfrow=c(2,2))\nplot(model_flr)"
  },
  {
    "objectID": "lm-ml.html#evaluating-regression",
    "href": "lm-ml.html#evaluating-regression",
    "title": "2  Linear models in the ML context",
    "section": "2.1 Evaluating regression",
    "text": "2.1 Evaluating regression\n\n2.1.1 model fit\nAdjusted R-squared (as seen before) \\[\nR_{adj}^2=1-\\frac{RSS}{TSS}\\frac{n-1}{n-p-1} = 1 - \\frac{\\sum_{i=1}^{n}(y_i - \\hat{y_i})^2}{\\sum_{i=1}^{n}(y_i - \\bar{y})^2}\\frac{n-1}{n-p-1}\n\\]\nAIC and BIC\nAIC is grounded in information theory and BIC is derived from a Bayesian point of view. Both are formally defined in likelihood functions. For regression models they can be expressed in terms of RSS because the likelihood of a model in the context of normal errors is directly related to the RSS.\n\\[\\text{AIC} = n \\ln(\\text{RSS}/n) + 2p\\]\nwhere:\n\n\\(n\\) is the number of observations.\n\\(\\text{RSS}\\) is the residual sum of squares.\n\\(p\\) is the number of parameters in the model (including the intercept).\n\n\\[\\text{BIC} = n \\ln(\\text{RSS}/n) + p \\ln(n)\\]\nwhere:\n\n\\(n\\) is the number of observations.\n\\(\\text{RSS}\\) is the residual sum of squares.\n\\(p\\) is the number of parameters in the model.\n\nBoth criteria, AIC and BIC, introduce penalties for the number of parameters to avoid overfitting. BIC introduces a stronger penalty based on the sample size, making it more conservative than AIC. When comparing models using AIC or BIC that incorporate RSS, the objective remains the same: select the model that provides the best balance between goodness of fit and model simplicity. The model with the lower AIC or BIC value is generally preferred, as it indicates either a more parsimonious model or a model that better fits the data (or both).\n\n\n2.1.2 predictions\n\nMean Squared Error (MSE): average squared difference between the predicted values and the actual values. \\[MSE = \\frac{1}{N}\\sum_{i=1}^{N}({y_i}-\\hat{y}_i)^2\\]\nRoot Mean Squared Error (RMSE): square root of the MSE \\[RMSE = \\sqrt{\\frac{1}{N}\\sum_{i=1}^{N}({y_i}-\\hat{y}_i)^2}\\]\nMAE: average absolute difference between the predicted values and the actual values \\[MAE = \\frac{1}{N}\\sum_{i=1}^{N}|{y_i}-\\hat{y}_i|\\]\nMean Absolute Percentage Error (MAPE): average percentage difference between the predicted values and the actual values.\n\nThe smaller the difference between the predicted values vs. the validation or cross-validation predicted values, the better the model."
  },
  {
    "objectID": "lm-ml.html#evaluating-regression-model-fit",
    "href": "lm-ml.html#evaluating-regression-model-fit",
    "title": "2  Linear models in the ML context",
    "section": "2.1 Evaluating regression: model fit",
    "text": "2.1 Evaluating regression: model fit\nAdjusted R-squared (as seen before) \\[\nR_{adj}^2=1-\\frac{RSS}{TSS}\\frac{n-1}{n-p-1} = 1 - \\frac{\\sum_{i=1}^{n}(y_i - \\hat{y_i})^2}{\\sum_{i=1}^{n}(y_i - \\bar{y})^2}\\frac{n-1}{n-p-1}\n\\]\nAIC and BIC\nAIC is grounded in information theory and BIC is derived from a Bayesian point of view. Both are formally defined in likelihood functions. For regression models they can be expressed in terms of RSS because the likelihood of a model in the context of normal errors is directly related to the RSS.\n\\[\\text{AIC} = n \\ln(\\text{RSS}/n) + 2p\\]\nwhere:\n\n\\(n\\) is the number of observations.\n\\(\\text{RSS}\\) is the residual sum of squares.\n\\(p\\) is the number of parameters in the model (including the intercept).\n\n\\[\\text{BIC} = n \\ln(\\text{RSS}/n) + p \\ln(n)\\]\nwhere:\n\n\\(n\\) is the number of observations.\n\\(\\text{RSS}\\) is the residual sum of squares.\n\\(p\\) is the number of parameters in the model.\n\nBoth criteria, AIC and BIC, introduce penalties for the number of parameters to avoid overfitting. BIC introduces a stronger penalty based on the sample size, making it more conservative than AIC. When comparing models using AIC or BIC that incorporate RSS, the objective remains the same: select the model that provides the best balance between goodness of fit and model simplicity. The model with the lower AIC or BIC value is generally preferred, as it indicates either a more parsimonious model or a model that better fits the data (or both)."
  },
  {
    "objectID": "lm-ml.html#evaluating-regression-outcome",
    "href": "lm-ml.html#evaluating-regression-outcome",
    "title": "2  Linear models in the ML context",
    "section": "2.2 Evaluating regression outcome",
    "text": "2.2 Evaluating regression outcome\n\nMean Squared Error (MSE): average squared difference between the predicted values and the actual values. \\[MSE = \\frac{1}{N}\\sum_{i=1}^{N}({y_i}-\\hat{y}_i)^2\\]\nRoot Mean Squared Error (RMSE): square root of the MSE \\[RMSE = \\sqrt{\\frac{1}{N}\\sum_{i=1}^{N}({y_i}-\\hat{y}_i)^2}\\]\nMAE: average absolute difference between the predicted values and the actual values \\[MAE = \\frac{1}{N}\\sum_{i=1}^{N}|{y_i}-\\hat{y}_i|\\]\nMean Absolute Percentage Error (MAPE): average percentage difference between the predicted values and the actual values."
  },
  {
    "objectID": "lm-ml.html#feature-selection",
    "href": "lm-ml.html#feature-selection",
    "title": "2  Linear models in the ML context",
    "section": "2.2 Feature selection",
    "text": "2.2 Feature selection"
  }
]