{
  "hash": "8898acdc8c25adb8c37626709eaf1747",
  "result": {
    "markdown": "# Exercises (Regression coefficients)\n\n\n::: {.cell}\n\n:::\n\n\n**Data for exercises** are on Canvas under Files -> data_exercises --> linear-models\n\n::: {#exr-rerun}\n\n## Height-weigth-gender\n\na) repeat fitting the models with a) gender, b) weight and gender and c) interaction between weight and gender\nb) given the model with the interaction term, what is expected height of a man and a women given a weight of 120 lbs?\nc) can you use predict() function to check your calculations?\n\n:::\n\n\n::: {#exr-trout}\n\n## Trout\n\nWhen the behavior of a group of trout is studied, some fish are observed to become dominant and others to become subordinate. Dominant fish have freedom of movement whereas subordinate fish tend to congregate in the periphery of the waterway to avoid crossing the path of the dominant fish. Data on energy expenditure and ration of blood obtained were collected as part of a laboratory experiment for 20 trout. Energy and ration is measured in calories per kilo-calorie per trout per day.\n\nUse the below code to load the data to R and use linear regression models to answer:\n\n- a) is there a relationship between ration obtained and energy expenditure\n- b) is the relationship between ration obtained and energy expenditure different for each type of fish?\n- Hint: it is good to start with some explanatory plots between every pair of variable\n\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\n# read in data and show preview\ntrout <- read.csv(\"data/lm/trout.csv\")\n\n# recode the Group variable and treat like categories (factor)\ntrout$Group <- factor(trout$Group, labels=c(\"Dominant\", \"Subordinate\"))\n```\n:::\n\n\n\n\n\n\n\n::: {#exr-drug}\n\n## Lowering blood pressure\n\nA clinical trial has been carried out to compare three drug treatments which are intended to lower blood pressure in hypertensive patients. The data contains initial values fo systolic blood pressure (bp) in mmHg for each patient and the reduction achieved during the course of the trial. For each patient, allocation to treatment (drug) was carried out randomly and conditions such as the length of the treatment and dose of the drug were standardized as far as possible.\n\nUse linear regression to answer questions:\n\na) is there an association between the reduction in blood pressure and initial blood pressure\nb) is reduction in blood pressure different across the treatment (in three drug groups)?\nc) is reduction in blood pressure different across the treatment when accounting for initial blood pressure?\nd) is reduction in blood pressure changing differently under different treatment?\nHint: here we have three categories which can be seen as expanding the model with two categories by an additional one: one category will be treated as baseline\n\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\nblooddrug <- read.csv(\"data/lm/bloodrug.csv\")\nblooddrug$drug <- factor(blooddrug$drug)\nhead(blooddrug)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  initial redn drug\n1     158    4    1\n2     176   21    1\n3     174   36    1\n4     168   14    1\n5     174   34    1\n6     186   37    1\n```\n:::\n:::\n\n\n\n## Answers to selected exercises \n\n::: {.solution}\n\n@exr-rerun\n\n:::\n\n\na)\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\nhtwtgen <- read.csv(\"data/lm/heights_weights_genders.csv\")\nhead(htwtgen)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  Gender   Height   Weight\n1   Male 73.84702 241.8936\n2   Male 68.78190 162.3105\n3   Male 74.11011 212.7409\n4   Male 71.73098 220.0425\n5   Male 69.88180 206.3498\n6   Male 67.25302 152.2122\n```\n:::\n\n```{.r .cell-code  code-fold=\"false\"}\n# a)\nmodel1 <- lm(Height ~ Gender, data = htwtgen)\nmodel2 <- lm(Height ~ Gender + Weight, data = htwtgen)\nmodel3 <- lm(Height ~ Gender * Weight, data = htwtgen)\n\n# print(summary(model1))\n# print(summary(model2))\n# print(summary(model3))\n```\n:::\n\n\nb) use equations to find the height for men and women respectively:\n$$E(height|male\\; and \\; weight=x)=47.34778 - 1.68367 + 0.12043x + 0.00449x = 45.7 + 0.125x$$\n$$E(height|female\\; and \\; weight=x)=47.34778 + 0.12043x$$\n\nc)\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\n# for men\nnew.obs <- data.frame(Weight=120, Gender=\"Male\")\npredict(model3, newdata = new.obs)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n       1 \n60.65427 \n```\n:::\n\n```{.r .cell-code  code-fold=\"false\"}\n# for female\nnew.obs <- data.frame(Weight=120, Gender=\"Female\")\npredict(model3, newdata = new.obs)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n       1 \n61.79882 \n```\n:::\n:::\n\n\n\n::: {.solution}\n\n@exr-trout\n\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\n# read in data and show preview\ntrout <- read.csv(\"data/lm/trout.csv\")\n\n# recode the Group variable and treat like categories (factor)\ntrout$Group <- factor(trout$Group, labels=c(\"Dominant\", \"Subordinate\"))\nhead(trout)\n##   Energy Ration    Group\n## 1  44.26  81.35 Dominant\n## 2  67.16  91.68 Dominant\n## 3  48.15  58.00 Dominant\n## 4  34.53  58.63 Dominant\n## 5  67.93  91.93 Dominant\n## 6  72.45  96.56 Dominant\n\n# plot data\n# boxplots of Energy and Ration per group\nboxplot(trout$Energy ~ trout$Group, xlab=\"\", ylab=\"Energy\")\n```\n\n::: {.cell-output-display}\n![](lm-coeff-exercises_files/figure-html/unnamed-chunk-6-1.png){width=480}\n:::\n\n```{.r .cell-code  code-fold=\"false\"}\nboxplot(trout$Ration ~ trout$Group, xlab=\"\", ylab=\"Ration\")\n```\n\n::: {.cell-output-display}\n![](lm-coeff-exercises_files/figure-html/unnamed-chunk-6-2.png){width=480}\n:::\n\n```{.r .cell-code  code-fold=\"false\"}\n\n# scatter plot of Ration vs. Energy\nplot(trout$Ration, trout$Energy, pch=19, xlab=\"Ration\", ylab=\"Energy\")\n```\n\n::: {.cell-output-display}\n![](lm-coeff-exercises_files/figure-html/unnamed-chunk-6-3.png){width=480}\n:::\n:::\n\n\n- From the exploratory plots we see that there is some sort of relationship between ratio and energy, i.e. energy increase while ration obtained increases\n- From box plots we see that the ration obtained may be different in two groups\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\n# Is there a relationship between ration obtained and energy expenditure\nmodel1 <- lm(Energy ~ Ration, data = trout)\nprint(summary(model1))\n## \n## Call:\n## lm(formula = Energy ~ Ration, data = trout)\n## \n## Residuals:\n##     Min      1Q  Median      3Q     Max \n## -18.704  -4.703  -0.578   2.432  33.506 \n## \n## Coefficients:\n##             Estimate Std. Error t value Pr(>|t|)    \n## (Intercept)   4.3037    12.5156   0.344 0.734930    \n## Ration        0.7211     0.1716   4.203 0.000535 ***\n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## \n## Residual standard error: 12.05 on 18 degrees of freedom\n## Multiple R-squared:  0.4953,\tAdjusted R-squared:  0.4673 \n## F-statistic: 17.66 on 1 and 18 DF,  p-value: 0.0005348\n# from the regression output we can see that yes, a unit increase in ratio increase energy expenditure by 0.72\n\n# Is there a relationship between ration obtained and energy expenditure different for each type of fish?\n# we first check if there is a group effect\nmodel2 <- lm(Energy ~ Ration + Group, data = trout)\nprint(summary(model2))\n## \n## Call:\n## lm(formula = Energy ~ Ration + Group, data = trout)\n## \n## Residuals:\n##     Min      1Q  Median      3Q     Max \n## -13.130  -5.139  -0.870   2.199  25.622 \n## \n## Coefficients:\n##                  Estimate Std. Error t value Pr(>|t|)    \n## (Intercept)      -24.8506    13.3031  -1.868  0.07910 .  \n## Ration             1.0109     0.1626   6.218 9.36e-06 ***\n## GroupSubordinate  17.0120     5.1075   3.331  0.00396 ** \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## \n## Residual standard error: 9.647 on 17 degrees of freedom\n## Multiple R-squared:  0.6946,\tAdjusted R-squared:  0.6587 \n## F-statistic: 19.33 on 2 and 17 DF,  p-value: 4.182e-05\nggPredict(model2) +\n  theme_light() +\n  guides(color=guide_legend(override.aes=list(fill=NA)))\n```\n\n::: {.cell-output-display}\n![](lm-coeff-exercises_files/figure-html/unnamed-chunk-7-1.png){width=480}\n:::\n\n```{.r .cell-code  code-fold=\"false\"}\n\n# and whether there is an interaction effect\nmodel3 <- lm(Energy ~ Ration * Group, data = trout)\nprint(summary(model3))\n## \n## Call:\n## lm(formula = Energy ~ Ration * Group, data = trout)\n## \n## Residuals:\n##      Min       1Q   Median       3Q      Max \n## -12.7951  -6.0981  -0.1554   3.9612  23.5946 \n## \n## Coefficients:\n##                         Estimate Std. Error t value Pr(>|t|)    \n## (Intercept)              -9.2330    15.9394  -0.579 0.570483    \n## Ration                    0.8149     0.1968   4.141 0.000767 ***\n## GroupSubordinate        -18.9558    22.6934  -0.835 0.415848    \n## Ration:GroupSubordinate   0.5200     0.3204   1.623 0.124148    \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## \n## Residual standard error: 9.214 on 16 degrees of freedom\n## Multiple R-squared:  0.7378,\tAdjusted R-squared:  0.6886 \n## F-statistic:    15 on 3 and 16 DF,  p-value: 6.537e-05\nggPredict(model3) +\n  theme_light() +\n  guides(color=guide_legend(override.aes=list(fill=NA)))\n```\n\n::: {.cell-output-display}\n![](lm-coeff-exercises_files/figure-html/unnamed-chunk-7-2.png){width=480}\n:::\n:::\n\n\nBased on the regression output and plots we can say:\n\n- there is a relationship between ration obtained and energy expenditure\n- that this relationship is the same in the two groups although the energy expenditure is higher in the dominant fish\n\n\n::: {.solution}\n\n@exr-drug\n\n:::\n\n\na)\n\nYes. The `redn` and `initial` were significantly associated (p-value = 0.00312, linear regression).\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\nmodel1 <- lm(redn ~ initial, data = blooddrug)\nsummary(model1)\n## \n## Call:\n## lm(formula = redn ~ initial, data = blooddrug)\n## \n## Residuals:\n##     Min      1Q  Median      3Q     Max \n## -23.476 -11.705   1.558   9.197  24.392 \n## \n## Coefficients:\n##             Estimate Std. Error t value Pr(>|t|)   \n## (Intercept) -72.7302    29.1879  -2.492  0.02036 * \n## initial       0.5902     0.1788   3.301  0.00312 **\n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## \n## Residual standard error: 12.79 on 23 degrees of freedom\n## Multiple R-squared:  0.3214,\tAdjusted R-squared:  0.2919 \n## F-statistic: 10.89 on 1 and 23 DF,  p-value: 0.003125\n```\n:::\n\n\nb)\n\nNo. The `drug2` and `drug3` were not significantly different from `drug1` (p-value = 0.714 and p-value = 0.628, respectively). The patients of the drug 1 group had 2.750 higher blood pressure drop (`redn`) than those of the drug 2 group. However, the difference was relatively small comparing to the standard error of the estimate, which was 7.402.\nThe difference between drug 1 and 3 was relatively small, too.\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\nmodel2 <- lm(redn ~ drug, data = blooddrug)\nsummary(model2)\n## \n## Call:\n## lm(formula = redn ~ drug, data = blooddrug)\n## \n## Residuals:\n##     Min      1Q  Median      3Q     Max \n## -32.000  -9.286   0.000  12.714  26.000 \n## \n## Coefficients:\n##             Estimate Std. Error t value Pr(>|t|)    \n## (Intercept)   23.250      5.517   4.214 0.000358 ***\n## drug2          2.750      7.402   0.372 0.713796    \n## drug3         -3.964      8.076  -0.491 0.628379    \n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## \n## Residual standard error: 15.6 on 22 degrees of freedom\n## Multiple R-squared:  0.03349,\tAdjusted R-squared:  -0.05437 \n## F-statistic: 0.3812 on 2 and 22 DF,  p-value: 0.6875\n```\n:::\n\n\nc)\n\nYes. The `redn` of the `drug2` group was significantly higher than that of the `drug1` group after adjustment for the effects of the `initial` (P = 0.018).\nThe reduction of the patients who got the drug 2 was much higher (13.6906) than the drug 1, comparing to the standard error of the difference (5.3534) after accounting for initial blood pressure.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\nmodel3 <- lm(redn ~ drug + initial, data = blooddrug)\nsummary(model3)\n## \n## Call:\n## lm(formula = redn ~ drug + initial, data = blooddrug)\n## \n## Residuals:\n##      Min       1Q   Median       3Q      Max \n## -15.8114 -10.5842  -0.4959   6.2834  16.4265 \n## \n## Coefficients:\n##              Estimate Std. Error t value Pr(>|t|)    \n## (Intercept) -124.8488    28.0674  -4.448 0.000223 ***\n## drug2         13.6906     5.3534   2.557 0.018346 *  \n## drug3         -7.2045     5.4275  -1.327 0.198625    \n## initial        0.8895     0.1671   5.323 2.81e-05 ***\n## ---\n## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n## \n## Residual standard error: 10.42 on 21 degrees of freedom\n## Multiple R-squared:  0.5886,\tAdjusted R-squared:  0.5298 \n## F-statistic: 10.01 on 3 and 21 DF,  p-value: 0.0002666\n```\n:::\n",
    "supporting": [
      "lm-coeff-exercises_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}