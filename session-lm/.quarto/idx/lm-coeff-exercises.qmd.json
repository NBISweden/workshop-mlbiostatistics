{"title":"Exercises (Regression coefficients)","markdown":{"headingText":"Exercises (Regression coefficients)","containsRefs":false,"markdown":"\n```{r}\n#| message: false\n#| warning: false\n#| echo: false\n\n# load libraries\nlibrary(tidyverse)\nlibrary(magrittr)\nlibrary(kableExtra)\nlibrary(gridExtra)\nlibrary(ggplot2)\nlibrary(faraway)\nlibrary(ggiraphExtra)\n\nfont.size <- 12\ncol.blue.light <- \"#a6cee3\"\ncol.blue.dark <- \"#1f78b4\"\nmy.ggtheme <- theme(axis.title = element_text(size = font.size), \n        axis.text = element_text(size = font.size), \n        legend.text = element_text(size = font.size), \n        legend.title = element_blank(), \n        legend.position = \"top\") \n\n```\n\n**Data for exercises** are on Canvas under Files -> data_exercises --> linear-models\n\n::: {#exr-rerun}\n\n## Height-weigth-gender\n\na) repeat fitting the models with a) gender, b) weight and gender and c) interaction between weight and gender\nb) given the model with the interaction term, what is expected height of a man and a women given a weight of 120 lbs?\nc) can you use predict() function to check your calculations?\n\n:::\n\n\n::: {#exr-trout}\n\n## Trout\n\nWhen the behavior of a group of trout is studied, some fish are observed to become dominant and others to become subordinate. Dominant fish have freedom of movement whereas subordinate fish tend to congregate in the periphery of the waterway to avoid crossing the path of the dominant fish. Data on energy expenditure and ration of blood obtained were collected as part of a laboratory experiment for 20 trout. Energy and ration is measured in calories per kilo-calorie per trout per day.\n\nUse the below code to load the data to R and use linear regression models to answer:\n\n- a) is there a relationship between ration obtained and energy expenditure\n- b) is the relationship between ration obtained and energy expenditure different for each type of fish?\n- Hint: it is good to start with some explanatory plots between every pair of variable\n\n:::\n\n```{r}\n#| code-fold: false\n\n# read in data and show preview\ntrout <- read.csv(\"data/lm/trout.csv\")\n\n# recode the Group variable and treat like categories (factor)\ntrout$Group <- factor(trout$Group, labels=c(\"Dominant\", \"Subordinate\"))\n\n```\n\n\n\n\n\n\n::: {#exr-drug}\n\n## Lowering blood pressure\n\nA clinical trial has been carried out to compare three drug treatments which are intended to lower blood pressure in hypertensive patients. The data contains initial values fo systolic blood pressure (bp) in mmHg for each patient and the reduction achieved during the course of the trial. For each patient, allocation to treatment (drug) was carried out randomly and conditions such as the length of the treatment and dose of the drug were standardized as far as possible.\n\nUse linear regression to answer questions:\n\na) is there an association between the reduction in blood pressure and initial blood pressure\nb) is reduction in blood pressure different across the treatment (in three drug groups)?\nc) is reduction in blood pressure different across the treatment when accounting for initial blood pressure?\nd) is reduction in blood pressure changing differently under different treatment?\nHint: here we have three categories which can be seen as expanding the model with two categories by an additional one: one category will be treated as baseline\n\n:::\n\n```{r}\n#| code-fold: false\n\nblooddrug <- read.csv(\"data/lm/bloodrug.csv\")\nblooddrug$drug <- factor(blooddrug$drug)\nhead(blooddrug)\n```\n\n\n## Answers to selected exercises \n\n::: {.solution}\n\n@exr-rerun\n\n:::\n\n\na)\n```{r}\n#| code-fold: false\n#| collapse: false\n\nhtwtgen <- read.csv(\"data/lm/heights_weights_genders.csv\")\nhead(htwtgen)\n\n# a)\nmodel1 <- lm(Height ~ Gender, data = htwtgen)\nmodel2 <- lm(Height ~ Gender + Weight, data = htwtgen)\nmodel3 <- lm(Height ~ Gender * Weight, data = htwtgen)\n\n# print(summary(model1))\n# print(summary(model2))\n# print(summary(model3))\n```\n\nb) use equations to find the height for men and women respectively:\n$$E(height|male\\; and \\; weight=x)=47.34778 - 1.68367 + 0.12043x + 0.00449x = 45.7 + 0.125x$$\n$$E(height|female\\; and \\; weight=x)=47.34778 + 0.12043x$$\n\nc)\n```{r}\n#| code-fold: false\n#| collapse: false\n\n# for men\nnew.obs <- data.frame(Weight=120, Gender=\"Male\")\npredict(model3, newdata = new.obs)\n\n# for female\nnew.obs <- data.frame(Weight=120, Gender=\"Female\")\npredict(model3, newdata = new.obs)\n\n```\n\n\n::: {.solution}\n\n@exr-trout\n\n:::\n\n\n```{r}\n#| code-fold: false\n#| collapse: true\n#| fig-width: 5\n#| fig-height: 4\n\n# read in data and show preview\ntrout <- read.csv(\"data/lm/trout.csv\")\n\n# recode the Group variable and treat like categories (factor)\ntrout$Group <- factor(trout$Group, labels=c(\"Dominant\", \"Subordinate\"))\nhead(trout)\n\n# plot data\n# boxplots of Energy and Ration per group\nboxplot(trout$Energy ~ trout$Group, xlab=\"\", ylab=\"Energy\")\nboxplot(trout$Ration ~ trout$Group, xlab=\"\", ylab=\"Ration\")\n\n# scatter plot of Ration vs. Energy\nplot(trout$Ration, trout$Energy, pch=19, xlab=\"Ration\", ylab=\"Energy\")\n\n```\n\n- From the exploratory plots we see that there is some sort of relationship between ratio and energy, i.e. energy increase while ration obtained increases\n- From box plots we see that the ration obtained may be different in two groups\n\n```{r}\n#| code-fold: false\n#| collapse: true\n#| fig-width: 5\n#| fig-height: 4\n#| fig-keep: all\n\n# Is there a relationship between ration obtained and energy expenditure\nmodel1 <- lm(Energy ~ Ration, data = trout)\nprint(summary(model1))\n# from the regression output we can see that yes, a unit increase in ratio increase energy expenditure by 0.72\n\n# Is there a relationship between ration obtained and energy expenditure different for each type of fish?\n# we first check if there is a group effect\nmodel2 <- lm(Energy ~ Ration + Group, data = trout)\nprint(summary(model2))\nggPredict(model2) +\n  theme_light() +\n  guides(color=guide_legend(override.aes=list(fill=NA)))\n\n# and whether there is an interaction effect\nmodel3 <- lm(Energy ~ Ration * Group, data = trout)\nprint(summary(model3))\nggPredict(model3) +\n  theme_light() +\n  guides(color=guide_legend(override.aes=list(fill=NA)))\n\n```\n\nBased on the regression output and plots we can say:\n\n- there is a relationship between ration obtained and energy expenditure\n- that this relationship is the same in the two groups although the energy expenditure is higher in the dominant fish\n\n\n::: {.solution}\n\n@exr-drug\n\n:::\n\n\na)\n\nYes. The `redn` and `initial` were significantly associated (p-value = 0.00312, linear regression).\n\n```{r}\n#| collapse: true\n#| code-fold: false\n\nmodel1 <- lm(redn ~ initial, data = blooddrug)\nsummary(model1)\n```\n\nb)\n\nNo. The `drug2` and `drug3` were not significantly different from `drug1` (p-value = 0.714 and p-value = 0.628, respectively). The patients of the drug 1 group had 2.750 higher blood pressure drop (`redn`) than those of the drug 2 group. However, the difference was relatively small comparing to the standard error of the estimate, which was 7.402.\nThe difference between drug 1 and 3 was relatively small, too.\n```{r}\n#| collapse: true\n#| code-fold: false\n\nmodel2 <- lm(redn ~ drug, data = blooddrug)\nsummary(model2)\n```\n\nc)\n\nYes. The `redn` of the `drug2` group was significantly higher than that of the `drug1` group after adjustment for the effects of the `initial` (P = 0.018).\nThe reduction of the patients who got the drug 2 was much higher (13.6906) than the drug 1, comparing to the standard error of the difference (5.3534) after accounting for initial blood pressure.\n\n```{r}\n#| collapse: true\n#| code-fold: false\n\nmodel3 <- lm(redn ~ drug + initial, data = blooddrug)\nsummary(model3)\n\n```\n\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-yaml":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":true,"code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","output-file":"lm-coeff-exercises.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.0.36","bibliography":["references.bib"],"theme":"cosmo"},"extensions":{"book":{"multiFile":true}}},"pdf":{"execute":{"fig-width":5.5,"fig-height":3.5,"fig-format":"pdf","fig-dpi":300,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-yaml":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"pdf","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"pdf-engine":"xelatex","standalone":true,"variables":{"graphics":true,"tables":true},"default-image-extension":"pdf","to":"pdf","output-file":"lm-coeff-exercises.pdf"},"language":{},"metadata":{"block-headings":true,"bibliography":["references.bib"],"documentclass":"scrreprt"},"extensions":{"book":{}}}}}