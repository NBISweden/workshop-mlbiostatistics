{"title":"Exercises (Model diagnostics)","markdown":{"headingText":"Exercises (Model diagnostics)","containsRefs":false,"markdown":"\n**Data for exercises** are on Canvas under Files -> data_exercises --> linear-models\n\n\n::: {#exr-brozek}\n\n## Brozek score\n\nResearchers collected age, weight, height and 10 body circumference measurements for 252 men in an attempt to find an alternative way of calculate body fat as oppose to measuring someone weight and volume, the latter one by submerging in a water tank. Is it possible to predict body fat using easy-to-record measurements?\n\nUse lm() function and fit a linear method to model brozek, score estimate of percent body fat\n\n- find $R^2$ and $R^2(adj)$\n- assess the diagnostics plots to check for model assumptions\n- delete observation #86 with the highest Cook's distance and re-fit the model (model.clean)\n- look at the model summary. Are all variables associated with brozek score?\n- try improving the model fit by removing variables with the highest p-value first and re-fitting the model until all the variables are significantly associated with the response (p value less than 0.1); note down the $R^2(adj)$ values while doing so\n- compare the output models for model.clean and final model\n\n:::\n\n\nTo access and preview the data:\n```{r, collapse=TRUE}\ndata(fat, package = \"faraway\")\n```\n\n## Answers to selected exercises {-}\n\n::: {.solution}\n\n@exr-brozek\n\n:::\n\n\n```{r}\n#| collapse: true\n#| code-fold: false\n#| fig-align: center\n\n# access and preview data\ndata(fat, package = \"faraway\")\nhead(fat)\n\n# fit linear regression model\nmodel.all <- lm(brozek ~ age + weight + height + neck + abdom + hip + thigh + knee + ankle + biceps + forearm + wrist, data = fat)\n\n# print model summary\nprint(summary(model.all))\n\n# diagnostics plots\npar(mfrow=c(2,2))\nplot(model.all)\n\n# remove potentially influential observations\nobs <- c(86)\nfat2 <- fat[-obs, ]\n\n# re-fit the model\nmodel.clean <- lm(brozek ~ age + weight + height + neck + abdom + hip + thigh + knee + ankle + biceps + forearm + wrist, data = fat)\n\n# diagnostics plots\npar(mfrow=c(2,2))\nplot(model.clean)\n\n# model summary\nprint(summary(model.clean))\n\n# re-fit the model (no height)\nmodel.red1 <- lm(brozek ~ age + weight + neck + abdom + hip + thigh + knee + ankle + biceps + forearm + wrist, data = fat)\nprint(summary(model.red1))\n\n# re-fit the model (no knee)\nmodel.red2 <- lm(brozek ~ age + weight + neck + abdom + hip + thigh + ankle + biceps + forearm + wrist, data = fat)\nprint(summary(model.red2))\n\n# re-fit the model (no ankle)\nmodel.red3 <- lm(brozek ~ age + weight + neck + abdom + hip + thigh  + biceps + forearm + wrist, data = fat)\nprint(summary(model.red3))\n\n# re-fit the model (no biceps)\nmodel.red4 <- lm(brozek ~ age + weight + neck + abdom + hip + thigh  + forearm + wrist, data = fat)\nprint(summary(model.red4))\n\n# re-fit the model (no hip)\nmodel.red5 <- lm(brozek ~ age + weight + neck + abdom  + thigh  + forearm + wrist, data = fat)\nprint(summary(model.red5))\n\n# compare model.clean and final model\nprint(summary(model.clean))\nprint(summary(model.red5))\n\n```\n\n*Note: we have just run a very simple feature selection using stepwise regression. In this method, using backward elimination, we build a model containing all the variables and remove them one by one based on defined criteria (here we have used p-values) and we stop when we have a justifiable model or when removing a predictor does not change the chosen criterion significantly.*\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-yaml":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":true,"code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","output-file":"lm-diagn-exercises.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.0.36","bibliography":["references.bib"],"theme":"cosmo"},"extensions":{"book":{"multiFile":true}}},"pdf":{"execute":{"fig-width":5.5,"fig-height":3.5,"fig-format":"pdf","fig-dpi":300,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-yaml":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"pdf","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"pdf-engine":"xelatex","standalone":true,"variables":{"graphics":true,"tables":true},"default-image-extension":"pdf","to":"pdf","output-file":"lm-diagn-exercises.pdf"},"language":{},"metadata":{"block-headings":true,"bibliography":["references.bib"],"documentclass":"scrreprt"},"extensions":{"book":{}}}}}