{
  "hash": "543469abc1086f82989808f02ab02be8",
  "result": {
    "markdown": "---\noutput: html_document\neditor_options: \n  chunk_output_type: console\n---\n\n# Exercises\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# load libraries\nlibrary(tidyverse)\nlibrary(kableExtra)\nlibrary(ggplot2)\nlibrary(ggbeeswarm)\nlibrary(gridExtra)\n```\n:::\n\n\n\n::: {#exr-diabetes}\n\n## Summarize diabetes data\n\nUse below code to load diabetes data set and calculate `BMI` and add categorical variable `obese` (Yes) if $BMI \\ge 30$ and No otherwise. Summarize variables: `obese`, `age` and `gender` reporting mean and sample standard deviation for numerical variables and counts and percentage per group for categorical variables.\n\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\nlibrary(faraway)\nlibrary(tidyverse)\n\ninch2m <- 2.54/100\npound2kg <- 0.45\ndata_diabetes <- diabetes %>%\n  mutate(height  = height * inch2m, height = round(height, 2)) %>% \n  mutate(waist = waist * inch2m) %>%  \n  mutate(weight = weight * pound2kg, weight = round(weight, 2)) %>%\n  mutate(BMI = weight / height^2, BMI = round(BMI, 2)) %>% \n  mutate(obese= cut(BMI, breaks = c(0, 29.9, 100), labels = c(\"No\", \"Yes\"))) \n```\n:::\n\n\n\n::: {#exr-diabetes-plot}\n\n## Plot diabetes data\n\nTry various plots to visualize diabetes variables: `BMI` and `gender`. Start by making a histogram and density plot for BMI and box plot of BMI stratified by gender status. Can you think of any other plots that may be useful here to visualize the relationships between BMI and gender?\n\n:::\n\n## Solutions: Descriptive statistics {-}  \n\n::: {.solution}\n@exr-diabetes\n:::\n\nAge is a numerical variable and we can calculate mean and sample standard deviation for example as below: \n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\ndata_diabetes %>%\n  select(age) %>%\n  summarize(age_mean = mean(age, na.rm = T), \n            age_sd = sd(age, na.rm = T)) %>%\n  print()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  age_mean   age_sd\n1 46.85112 16.31233\n```\n:::\n:::\n\n\nGender and obesity status are categorical variables and we can calculate counts and percentages per groups as below:\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\nsummary_gender <- data_diabetes %>%\n  select(gender) %>%\n  group_by(gender) %>%\n  summarize(n = n()) %>%\n  mutate(percent = n * 100 / nrow(data_diabetes)) %>%\n  print()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2 × 3\n  gender     n percent\n  <fct>  <int>   <dbl>\n1 male     169    41.9\n2 female   234    58.1\n```\n:::\n\n```{.r .cell-code  code-fold=\"false\"}\nsummary_obese <- data_diabetes %>%\n  select(obese) %>%\n  group_by(obese) %>%\n  summarize(n = n()) %>%\n  mutate(percent = n * 100 / nrow(data_diabetes)) %>%\n  print()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 3 × 3\n  obese     n percent\n  <fct> <int>   <dbl>\n1 No      253   62.8 \n2 Yes     144   35.7 \n3 <NA>      6    1.49\n```\n:::\n:::\n\n\nAlternatively, we can use one of the many R data summaries packages, for instance `arsenal` to summarize obesity status by age and gender.\n\n::: {.cell messages='false'}\n\n```{.r .cell-code  code-fold=\"false\"}\nlibrary(arsenal)\n\ntab1 <- tableby(obese ~ gender + age, data=data_diabetes)\nsummary(tab1)\n```\n\n\n\n|                            |   No (N=253)    |   Yes (N=144)   |  Total (N=397)  | p value|\n|:---------------------------|:---------------:|:---------------:|:---------------:|-------:|\n|**gender**                  |                 |                 |                 | < 0.001|\n|&nbsp;&nbsp;&nbsp;male      |   128 (50.6%)   |   40 (27.8%)    |   168 (42.3%)   |        |\n|&nbsp;&nbsp;&nbsp;female    |   125 (49.4%)   |   104 (72.2%)   |   229 (57.7%)   |        |\n|**age**                     |                 |                 |                 |   0.734|\n|&nbsp;&nbsp;&nbsp;Mean (SD) | 47.103 (16.745) | 46.521 (15.831) | 46.892 (16.402) |        |\n|&nbsp;&nbsp;&nbsp;Range     | 19.000 - 91.000 | 20.000 - 92.000 | 19.000 - 92.000 |        |\n:::\n\n\nAnother popular package is `gtsummary` that calculates descriptive statistics for continuous, categorical, and dichotomous variables in R, and presents the results in customizable summary table ready for publication. \n\n\n::: {.cell messages='false'}\n\n```{.r .cell-code  code-fold=\"false\"}\nlibrary(gtsummary)\n\ndata_diabetes %>%\n  select(age, gender, obese) %>%\n  tbl_summary(by = obese, \n              statistic = list(all_continuous() ~ \"{mean} ({sd})\"))\n```\n\n::: {.cell-output-display}\n```{=html}\n<div id=\"otaotmtrwa\" style=\"padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;\">\n<style>#otaotmtrwa table {\n  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n}\n\n#otaotmtrwa thead, #otaotmtrwa tbody, #otaotmtrwa tfoot, #otaotmtrwa tr, #otaotmtrwa td, #otaotmtrwa th {\n  border-style: none;\n}\n\n#otaotmtrwa p {\n  margin: 0;\n  padding: 0;\n}\n\n#otaotmtrwa .gt_table {\n  display: table;\n  border-collapse: collapse;\n  line-height: normal;\n  margin-left: auto;\n  margin-right: auto;\n  color: #333333;\n  font-size: 16px;\n  font-weight: normal;\n  font-style: normal;\n  background-color: #FFFFFF;\n  width: auto;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #A8A8A8;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #A8A8A8;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n}\n\n#otaotmtrwa .gt_caption {\n  padding-top: 4px;\n  padding-bottom: 4px;\n}\n\n#otaotmtrwa .gt_title {\n  color: #333333;\n  font-size: 125%;\n  font-weight: initial;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-color: #FFFFFF;\n  border-bottom-width: 0;\n}\n\n#otaotmtrwa .gt_subtitle {\n  color: #333333;\n  font-size: 85%;\n  font-weight: initial;\n  padding-top: 3px;\n  padding-bottom: 5px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-color: #FFFFFF;\n  border-top-width: 0;\n}\n\n#otaotmtrwa .gt_heading {\n  background-color: #FFFFFF;\n  text-align: center;\n  border-bottom-color: #FFFFFF;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#otaotmtrwa .gt_bottom_border {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#otaotmtrwa .gt_col_headings {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n}\n\n#otaotmtrwa .gt_col_heading {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 6px;\n  padding-left: 5px;\n  padding-right: 5px;\n  overflow-x: hidden;\n}\n\n#otaotmtrwa .gt_column_spanner_outer {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: normal;\n  text-transform: inherit;\n  padding-top: 0;\n  padding-bottom: 0;\n  padding-left: 4px;\n  padding-right: 4px;\n}\n\n#otaotmtrwa .gt_column_spanner_outer:first-child {\n  padding-left: 0;\n}\n\n#otaotmtrwa .gt_column_spanner_outer:last-child {\n  padding-right: 0;\n}\n\n#otaotmtrwa .gt_column_spanner {\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: bottom;\n  padding-top: 5px;\n  padding-bottom: 5px;\n  overflow-x: hidden;\n  display: inline-block;\n  width: 100%;\n}\n\n#otaotmtrwa .gt_spanner_row {\n  border-bottom-style: hidden;\n}\n\n#otaotmtrwa .gt_group_heading {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  text-align: left;\n}\n\n#otaotmtrwa .gt_empty_group_heading {\n  padding: 0.5px;\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  vertical-align: middle;\n}\n\n#otaotmtrwa .gt_from_md > :first-child {\n  margin-top: 0;\n}\n\n#otaotmtrwa .gt_from_md > :last-child {\n  margin-bottom: 0;\n}\n\n#otaotmtrwa .gt_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  margin: 10px;\n  border-top-style: solid;\n  border-top-width: 1px;\n  border-top-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 1px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 1px;\n  border-right-color: #D3D3D3;\n  vertical-align: middle;\n  overflow-x: hidden;\n}\n\n#otaotmtrwa .gt_stub {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#otaotmtrwa .gt_stub_row_group {\n  color: #333333;\n  background-color: #FFFFFF;\n  font-size: 100%;\n  font-weight: initial;\n  text-transform: inherit;\n  border-right-style: solid;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n  padding-left: 5px;\n  padding-right: 5px;\n  vertical-align: top;\n}\n\n#otaotmtrwa .gt_row_group_first td {\n  border-top-width: 2px;\n}\n\n#otaotmtrwa .gt_row_group_first th {\n  border-top-width: 2px;\n}\n\n#otaotmtrwa .gt_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#otaotmtrwa .gt_first_summary_row {\n  border-top-style: solid;\n  border-top-color: #D3D3D3;\n}\n\n#otaotmtrwa .gt_first_summary_row.thick {\n  border-top-width: 2px;\n}\n\n#otaotmtrwa .gt_last_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#otaotmtrwa .gt_grand_summary_row {\n  color: #333333;\n  background-color: #FFFFFF;\n  text-transform: inherit;\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#otaotmtrwa .gt_first_grand_summary_row {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-top-style: double;\n  border-top-width: 6px;\n  border-top-color: #D3D3D3;\n}\n\n#otaotmtrwa .gt_last_grand_summary_row_top {\n  padding-top: 8px;\n  padding-bottom: 8px;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-bottom-style: double;\n  border-bottom-width: 6px;\n  border-bottom-color: #D3D3D3;\n}\n\n#otaotmtrwa .gt_striped {\n  background-color: rgba(128, 128, 128, 0.05);\n}\n\n#otaotmtrwa .gt_table_body {\n  border-top-style: solid;\n  border-top-width: 2px;\n  border-top-color: #D3D3D3;\n  border-bottom-style: solid;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n}\n\n#otaotmtrwa .gt_footnotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#otaotmtrwa .gt_footnote {\n  margin: 0px;\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#otaotmtrwa .gt_sourcenotes {\n  color: #333333;\n  background-color: #FFFFFF;\n  border-bottom-style: none;\n  border-bottom-width: 2px;\n  border-bottom-color: #D3D3D3;\n  border-left-style: none;\n  border-left-width: 2px;\n  border-left-color: #D3D3D3;\n  border-right-style: none;\n  border-right-width: 2px;\n  border-right-color: #D3D3D3;\n}\n\n#otaotmtrwa .gt_sourcenote {\n  font-size: 90%;\n  padding-top: 4px;\n  padding-bottom: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n#otaotmtrwa .gt_left {\n  text-align: left;\n}\n\n#otaotmtrwa .gt_center {\n  text-align: center;\n}\n\n#otaotmtrwa .gt_right {\n  text-align: right;\n  font-variant-numeric: tabular-nums;\n}\n\n#otaotmtrwa .gt_font_normal {\n  font-weight: normal;\n}\n\n#otaotmtrwa .gt_font_bold {\n  font-weight: bold;\n}\n\n#otaotmtrwa .gt_font_italic {\n  font-style: italic;\n}\n\n#otaotmtrwa .gt_super {\n  font-size: 65%;\n}\n\n#otaotmtrwa .gt_footnote_marks {\n  font-size: 75%;\n  vertical-align: 0.4em;\n  position: initial;\n}\n\n#otaotmtrwa .gt_asterisk {\n  font-size: 100%;\n  vertical-align: 0;\n}\n\n#otaotmtrwa .gt_indent_1 {\n  text-indent: 5px;\n}\n\n#otaotmtrwa .gt_indent_2 {\n  text-indent: 10px;\n}\n\n#otaotmtrwa .gt_indent_3 {\n  text-indent: 15px;\n}\n\n#otaotmtrwa .gt_indent_4 {\n  text-indent: 20px;\n}\n\n#otaotmtrwa .gt_indent_5 {\n  text-indent: 25px;\n}\n</style>\n<table class=\"gt_table\" data-quarto-disable-processing=\"false\" data-quarto-bootstrap=\"false\">\n  <thead>\n    <tr class=\"gt_col_headings\">\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_left\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;Characteristic&lt;/strong&gt;\"><strong>Characteristic</strong></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;No&lt;/strong&gt;, N = 253&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;\"><strong>No</strong>, N = 253<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;\"><sup>1</sup></span></th>\n      <th class=\"gt_col_heading gt_columns_bottom_border gt_center\" rowspan=\"1\" colspan=\"1\" scope=\"col\" id=\"&lt;strong&gt;Yes&lt;/strong&gt;, N = 144&lt;span class=&quot;gt_footnote_marks&quot; style=&quot;white-space:nowrap;font-style:italic;font-weight:normal;&quot;&gt;&lt;sup&gt;1&lt;/sup&gt;&lt;/span&gt;\"><strong>Yes</strong>, N = 144<span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;\"><sup>1</sup></span></th>\n    </tr>\n  </thead>\n  <tbody class=\"gt_table_body\">\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">age</td>\n<td headers=\"stat_1\" class=\"gt_row gt_center\">47 (17)</td>\n<td headers=\"stat_2\" class=\"gt_row gt_center\">47 (16)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">gender</td>\n<td headers=\"stat_1\" class=\"gt_row gt_center\"><br /></td>\n<td headers=\"stat_2\" class=\"gt_row gt_center\"><br /></td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    male</td>\n<td headers=\"stat_1\" class=\"gt_row gt_center\">128 (51%)</td>\n<td headers=\"stat_2\" class=\"gt_row gt_center\">40 (28%)</td></tr>\n    <tr><td headers=\"label\" class=\"gt_row gt_left\">    female</td>\n<td headers=\"stat_1\" class=\"gt_row gt_center\">125 (49%)</td>\n<td headers=\"stat_2\" class=\"gt_row gt_center\">104 (72%)</td></tr>\n  </tbody>\n  \n  <tfoot class=\"gt_footnotes\">\n    <tr>\n      <td class=\"gt_footnote\" colspan=\"3\"><span class=\"gt_footnote_marks\" style=\"white-space:nowrap;font-style:italic;font-weight:normal;\"><sup>1</sup></span> Mean (SD); n (%)</td>\n    </tr>\n  </tfoot>\n</table>\n</div>\n```\n:::\n:::\n\n\n\n\n::: {.solution}\n@exr-diabetes-plot\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\nfont.size <- 12\ncol.blue.light <- \"#a6cee3\"\ncol.blue.dark <- \"#1f78b4\"\nmy.ggtheme <- theme(axis.title = element_text(size = font.size), \n        axis.text = element_text(size = font.size), \n        legend.text = element_text(size = font.size), \n        legend.title = element_blank(), \n        legend.position = \"top\", \n        axis.title.y = element_text(angle = 0)) + theme_bw()\n  \nplt_hist <- data_diabetes %>%\n  ggplot(aes(x = BMI)) +\n  geom_histogram() + \n  my.ggtheme\n\nplt_density <- data_diabetes %>%\n  ggplot(aes(x = BMI)) +\n  geom_density() + \n  my.ggtheme\n\nplt_boxplot <- data_diabetes %>%\n  ggplot(aes(x = gender, y = BMI)) + \n  geom_boxplot() + \n  my.ggtheme\n  \n\nplt_hist\n```\n\n::: {.cell-output-display}\n![](exercises_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n\n```{.r .cell-code  code-fold=\"false\"}\nplt_density\n```\n\n::: {.cell-output-display}\n![](exercises_files/figure-html/unnamed-chunk-7-2.png){width=672}\n:::\n\n```{.r .cell-code  code-fold=\"false\"}\nplt_boxplot           \n```\n\n::: {.cell-output-display}\n![](exercises_files/figure-html/unnamed-chunk-7-3.png){width=672}\n:::\n:::\n\n\nIn addition, we could for instance try beeswarm plot and/or histogram stratified by gender. Or we can try also overlaying box plots over the jitter plot either for all BMI variables or separately for males and females. Sometimes, it may be also a good idea to plot summary statistics, e.g. a barplot at a height of means and error bars representing standard deviation, error bars or confidence intervals. See this post for inspiration if you'd like to try plotting the summary statistics instead [http://www.cookbook-r.com/Graphs/Plotting_means_and_error_bars_(ggplot2)/](http://www.cookbook-r.com/Graphs/Plotting_means_and_error_bars_(ggplot2)/)\n\n\n\n",
    "supporting": [
      "exercises_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}