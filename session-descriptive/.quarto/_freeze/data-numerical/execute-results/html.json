{
  "hash": "db742e07f1d8988c156bfbbb19317bdc",
  "result": {
    "markdown": "---\noutput: html_document\neditor_options: \n  chunk_output_type: console\n---\n\n# Numerical data\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# load libraries\nlibrary(tidyverse)\nlibrary(kableExtra)\nlibrary(faraway)\nlibrary(scales)\nlibrary(ggbeeswarm)\nlibrary(gridExtra)\n\n# define generic ggplot theme\nfont.size <- 12\ncol.blue.light <- \"#a6cee3\"\ncol.blue.dark <- \"#1f78b4\"\nmy.ggtheme <- theme(axis.title = element_text(size = font.size), \n        axis.text = element_text(size = font.size), \n        legend.text = element_text(size = font.size), \n        legend.title = element_blank(), \n        legend.position = \"top\", \n        axis.title.y = element_text(angle = 0)) \n\n# add obesity and diabetes status to diabetes faraway data\ninch2m <- 2.54/100\npound2kg <- 0.45\ndata_diabetes <- diabetes %>%\n  mutate(height  = height * inch2m, height = round(height, 2)) %>% \n  mutate(waist = waist * inch2m) %>%  \n  mutate(weight = weight * pound2kg, weight = round(weight, 2)) %>%\n  mutate(BMI = weight / height^2, BMI = round(BMI, 2)) %>% \n  mutate(obese= cut(BMI, breaks = c(0, 29.9, 100), labels = c(\"No\", \"Yes\"))) %>% \n  mutate(diabetic = ifelse(glyhb > 7, \"Yes\", \"No\"), diabetic = factor(diabetic, levels = c(\"No\", \"Yes\"))) %>%\n  na.omit()\n```\n:::\n\n\nNumerical data, both discrete and continuous, can be visualized and summarized in many ways. Common plots include **histograms, density plots and scatter plots**. Summary statistics include **measures of location** such as mode and median and **measures of spread** such as variance or median absolute deviation. It is also common to visualize summary statistics, e.g. on box plot. \n\n\n```{mermaid}\n%%| label: fig-num-expanded\n%%| fig-align: center\n%%| fig-cap: \"Example of numerical summaries and graphical visualization applicable to numerical data\"\n%%| fig-cap-location: margin\n\nflowchart TD\n  A(Numerical data) --> B(Numerical summary)\n  A(Numerical data) --> C(Graphical summary)\n  B(Numerical summary) --> D(Measures of location <br/> e.g. mode, average, median)\n  B --> E(Measures of spread <br/> e.g. quartiles, variance, standard deviation)\n  C(Graphical summary) --> F(Histogram <br/> Density plot <br/> Box plot <br/> ...)\n```\n\n\n## Strip plot, Jittered strip plot & Beeswarm plot\n\nWhen the data set is not very big, i.e. does not contain millions of measurements for a given numerical variable of interest, it is recommended to visually assess all measurements on a plot. This can be done in a **1D scatter plot**, called also a strip plot or a dot plot. \n\nFor instance the `age` values for the 130 participants in the diabetes study are: \n\n::: {.cell}\n\n```{.r .cell-code}\nprint(data_diabetes$age)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  [1] 58 30 45 60 33 70 47 66 24 40 42 61 61 70 36 55 65 20 74 51 71 76 40 40 76\n [26] 48 64 21 47 61 65 41 50 83 26 53 50 48 59 63 43 58 59 35 50 27 67 51 51 59\n [51] 58 66 43 65 34 37 61 45 68 63 55 66 63 78 68 61 63 54 50 51 45 38 63 50 44\n [76] 48 69 62 36 47 23 38 40 40 60 63 63 46 56 43 26 30 36 44 63 28 52 53 30 45\n[101] 35 50 27 52 42 39 28 53 55 84 80 60 80 63 37 20 54 58 52 33 37 32 60 42 52\n[126] 25 37 89 53 51\n```\n:::\n:::\n\n\nLet's visualize these age values using a strip plot.\n\n\n::: {.cell fig-cap-location='margin'}\n\n```{.r .cell-code}\n# plot strip plot\ndata_diabetes %>%\n  ggplot(aes(x = \"\", y = age)) + \n  geom_point() + \n  theme_bw() + \n  ylab(\"age\") + \n  xlab(\"\") + \n  my.ggtheme\n```\n\n::: {.cell-output-display}\n![A strip plot showing age values for the 130 study participants](data-numerical_files/figure-html/fig-stripplot-1.png){#fig-stripplot width=576}\n:::\n:::\n\n\nAs year was recorded in years and we have over 100 participants, it happens that some age values are repeated, e.g. we have 2 participants who were 20 years old and 3 that were 30 years old at the time of study. These repeated measurements are shown on top of each other and we cannot see them all. A **jittered strip plot** attempts to reduce such overlays by randomly moving data points by small amounts to the left and right.\n\n::: {.cell fig-cap-location='margin'}\n\n```{.r .cell-code}\n# plot jittered strip plot\ndata_diabetes%>%\n  ggplot(aes(x = \"\", y = age)) + \n  geom_jitter(height = 0, width = 0.25) + \n  theme_bw() + \n  ylab(\"age\") + \n  xlab(\"\") + \n  my.ggtheme\n```\n\n::: {.cell-output-display}\n![A jittered strip plot showing age values for the 130 study participants](data-numerical_files/figure-html/fig-jitter-age-1.png){#fig-jitter-age width=576}\n:::\n:::\n\n\nIn a jittered strip plot some overlays may still occur, as the data points are moved at random. Further, many data points are moved unnecessarily. In a **beeswarm plot** data points are moved only when necessary, and even then the data point is only moved by the minimum distance required to avoid overlays.\n\n::: {.cell fig-cap-location='margin'}\n\n```{.r .cell-code}\n# plot beeswarm\ndata_diabetes %>%\n  ggplot(aes(x = \"\", y = age)) + \n  geom_beeswarm(cex = 2) + \n  theme_bw() + \n  ylab(\"age\") + \n  xlab(\"\") + \n  my.ggtheme\n```\n\n::: {.cell-output-display}\n![A beeswarm showing age values for the 130 study participants](data-numerical_files/figure-html/fig-beeswarm-age-1.png){#fig-beeswarm-age width=576}\n:::\n:::\n\n\n\n## Histogram & density plot\n\nA **histogram** bins the data and counts the number of observations that fall into each bin.\n\n::: {.cell fig-cap-location='margin'}\n\n```{.r .cell-code}\n# plot histogram\ndata_diabetes %>%\n  ggplot(aes(x = age)) + \n  geom_histogram(binwidth = 5, center = 32.5, color = \"white\", fill = col.blue.dark) + \n  theme_bw() + \n  xlab(\"age\") + \n  my.ggtheme\n```\n\n::: {.cell-output-display}\n![A histogram summarizing age values for the 130 study participants](data-numerical_files/figure-html/fig-hist-age-1.png){#fig-hist-age width=576}\n:::\n:::\n\n\nA **density plot** is like a smoothed histogram where the total area under the curve is set to 1. A density plot is an approximation of a distribution.\n\n::: {.cell fig-cap-location='margin'}\n\n```{.r .cell-code}\n# plot density plot\ndata_diabetes %>% ggplot(aes(x = age)) + \n  geom_density() + \n  theme_bw() + \n  xlab(\"age\") + \n  my.ggtheme\n```\n\n::: {.cell-output-display}\n![A density plot of age values for the 130 study participants](data-numerical_files/figure-html/fig-age-density-1.png){#fig-age-density width=576}\n:::\n:::\n\n\n## Histogram & density plot stratified by group\n\n::: {.cell fig-cap-location='margin'}\n\n```{.r .cell-code}\n# plot histogram\np.hist <- data_diabetes %>%\n  ggplot(aes(x=age, fill=gender)) + \n  geom_histogram(bins=15, color=\"white\", alpha = 0.6) + \n  xlab(\"age\") + \n  theme_bw() + \n  scale_fill_brewer(palette = \"Dark2\") + \n  my.ggtheme\n\np.density <- data_diabetes %>%\n  ggplot(aes(x=age, fill=gender)) + \n  geom_density(alpha = 0.6) + \n  xlab(\"age\") + \n  theme_bw() + \n  scale_fill_brewer(palette = \"Dark2\") + \n  my.ggtheme\n\ngrid.arrange(arrangeGrob(p.hist, p.density, ncol=2))\n```\n\n::: {.cell-output-display}\n![Histogram and density plots summarizing age values stratified by gender](data-numerical_files/figure-html/fig-hist-age-gender-1.png){#fig-hist-age-gender width=1152}\n:::\n:::\n\n\n\n## Scatter plot: 2 numerical variables\n\nScatter plots are useful when studying a relationship (association) between two numerical variables.\nLet's look at the weight and height for our 130 study participants.\n\n\n\n::: {.cell fig-cap-location='margin'}\n\n```{.r .cell-code}\n# plot scatter plot\ndata_diabetes %>%\n  ggplot(aes(x = weight, y = height)) + \n  geom_point() + \n  xlab(\"weight [kg]\") + \n  ylab(\"height [m]\") + \n  theme_bw() + \n  my.ggtheme\n```\n\n::: {.cell-output-display}\n![Scatter plot showing a relationship between weight and height](data-numerical_files/figure-html/fig-scatter-weight-height-1.png){#fig-scatter-weight-height width=576}\n:::\n:::\n\n::: {.cell fig-cap-location='margin'}\n\n```{.r .cell-code}\n# plot scatter plot\ndata_diabetes %>%\n  ggplot(aes(x = weight, y = height, color = gender)) +\n  geom_point() +\n  xlab(\"weight [kg]\") +\n  ylab(\"height [m]\") +\n  theme_bw() +\n  scale_color_brewer(palette = \"Dark2\") +\n  my.ggtheme\n```\n\n::: {.cell-output-display}\n![Scatter plot showing a relationship between weight and height stratified by gender](data-numerical_files/figure-html/fig-scatter-weight-height-by-gender-1.png){#fig-scatter-weight-height-by-gender width=576}\n:::\n:::\n\n\nSometimes, it is useful to connect the observations in the order in which they appear, e.g. when analyzing time series data. The diabetes data set does not contain any measurements over time but we can simulate some BMI values over time for demonstration purposes. \n\n\n\n::: {.cell fig-cap-location='margin'}\n\n```{.r .cell-code}\n# simulate BMI over time\n# select participants with BMI >= 30\n# assign half to control group and half to treatment to reduce weight \n# add simulated weight loss values to treatment group ca. 0.2 kg per week\n# add simulated weight fluctuations, ca plus / minus 0.1 kg per week\n\ndata_diabetes_bmi30 <- data_diabetes %>% \n  filter(BMI >= 30) %>%\n  select(id, weight, height, BMI) %>%\n  mutate(group=sample(c(\"control\", \"treatment\"), size=n(), replace=TRUE))\n\n# add 52 weeks of simulated BMI values\n\nno_weeks <- 12\nweight_sim <- matrix(data = NA, \n                     nrow = nrow(data_diabetes_bmi30), \n                     ncol = no_weeks, \n                     dimnames = list(data_diabetes_bmi30$id, paste(\"week\", 1: no_weeks, sep=\"\"))) # initiate matrix to store simulated BMI values\nweight_sim[, 1] <- data_diabetes_bmi30$weight # first column: baseline weight\n\nfor (n in 1:nrow(data_diabetes_bmi30)){\n  \n  for (p in 2:ncol(weight_sim)){\n    \n    # if control group: just fluctuate weight by random values between 0 and 0.2 kg\n    # if treatment: decrease by random values between 0.1 and 0.5 kg from\n    \n    if (data_diabetes_bmi30$group[n] == \"treatment\"){\n     \n      loss <- runif(1, 0.1, 0.5) %>% round(1)\n      weight_sim[n, p] <- weight_sim[n, p-1] - loss\n      \n    } else{\n      \n      fluctuation <- runif(1, -0.2, 0.2) %>% round(1)\n      weight_sim[n, p] <- weight_sim[n, p-1] + fluctuation\n      \n    }\n  \n  }\n}\n\n# convert to tibble\nweight_sim <- weight_sim %>%\n  as_tibble(rownames = \"id\") %>%\n  mutate(id = as.numeric(id))\n\n# join data_diabetes_bmi30 with simulated\n# keep 5 treatment and 5 control participants\ndata_diabets_sim <- data_diabetes_bmi30 %>%\n  as_tibble() %>% \n  left_join(weight_sim, by = \"id\")\n\n# plot BMI over time\ndata_plot <- data_diabets_sim %>%\n  slice_sample(n = 10) %>%\n  select(-weight, -BMI) %>% \n  pivot_longer(-c(\"id\", \"group\", \"height\"), names_to = \"week\", values_to = \"weight\") %>% \n  mutate(BMI = weight / (height^2)) %>%\n  mutate(week = gsub(\"week\", \"\", week)) %>%\n  mutate(week = as.numeric(week)) \n\ndata_plot %>%\n  ggplot(aes(x = week, y = BMI, group = id)) + \n  geom_point() +\n  geom_line() + \n  xlab(\"week\") +\n  ylab(\"BMI\") +\n  theme_bw() +\n  scale_color_brewer(palette = \"Dark2\") +\n  scale_x_continuous(breaks= pretty_breaks()) + \n  my.ggtheme\n```\n\n::: {.cell-output-display}\n![A line plot for BMI simulated values over 12 weeks for 10 randomly selected study participants](data-numerical_files/figure-html/fig-line-plot-BMI-1.png){#fig-line-plot-BMI width=576}\n:::\n:::\n\n::: {.cell fig-cap-location='margin'}\n\n```{.r .cell-code}\ndata_plot <- data_diabets_sim %>%\n  group_by(group) %>%\n  slice_sample(n = 5) %>%\n  select(-weight, -BMI) %>% \n  pivot_longer(-c(\"id\", \"group\", \"height\"), names_to = \"week\", values_to = \"weight\") %>% \n  mutate(BMI = weight / (height^2)) %>%\n  mutate(week = gsub(\"week\", \"\", week)) %>%\n  mutate(week = as.numeric(week)) \n\ndata_plot %>%\n  ggplot(aes(x = week, y = BMI, group = id, colour = group)) + \n  geom_point() +\n  geom_line() + \n  xlab(\"week\") +\n  ylab(\"BMI\") +\n  theme_bw() +\n  scale_color_brewer(palette = \"Dark2\") +\n  scale_x_continuous(breaks= pretty_breaks()) + \n  my.ggtheme\n```\n\n::: {.cell-output-display}\n![A line plot for BMI simulated values over 12 weeks for 5 randomly selected study participants from control and treatment group](data-numerical_files/figure-html/fig-line-plot-BMI-by-group-1.png){#fig-line-plot-BMI-by-group width=576}\n:::\n:::\n",
    "supporting": [
      "data-numerical_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}