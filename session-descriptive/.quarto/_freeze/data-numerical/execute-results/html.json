{
  "hash": "4aeda4c9e52f8c90bdae1473198d26f8",
  "result": {
    "markdown": "---\noutput: html_document\neditor_options: \n  chunk_output_type: console\n---\n\n# Numerical data\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# load libraries\nlibrary(tidyverse)\nlibrary(kableExtra)\nlibrary(ggplot2)\nlibrary(ggbeeswarm)\nlibrary(gridExtra)\n```\n:::\n\n\nNumerical data, both discrete and continuous, can be visualized and summarized in many ways. Common plots include histograms, density plots, box plots and scatter plots. Summary statistics include mean, median, quantiles, variance, standard deviation and median absolute deviation.\n\n\n```{mermaid}\nflowchart TD\n  A(Numerical data) --> B(Numerical summary)\n  A(Numerical data) --> C(Graphical summary)\n  B(Numerical summary) --> D(Mean <br/> Median <br/> Quantiles <br/> Variance <br/> Standard deviation <br/> Mean absolute deviation <br/> ...)\n  C(Graphical summary) --> E(Histogram <br/> Density plot <br/> Box plot <br/> ...)\n```\n\n\n::: {#exm-dice}\n## Throwing 10 dice\n\nLet's imagine that we have 10 dice and we throw them all at once. We count and record the total number of dots and repeat the whole process 100 times. \n\nThe counts for the first few runs are:\n\n::: {.cell}\n\n```{.r .cell-code}\n# simulate throwing 10 dice, counting dots and repeating the experiment 100 times\nset.seed(123)\nsample.sum10dice <- replicate(100, sum(sample(1:6, 10, replace = TRUE))) \ndata.sum10dice <- data.frame(run = 1:length(sample.sum10dice), sumcounts = sample.sum10dice)\n\nhead(data.sum10dice)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  run sumcounts\n1   1        40\n2   2        29\n3   3        33\n4   4        27\n5   5        40\n6   6        27\n```\n:::\n:::\n\n:::\n\n## Strip plot, Jittered strip plot & Beeswarm plot\nWhen the data set is not very big, i.e. does not contain millions of measurements for a given numerical variable of interest, it can be useful to plot all measurements. This can be done in a **1D scatter plot**, called a strip plot or a dot plot. \n\n::: {.cell .fig-cap-location-margin}\n\n```{.r .cell-code}\n# define generic ggplot theme\nfont.size <- 12\ncol.blue.light <- \"#a6cee3\"\ncol.blue.dark <- \"#1f78b4\"\nmy.ggtheme <- theme(axis.title = element_text(size = font.size), \n        axis.text = element_text(size = font.size), \n        legend.text = element_text(size = font.size), \n        legend.title = element_blank(), \n        legend.position = \"top\") \n\n# plot strip plot\ndata.sum10dice %>%\n  ggplot(aes(x = \"\", y = sumcounts)) + \n  geom_point() + \n  theme_bw() + \n  ylab(\"dot counts (10 dice)\") + \n  xlab(\"\") + \n  my.ggtheme\n```\n\n::: {.cell-output-display}\n![Strip plot showing sum of dots across 10 dice being thrown at once 100 times](data-numerical_files/figure-html/fig-dice10-stripplot-1.png){#fig-dice10-stripplot width=576}\n:::\n:::\n\n\nAs some measurements are repeated, e.g. we count 40 dots in our first attempt in our 40 attempt, the measurements on the strip plot are shown on top of each other and we cannot see them all. A **jittered strip plot** attempts to reduce overlays by randomly moving data points by small amounts to the left and right.\n\n::: {.cell .fig-cap-location-margin}\n\n```{.r .cell-code}\n# plot jittered strip plot\ndata.sum10dice %>%\n  ggplot(aes(x = \"\", y = sumcounts)) + \n  geom_jitter(height = 0, width = 0.35) + \n  theme_bw() + \n  ylab(\"dot counts (10 dice)\") + \n  xlab(\"\") + \n  my.ggtheme\n```\n\n::: {.cell-output-display}\n![Jittered strip plot showing sum of dots across 10 dice being thrown at once 100 times](data-numerical_files/figure-html/fig-dice10-jitter-1.png){#fig-dice10-jitter width=576}\n:::\n:::\n\n\nIn a jittered strip plot some overlays may still occur, as the data points are moved at random. Further, many data points are moved unnecessarily. In a **beeswarm plot** data points are moved only when necessary, and even then the data point is only moved the minimum distance necessary to avoid overlays\n\n::: {.cell .fig-cap-location-margin}\n\n```{.r .cell-code}\n# plot beeswarm\ndata.sum10dice %>%\n  ggplot(aes(x = \"\", y = sumcounts)) + \n  geom_beeswarm(cex = 2) + \n  theme_bw() + \n  ylab(\"dot counts (10 dice)\") + \n  xlab(\"\") + \n  my.ggtheme\n```\n\n::: {.cell-output-display}\n![Beeswarm showing sum of dots across 10 dice being thrown at once 100 times](data-numerical_files/figure-html/fig-dice10-beeswarm-1.png){#fig-dice10-beeswarm width=576}\n:::\n:::\n\n\n\nHistogram & density plot\n\nA **histogram** bins the data and counts the number of observations that fall into each bin.\n\n::: {.cell .fig-cap-location-margin}\n\n```{.r .cell-code}\n# plot histogram\ndata.sum10dice %>%\n  ggplot(aes(x = sumcounts)) + \n  geom_histogram(binwidth = 5, center = 32.5, color = \"white\", fill = col.blue.dark) + \n  theme_bw() + \n  xlab(\"dot counts (10 dice)\") + \n  my.ggtheme\n\n# alternatively un-comment to plot histogram with hist(), base R plot\n# hist(data.sum10dice$counts, main = \"\", xlab=\"counts\")\n```\n\n::: {.cell-output-display}\n![Histogram summarizing the sum of dots across 10 dice being thrown at once 100 times](data-numerical_files/figure-html/fig-dice10-hist-1.png){#fig-dice10-hist width=576}\n:::\n:::\n\n\nA **density plot** is like a smoothed histogram where the total area under the curve is set to 1. A density plot is an approximation of a distribution.\n\n::: {.cell .fig-cap-location-margin}\n\n```{.r .cell-code}\n# plot density plot\ndata.sum10dice %>% ggplot(aes(x = sumcounts)) + \n  geom_density() + \n  theme_bw() + \n  xlab(\"dot counts (10 dice)\") + \n  my.ggtheme\n```\n\n::: {.cell-output-display}\n![Density plot of dot counts across 10 dice](data-numerical_files/figure-html/fig-dice10-density-1.png){#fig-dice10-density width=576}\n:::\n:::\n\n\n## Box plot\n\nA box plot, also called a box-and-whisker plot, shows a box covering 50% of the data and the center line is located at the **median**. The median value is a value such that 50% of the measurements are below the median.\n\nThe whiskers extend to the most extreme data point or at most 1.5 times the length of the box. (Note that 1.5 is the default in both ggplot and basic R graphics, but it is also a number that can be changed.) Any measurements further out are shown as outliers. A box plot is based on both measures of location and of spread (more about these in the following chapters).\n\n\n::: {.cell .fig-cap-location-margin}\n\n```{.r .cell-code}\ndata.sum10dice %>% ggplot(aes(y = sumcounts, x=\"\")) + \n  geom_boxplot(alpha = 1) + \n  geom_jitter(width = 0.35, alpha = 0.2) + \n  theme_bw() + \n  ylab(\"dot counts (10 dice)\") + \n  xlab(\"\") + \n  my.ggtheme\n```\n\n::: {.cell-output-display}\n![Box plot of dot counts across 10 dice thrown 100 times, overlayed on the jittered measurments](data-numerical_files/figure-html/fig-dice10-boxplot-1.png){#fig-dice10-boxplot width=576}\n:::\n:::\n\n\n\n::: {#exm-mice-hist}\n## Lab mice (cont.)\nLet's go back to our lab mice example and focus on the weight measurements that we have observed for our male and female mice over a period of time. How can we summarize the data in a graphical way? \n:::\n\n## Strip plot, jittered stirp plot & beeswarm stratified by group\n\n\n::: {.cell .fig-cap-location-margin}\n\n```{.r .cell-code}\n# read in mice data\ndata.mice <- read_csv(\"data/mice.csv\")\ndata.mice <- data.mice %>%\n  mutate(weight = round(weight,2))\n\n# select weights at week 5\ndata.mice.week5 <- data.mice %>%\n  filter(week == 5)\n  \n# strip plot stratified by sex\np.striplot <- data.mice.week5 %>%\n  ggplot(aes(x = sex, y = weight)) + \n  geom_point() + \n  theme_bw() + \n  xlab(\"\") + \n  ylab(\"weigth (g)\") + \n  my.ggtheme\n\n# jittered strip plot stratified by sex\np.jitter <- data.mice.week5 %>%\n  ggplot(aes(x = sex, y = weight)) +\n  geom_jitter(height = 0, width = 0.2) +\n  theme_bw() +\n  xlab(\"\") +\n  ylab(\"weigth (g)\") +\n  my.ggtheme\n\n# beeswarm stratified by sex\np.beeswarm <- data.mice.week5 %>%\n  ggplot(aes(x = sex, y = weight)) +\n  geom_beeswarm(cex = 3) +\n  theme_bw() +\n  xlab(\"\") +\n  ylab(\"weigth (g)\") +\n  my.ggtheme\n\ngrid.arrange(arrangeGrob(p.striplot, p.jitter, p.beeswarm,ncol=3))\n```\n\n::: {.cell-output-display}\n![Strip plot, jittered strip plot and beeswarm plot showing mice weights at week 5 stratified by sex](data-numerical_files/figure-html/fig-mice10-striplot-1.png){#fig-mice10-striplot width=1152}\n:::\n:::\n\n\n\n## Histogram & density plot stratified by group\n\n::: {.cell .fig-cap-location-margin}\n\n```{.r .cell-code}\n# plot histogram\np.hist <- data.mice.week5 %>%\n  ggplot(aes(x=weight, fill=sex)) + \n  geom_histogram(bins=15, color=\"white\", alpha = 0.6) + \n  xlab(\"weight (g)\") + \n  theme_bw() + \n  scale_fill_brewer(palette = \"Dark2\") + \n  my.ggtheme\n\n\np.density <- data.mice.week5 %>%\n  ggplot(aes(x=weight, fill=sex)) + \n  geom_density(alpha = 0.6) + \n  xlab(\"weight (g)\") + \n  theme_bw() + \n  scale_fill_brewer(palette = \"Dark2\") + \n  my.ggtheme\n\ngrid.arrange(arrangeGrob(p.hist, p.density, ncol=2))\n```\n\n::: {.cell-output-display}\n![Histogram and density plot summarizing the weights of mice at week 5, stratified by sex](data-numerical_files/figure-html/fig-mice10-hist-den-1.png){#fig-mice10-hist-den width=1152}\n:::\n:::\n\n\n\n## Box plot stratified by group\n\n\n::: {.cell .fig-cap-location-margin}\n\n```{.r .cell-code}\n# plot box plot\ndata.mice.week5 %>%\n  ggplot(aes(y=weight, fill=sex)) + \n  geom_boxplot(alpha = 0.6) + \n  xlab(\"weight (g)\") + \n  theme_bw() + \n  scale_fill_brewer(palette = \"Dark2\") + \n  my.ggtheme\n```\n\n::: {.cell-output-display}\n![Box plot of mice weights at week 5 stratified by sex](data-numerical_files/figure-html/fig-mice-boxplot-by-sex-1.png){#fig-mice-boxplot-by-sex width=576}\n:::\n:::\n\n\n## Scatter plot: 2 numerical variables\n\nScatter plots are useful when studying a relationship (association) between two numerical variables. Let's add some data on our mice length and have a look at the relationship between mice weight and length at week 10. \n\n::: {.cell .fig-cap-location-margin}\n\n```{.r .cell-code}\n# simulate mice length data (based on normal distribution)\ndata.mice.week10 <- data.mice %>%\n  filter(week == 10) %>%\n  mutate(length = 7.3+weight/20+rnorm(100,0,0.1)) \n\n# plot scatter plot\ndata.mice.week10 %>%\n  ggplot(aes(x = weight, y = length)) + \n  geom_point() + \n  xlab(\"weigth (g)\") + \n  ylab(\"length (cm)\") + \n  theme_bw() + \n  my.ggtheme\n```\n\n::: {.cell-output-display}\n![Scatter plot showing a relationship between mice weight and length at week 10](data-numerical_files/figure-html/fig-mice-scatter-1.png){#fig-mice-scatter width=576}\n:::\n:::\n\n::: {.cell .fig-cap-location-margin}\n\n```{.r .cell-code}\n# plot scatter plot\ndata.mice.week10 %>%\n  ggplot(aes(x = weight, y = length, color = sex)) +\n  geom_point() +\n  xlab(\"weigth (g)\") +\n  ylab(\"length (cm)\") +\n  theme_bw() +\n  scale_color_brewer(palette = \"Dark2\") +\n  my.ggtheme\n```\n\n::: {.cell-output-display}\n![Scatter plot showing a relationship between mice weight and length at week 10 stratified by sex](data-numerical_files/figure-html/fig-mice-scatter-by-sex-1.png){#fig-mice-scatter-by-sex width=576}\n:::\n:::\n\n\nSometimes, it is useful to connect the observations in the order in which they appear, e.g. when analyzing time series data. \n\n\n::: {.cell .fig-cap-location-margin}\n\n```{.r .cell-code}\n# select four mice, with ids 17, 18 and 19\ndata.mice.4 <- data.mice %>%\n  subset(id %in% 16:19)\n  \n# plot a line plot\ndata.mice.4 %>%\n  ggplot(aes(x=week, y=weight, group=id)) + \n  geom_point() + \n  geom_line() + \n  ylab(\"weigth (g)\") + \n  theme_bw() + \n  my.ggtheme\n```\n\n::: {.cell-output-display}\n![Line plot over age of mouse vs. weight (g) for four mice in the experiment](data-numerical_files/figure-html/fig-mice-sline-plot-1.png){#fig-mice-sline-plot width=576}\n:::\n:::\n\n::: {.cell .fig-cap-location-margin}\n\n```{.r .cell-code}\n# plot a line plot\ndata.mice.4 %>%\n  ggplot(aes(x=week, y=weight, group=id, color = sex)) + \n  geom_point() + \n  geom_line() + \n  ylab(\"weigth (g)\") + \n  theme_bw() + \n  scale_color_brewer(palette = \"Dark2\") + \n  my.ggtheme\n```\n\n::: {.cell-output-display}\n![Line plot over age of mouse vs. weight (g) for four mice in the experiment](data-numerical_files/figure-html/fig-mice-sline-plot-by-sex-1.png){#fig-mice-sline-plot-by-sex width=576}\n:::\n:::\n",
    "supporting": [
      "data-numerical_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}