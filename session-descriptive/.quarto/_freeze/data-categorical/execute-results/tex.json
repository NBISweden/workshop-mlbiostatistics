{
  "hash": "ad1c753f45e9cbf7fd2ce674e7289237",
  "result": {
    "markdown": "# Categorical data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# load libraries\nlibrary(tidyverse)\nlibrary(kableExtra)\nlibrary(ggplot2)\n```\n:::\n\n\n\nCategorical data can be summarized by counting the number of observations of each category and summarizing in a frequency table or graphically in a bar chart. Alternatively we can calculate the the proportions (or percentages) of each category.\n\n\n\n```{mermaid}\nflowchart TD\n  A(Categorical data) --> B(Numerical summary)\n  B(Numerical summary) --> D(Table of frequencies <br/> Proportions <br/> Percentages <br/> ...)\n  A(Categorical data) --> C(Graphical summary)\n  C(Graphical summary) --> E(Bar charts <br/> Pie chart <br/> Mosaic plot <br/> ...)\n```\n\n\n\n<!-- Example: 10 mice -->\n\n\n\n\n\n\n::: {#exm-mice-10}\n## Lab mice: sex\n\nImagine, we run an experiment, in which follow 100 mice over a period of 24 weeks. To begin with, we record mice sex (male/female). In addition, every week we record the weight (g) of each mouse, starting at week 5. How can we summarize the sex (male/female) variable? \n\n::: \n\nThe data can be loaded from [mice.csv](data/mice.csv) and a preview is shown below.\n\n\n::: {#tbl-mice-sex-preview .cell tbl-cap='Preview of the mice data'}\n\n```{.r .cell-code}\n# read in data\nmice <- read_csv(\"data/mice.csv\")\nmice <- mice %>%\n  mutate(weight = round(weight,2))\n\n# # preview data\n# mice %>%\n#   datatable() %>%\n#   formatSignif(columns = c(\"weight\"), digits = 4)\n\n# preview data\nhead(mice) %>%\n  kable() %>% \n  kable_styling(full_width = FALSE)\n```\n\n::: {.cell-output-display}\n\\begin{table}\n\\centering\n\\begin{tabular}{r|l|r|r|r}\n\\hline\nid & sex & male & week & weight\\\\\n\\hline\n1 & male & 1 & 5 & 19.05\\\\\n\\hline\n1 & male & 1 & 6 & 19.99\\\\\n\\hline\n1 & male & 1 & 7 & 20.79\\\\\n\\hline\n1 & male & 1 & 8 & 21.37\\\\\n\\hline\n1 & male & 1 & 9 & 22.08\\\\\n\\hline\n1 & male & 1 & 10 & 22.72\\\\\n\\hline\n\\end{tabular}\n\\end{table}\n:::\n:::\n\n\n\nLet's focus on only subset of data, the first 10 mice. \n\n\n::: {#tbl-mice10-sex-preview .cell tbl-cap='Sex and weigth data for a subset of 10 mice observed at week 5'}\n\n```{.r .cell-code}\n# select first 10 mice at week 5\nmice.10 <- mice %>% \n  filter(week == 5) %>%\n  filter(id %in% 1:10)\n\n# preview data\nhead(mice.10) %>%\n  kable() %>% \n  kable_styling(full_width = FALSE)\n```\n\n::: {.cell-output-display}\n\\begin{table}\n\\centering\n\\begin{tabular}{r|l|r|r|r}\n\\hline\nid & sex & male & week & weight\\\\\n\\hline\n1 & male & 1 & 5 & 19.05\\\\\n\\hline\n2 & male & 1 & 5 & 20.67\\\\\n\\hline\n3 & female & 0 & 5 & 18.18\\\\\n\\hline\n4 & male & 1 & 5 & 20.33\\\\\n\\hline\n5 & male & 1 & 5 & 21.02\\\\\n\\hline\n6 & male & 1 & 5 & 16.88\\\\\n\\hline\n\\end{tabular}\n\\end{table}\n:::\n:::\n\n\n\nClearly, information about male/female falls under categorical data type. Things we can ask here to summarize the data are: how many mice of each category we have, i.e. how many males and how many females and what are the males/females percentages (or proportions). We can also visualize these descriptive statistics in a bar chart of a pie chart. \n\n**Frequency table**\n\n\n\n::: {#tbl-mice-sex .cell tbl-cap='The number, percentages and proportions of male and female mice'}\n\n```{.r .cell-code}\n# count frequencies, percentages and proportions\ntable.summary <- mice.10 %>% \n  group_by(sex) %>%\n  tally() %>%\n  mutate(\"percent (%)\" = n/sum(n)*100) %>%\n  mutate(\"proportion\" = n/sum(n))\n  \n# show table\nkable(table.summary) %>% kable_styling(full_width = TRUE)\n```\n\n::: {.cell-output-display}\n\\begin{tabu} to \\linewidth {>{\\raggedright}X>{\\raggedleft}X>{\\raggedleft}X>{\\raggedleft}X}\n\\hline\nsex & n & percent (\\%) & proportion\\\\\n\\hline\nfemale & 3 & 30 & 0.3\\\\\n\\hline\nmale & 7 & 70 & 0.7\\\\\n\\hline\n\\end{tabu}\n:::\n:::\n\n\n\n**Bar chart & pie chart**\n\nTo visualize the frequencies (or percentages or proportions) we can use bar charts referred to as barplots in R. \n\n\n\n::: {#fig-mice10 .cell layout-ncol=\"2\"}\n\n```{.r .cell-code}\nfont.size <- 30\nmy.ggtheme <- theme(axis.title = element_text(size = font.size), \n        axis.text = element_text(size = font.size), \n        legend.text = element_text(size = font.size), \n        legend.title = element_blank()) \n\n# use ggplot to draw a bar chart\nmice.10 %>%\n  ggplot(aes(x = sex, fill = sex)) +\n  geom_bar(width = 0.5) +\n  scale_fill_brewer(palette = \"Paired\") + \n  theme_bw() +\n  my.ggtheme\n\n# draw pie chart\nmice.10 %>%\n  ggplot(aes(x=\"\", y = sex, fill = sex)) +\n  geom_bar(width = 1, stat = \"identity\") +\n  theme_bw() +\n  coord_polar(\"y\", start=0) +\n  scale_fill_brewer(palette=\"Paired\") +\n  xlab(\"\") +\n  ylab(\"\") + \n  my.ggtheme\n```\n\n::: {.cell-output-display}\n![Bar chart](data-categorical_files/figure-pdf/fig-mice10-1.pdf){#fig-mice10-1}\n:::\n\n::: {.cell-output-display}\n![Pie chart](data-categorical_files/figure-pdf/fig-mice10-2.pdf){#fig-mice10-2}\n:::\n\nGraphical summaries of number and percentage of mice for each observed sex category (male/female)\n:::\n\n\n\n\n\n::: {#exm-lefthand}\n## Left-handedness\n\nWe are interested in whether left-handedness is associated with suffering from migraine. We collect data on handedness in 30 patients suffering from migraine on regular basis and 40 healthy controls. \n:::\n\nThe preview of data: \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# in fact we just generate some random data on handedness (L/H) and migrane (Yes/No)\nset.seed(1123) # set random seed \npatients <- sample(c(\"L\", \"R\"), 30, prob=c(0.3, 0.7), replace=TRUE)\ncontrols <- sample(c(\"L\", \"R\"), 40, prob=c(0.1, 0.9), replace=TRUE)\ndata.handedness <- rbind(data.frame(group=\"patient\", handedness=patients),\n              data.frame(group=\"control\", handedness=controls)) %>%\n  rownames_to_column(\"id\")\n\n# preview data on handedness and migraine\nglimpse(data.handedness)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 70\nColumns: 3\n$ id         <chr> \"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\", \"11\", \"1~\n$ group      <chr> \"patient\", \"patient\", \"patient\", \"patient\", \"patient\", \"pat~\n$ handedness <chr> \"L\", \"L\", \"L\", \"R\", \"L\", \"R\", \"R\", \"L\", \"L\", \"R\", \"R\", \"R\",~\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# preview first few observations\nhead(data.handedness)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  id   group handedness\n1  1 patient          L\n2  2 patient          L\n3  3 patient          L\n4  4 patient          R\n5  5 patient          L\n6  6 patient          R\n```\n:::\n\n```{.r .cell-code}\n# preview last few observations\ntail(data.handedness)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   id   group handedness\n65 65 control          R\n66 66 control          R\n67 67 control          R\n68 68 control          R\n69 69 control          R\n70 70 control          R\n```\n:::\n:::\n\n\n\n**Summary table**\n\n\n\n::: {#tbl-handedness-summary .cell tbl-cap='Summary of left-handedness among patients and controls'}\n\n```{.r .cell-code}\n# count number (and %) of left-handed by group (patients / controls)\ndata.handedness %>%\n  group_by(group) %>%\n  dplyr::summarize(Total=n(), `Left-handed` = sum(handedness==\"L\")) %>% \n  mutate(`Left handed (%)` = round(`Left-handed` * 100 / Total, 2)) %>%\n  kable() %>%\n  kable_styling(full_width = TRUE)\n```\n\n::: {.cell-output-display}\n\\begin{tabu} to \\linewidth {>{\\raggedright}X>{\\raggedleft}X>{\\raggedleft}X>{\\raggedleft}X}\n\\hline\ngroup & Total & Left-handed & Left handed (\\%)\\\\\n\\hline\ncontrol & 40 & 4 & 10\\\\\n\\hline\npatient & 30 & 9 & 30\\\\\n\\hline\n\\end{tabu}\n:::\n:::\n\n\n\n**Contingency table**\n\nShows the multivariate frequency distribution of variables\n\n\n\n::: {#tbl-handedness-con .cell tbl-cap='Contigency table (or cross table) of group and handedness'}\n\n```{.r .cell-code}\n# use table() function to create contingency table\ntable.con <- table(data.handedness$group, data.handedness$handedness)\ntable.con <- addmargins(table.con)\ntable.con %>% kable() %>%\n  kable_styling(full_width = TRUE)\n```\n\n::: {.cell-output-display}\n\\begin{tabu} to \\linewidth {>{\\raggedright}X>{\\raggedleft}X>{\\raggedleft}X>{\\raggedleft}X}\n\\hline\n  & L & R & Sum\\\\\n\\hline\ncontrol & 4 & 36 & 40\\\\\n\\hline\npatient & 9 & 21 & 30\\\\\n\\hline\nSum & 13 & 57 & 70\\\\\n\\hline\n\\end{tabu}\n:::\n:::\n\n\n\n\n**Bar charts**\n\nAgain, we can visualize the frequencies using bar charts. \n\n\n\n::: {#fig-handedness-barcharts .cell layout-ncol=\"3\"}\n\n```{.r .cell-code}\ndata.handedness %>% \n  ggplot(aes(x=group, fill=handedness)) + \n  geom_bar() + \n  theme_bw() + \n  xlab(\"\") + \n  scale_fill_brewer(palette = \"Paired\") + \n  my.ggtheme\n  \n# another way of using bar charts: side by side bars\ndata.handedness %>% \n  ggplot(aes(x=group, fill=handedness)) + \n  geom_bar(position = \"dodge\") + \n  theme_bw() + \n  xlab(\"\") + \n  scale_fill_brewer(palette = \"Paired\") + \n  my.ggtheme\n\n# another way of using bar charts: showing fractions instead of counts\ndata.handedness %>% \n  ggplot(aes(x=group, fill=handedness)) + \n  geom_bar(position = \"fill\") + \n  theme_bw() + \n  xlab(\"\") + \n  ylab(\"fraction\") +\n  scale_fill_brewer(palette = \"Paired\") + \n  my.ggtheme\n```\n\n::: {.cell-output-display}\n![stacked bars](data-categorical_files/figure-pdf/fig-handedness-barcharts-1.pdf){#fig-handedness-barcharts-1}\n:::\n\n::: {.cell-output-display}\n![side-by-side bars](data-categorical_files/figure-pdf/fig-handedness-barcharts-2.pdf){#fig-handedness-barcharts-2}\n:::\n\n::: {.cell-output-display}\n![bars showing fractions instead of counts](data-categorical_files/figure-pdf/fig-handedness-barcharts-3.pdf){#fig-handedness-barcharts-3}\n:::\n\nBar charts summarizing handedness variable in control and patients\n:::\n\n\n\n**Mosaic plot**\n\nMosaic plots display contingency tables\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# recreate contingency table to remove margins stats\ntable.con <- table(data.handedness$group, data.handedness$handedness)\n\n# draw mosaic plot\nfont.scale <- 2\nmosaicplot(table.con, col = \"#a6cee3\", \n           main = \"\", \n           cex.axis = font.scale)\n```\n\n::: {.cell-output-display}\n![Mosaic plot showing contigency table](data-categorical_files/figure-pdf/fig-handedness-mosaic-1.pdf){#fig-handedness-mosaic fig-pos='H'}\n:::\n:::\n",
    "supporting": [
      "data-categorical_files/figure-pdf"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {
      "knitr": [
        "{\"type\":\"list\",\"attributes\":{\"knit_meta_id\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\"]}},\"value\":[{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"booktabs\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"longtable\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"array\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"multirow\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"wrapfig\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"float\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"colortbl\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"pdflscape\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"tabu\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"threeparttable\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"threeparttablex\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"ulem\"]},{\"type\":\"character\",\"attributes\":{},\"value\":[\"normalem\"]},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"makecell\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"xcolor\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]}]}"
      ]
    },
    "preserve": null,
    "postProcess": false
  }
}