{
  "hash": "363c17de462a77387a1277da2e16f942",
  "result": {
    "markdown": "---\noutput: html_document\neditor_options: \n  chunk_output_type: console\n---\n\n# Categorical data\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# load libraries\nlibrary(tidyverse)\nlibrary(kableExtra)\nlibrary(faraway)\nlibrary(scales)\n\n# add obesity and diabetes status to diabetes faraway data\ninch2m <- 2.54/100\npound2kg <- 0.45\ndata_diabetes <- diabetes %>%\n  mutate(height  = height * inch2m, height = round(height, 2)) %>% \n  mutate(waist = waist * inch2m) %>%  \n  mutate(weight = weight * pound2kg, weight = round(weight, 2)) %>%\n  mutate(BMI = weight / height^2, BMI = round(BMI, 2)) %>% \n  mutate(obese= cut(BMI, breaks = c(0, 29.9, 100), labels = c(\"No\", \"Yes\"))) %>% \n  mutate(diabetic = ifelse(glyhb > 7, \"Yes\", \"No\"), diabetic = factor(diabetic, levels = c(\"No\", \"Yes\"))) %>%\n  na.omit()\n```\n:::\n\n\nCategorical data can be summarized by counting the number of observations of each category and summarizing in a frequency table or graphically in a bar chart. Alternatively we can calculate the proportions or percentages of each category.\n\n\n```{mermaid}\n%%| label: fig-cat\n%%| fig-align: center\n%%| fig-cap: \"Example of numerical summaries and graphical visualization applicable to categorical data\"\n%%| fig-cap-location: margin\n%%| error: true\n\nflowchart TD\n  A(Categorical data) --> B(Numerical summary)\n  B(Numerical summary) --> D(Table of frequencies <br/> Proportions <br/> Percentages <br/> ...)\n  A(Categorical data) --> C(Graphical summary)\n  C(Graphical summary) --> E(Bar charts <br/> Pie chart <br/> Mosaic plot <br/> ...)\n  \n```\n\n\n\nGiven the diabetes data set we have some categorical data type such as `obesity` or `diabetes` status (yes/no), `gender` (male/female) and `location` (Buckingham/Louisa) to name few. Taking `obesity` status as an example, we can:\n\n- ask how many study participants we have in each category? I.e. how many suffer from obesity ($BMI \\ge 30$) and how many have $BMI < 30$?\n- visualize these descriptive statistics as counts or percentages in a bar chart or a pie chart. \n\n## Frequency table\n\nLet's focus on 130 study participants for which no missing data was observed, i.e. complete case analysis. An example frequency table summarizing study participants by their BMI status is shown below. \n\n\n::: {#tbl-obesity .cell .tbl-cap-location-margin tbl-cap='Frequency table showing the number, percentages and proportions of study participants with BMI $\\ge$ 30 and with BMI < 30'}\n\n```{.r .cell-code}\n# count frequencies, percentages and proportions\ntable.summary <- data_diabetes %>%\n  group_by(obese) %>%\n  tally() %>%\n  mutate(\"percent (%)\" = n/sum(n)*100) %>%\n  mutate(\"proportion\" = n/sum(n))\n\n# show table\nkable(table.summary, digits = 1) %>% \n  kable_styling(full_width = TRUE)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> obese </th>\n   <th style=\"text-align:right;\"> n </th>\n   <th style=\"text-align:right;\"> percent (%) </th>\n   <th style=\"text-align:right;\"> proportion </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> No </td>\n   <td style=\"text-align:right;\"> 72 </td>\n   <td style=\"text-align:right;\"> 55.4 </td>\n   <td style=\"text-align:right;\"> 0.6 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Yes </td>\n   <td style=\"text-align:right;\"> 58 </td>\n   <td style=\"text-align:right;\"> 44.6 </td>\n   <td style=\"text-align:right;\"> 0.4 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n## Bar chart & pie chart\n\nTo visualize the frequencies (or percentages or proportions) we can use bar chart or a pie chart. \n\n\n::: {#fig-barchart .cell .fig-cap-location-margin layout-ncol=\"2\"}\n\n```{.r .cell-code}\n# set a custom ggplot theme\nfont.size <- 30\nmy.ggtheme <- theme(axis.title = element_text(size = font.size), \n        axis.text = element_text(size = font.size), \n        legend.text = element_text(size = font.size), \n        legend.title = element_blank(), \n        axis.title.y = element_text(angle = 0))\n\n# use ggplot to draw a bar chart\ndata_diabetes %>%\n  ggplot(aes(x = obese, fill = obese)) +\n  geom_bar(width = 0.5) +\n  scale_fill_brewer(palette = \"Paired\") + \n  theme_bw() +\n  my.ggtheme\n\n# draw pie chart\ndata_diabetes %>%\n  ggplot(aes(x=\"\", y = obese, fill = obese)) +\n  geom_bar(width = 1, stat = \"identity\") +\n  theme_bw() +\n  coord_polar(\"y\", start=0) +\n  scale_fill_brewer(palette=\"Paired\") +\n  xlab(\"\") +\n  ylab(\"\") + \n  my.ggtheme\n```\n\n::: {.cell-output-display}\n![Bar chart](data-categorical_files/figure-html/fig-barchart-1.png){#fig-barchart-1 width=1152}\n:::\n\n::: {.cell-output-display}\n![Pie chart](data-categorical_files/figure-html/fig-barchart-2.png){#fig-barchart-2 width=1152}\n:::\n\nBar and pie chart showing graphical summaries of number and percentage of participants of study participants with BMI $\\ge$ 30 and with BMI < 30\n:::\n\n\n\n## Summary table: 2 categorical variables\n\nWhen we are interested in how one categorical variable is related to another categorical variable, we can use a summary table. For instance, we can look at the relationship between obesity (yes/no) and diabetes (yes/no). \n\n\n\n::: {#tbl-summary-diabetic .cell .tbl-cap-location-margin tbl-cap='Summary table showing relation between obesity and diabesis status among study participants'}\n\n```{.r .cell-code}\ndata_diabetes %>%\n  group_by(obese) %>%\n  dplyr::summarize(Total=n(), `Diabetic` = sum(gender==\"male\")) %>% \n  mutate(`Diabetic (%)` = round(`Diabetic` * 100 / Total, 2)) %>%\n  kable() %>%\n  kable_styling(full_width = TRUE)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> obese </th>\n   <th style=\"text-align:right;\"> Total </th>\n   <th style=\"text-align:right;\"> Diabetic </th>\n   <th style=\"text-align:right;\"> Diabetic (%) </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> No </td>\n   <td style=\"text-align:right;\"> 72 </td>\n   <td style=\"text-align:right;\"> 39 </td>\n   <td style=\"text-align:right;\"> 54.17 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Yes </td>\n   <td style=\"text-align:right;\"> 58 </td>\n   <td style=\"text-align:right;\"> 18 </td>\n   <td style=\"text-align:right;\"> 31.03 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n## Contingency table: 2 categorical variables\n\nShows the multivariate frequency distribution of variables\n\n\n::: {#tbl-con .cell .tbl-cap-location-margin tbl-cap='Contigency table (or cross table) showing multivariate frequency of obesity and diabesis status among study participants'}\n\n```{.r .cell-code}\n# use table() function to create contingency table\ntable.con <- table(data_diabetes$obese, data_diabetes$diabetic)\ntable.con <- addmargins(table.con)\nrownames(table.con) <- c(\"Non-obese\", \"Obese\", \"Sum\")\ncolnames(table.con) <- c(\"Non-diabetic\", \"Diabetic\", \"Sum\")\n\ntable.con %>%\n  kable(row.names = TRUE) %>%\n  kable_styling(full_width = TRUE) %>%\n  column_spec(4, bold = T) %>%\n  row_spec(3, bold = T)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\">   </th>\n   <th style=\"text-align:right;\"> Non-diabetic </th>\n   <th style=\"text-align:right;\"> Diabetic </th>\n   <th style=\"text-align:right;\"> Sum </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Non-obese </td>\n   <td style=\"text-align:right;\"> 57 </td>\n   <td style=\"text-align:right;\"> 15 </td>\n   <td style=\"text-align:right;font-weight: bold;\"> 72 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Obese </td>\n   <td style=\"text-align:right;\"> 43 </td>\n   <td style=\"text-align:right;\"> 15 </td>\n   <td style=\"text-align:right;font-weight: bold;\"> 58 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;font-weight: bold;\"> Sum </td>\n   <td style=\"text-align:right;font-weight: bold;\"> 100 </td>\n   <td style=\"text-align:right;font-weight: bold;\"> 30 </td>\n   <td style=\"text-align:right;font-weight: bold;font-weight: bold;\"> 130 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n## Bar chart: 2 categorical variables\n\nBar charts can be used to visualize two and more categorical variables, e.g. by using stacking, side-by-side bars or colors. \n\n\n::: {#fig-barchart2 .cell .fig-cap-location-margin layout-ncol=\"3\"}\n\n```{.r .cell-code}\ndata_diabetes %>% \n  ggplot(aes(x=obese, fill=diabetic)) + \n  geom_bar() + \n  theme_bw() + \n  xlab(\"obese\") + \n  ylab(\"count (diabetic)\") +\n  scale_fill_brewer(palette = \"Paired\") + \n  my.ggtheme\n  \n# another way of using bar charts: side by side bars\ndata_diabetes %>% \n  ggplot(aes(x=obese, fill=diabetic)) + \n  geom_bar(position = \"dodge\") + \n  theme_bw() + \n  xlab(\"obese\") + \n  ylab(\"count (diabetic)\") +\n  scale_fill_brewer(palette = \"Paired\") + \n  my.ggtheme\n\n# another way of using bar charts: showing fractions instead of counts\ndata_diabetes %>% \n  ggplot(aes(x=obese, fill=diabetic)) + \n  geom_bar(position = \"fill\") + \n  theme_bw() + \n  xlab(\"obese\") + \n  ylab(\"fraction (diabetic)\") +\n  scale_fill_brewer(palette = \"Paired\") + \n  my.ggtheme\n```\n\n::: {.cell-output-display}\n![stacked bars](data-categorical_files/figure-html/fig-barchart2-1.png){#fig-barchart2-1 width=1152}\n:::\n\n::: {.cell-output-display}\n![side-by-side bars](data-categorical_files/figure-html/fig-barchart2-2.png){#fig-barchart2-2 width=1152}\n:::\n\n::: {.cell-output-display}\n![bars showing fractions instead of counts](data-categorical_files/figure-html/fig-barchart2-3.png){#fig-barchart2-3 width=1152}\n:::\n\nBar chart showing summary of diabetic status among study participants with BMI $\\ge$ 30 and with BMI < 30\n:::\n\n::: {#fig-barchart3 .cell .fig-cap-location-margin layout-ncol=\"2\"}\n\n```{.r .cell-code}\n# calculate number of diabetic participants \n# by among participants with BMI >=30 and stratified by gender\ndata_plot <- data_diabetes %>%\n  select(gender, obese, diabetic) %>%\n  group_by(obese, diabetic, gender) %>%\n  tally() %>%\n  filter(diabetic == \"Yes\") #%>%\n  #print()\n\n# bar plot (stacked)\ndata_plot %>% \n  ggplot(aes(x=obese, y=n, fill = gender)) + \n  geom_bar(stat = \"identity\") + \n  theme_bw() + \n  xlab(\"obese\") +\n  ylab(\"count (diabetic)\") + \n  scale_fill_brewer(palette = \"Set2\") + \n  my.ggtheme\n\n# bar plot (side-by-side)\ndata_plot %>% \n  ggplot(aes(x=obese, y=n, fill = gender)) + \n  geom_bar(stat = \"identity\", position = \"dodge\") + \n  theme_bw() + \n  xlab(\"obese\") +\n  ylab(\"count (diabetic)\") + \n  scale_fill_brewer(palette = \"Set2\") + \n  scale_y_continuous(breaks = pretty_breaks()) + \n  my.ggtheme\n```\n\n::: {.cell-output-display}\n![stacked bars](data-categorical_files/figure-html/fig-barchart3-1.png){#fig-barchart3-1 width=1152}\n:::\n\n::: {.cell-output-display}\n![side-by-side bars](data-categorical_files/figure-html/fig-barchart3-2.png){#fig-barchart3-2 width=1152}\n:::\n\nBar chart showing number of diabetic study participants among participants with BMI $\\ge$ 30 and with BMI < 30, stratified by gender\n:::\n\n\n\n## Mosaic plot\n\nMosaic plots display contingency tables\n\n\n\n\n::: {.cell .fig-cap-location-margin}\n\n```{.r .cell-code}\nlibrary(ggmosaic)\n ggplot(data = data_diabetes) +\n  geom_mosaic(aes(x = product(obese), fill=diabetic)) + \n  theme_bw() + \n  scale_fill_brewer(palette = \"Paired\")\n```\n\n::: {.cell-output-display}\n![Mosaic plot showing contigency table of obesity and diabetic status among study participants](data-categorical_files/figure-html/fig-mosaic-cat2-1.png){#fig-mosaic-cat2 width=672}\n:::\n:::\n\n::: {.cell .fig-cap-location-margin}\n\n```{.r .cell-code}\n ggplot(data = data_diabetes) +\n  geom_mosaic(aes(x = product(obese, gender), fill=diabetic)) + \n  theme_bw() + \n   scale_fill_brewer(palette = \"Set2\") \n```\n\n::: {.cell-output-display}\n![Mosaic plot showing contigency table of obesity and diabetic status among study participants stratified by gender](data-categorical_files/figure-html/fig-mosaic-cat3-1.png){#fig-mosaic-cat3 width=672}\n:::\n:::\n",
    "supporting": [
      "data-categorical_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}