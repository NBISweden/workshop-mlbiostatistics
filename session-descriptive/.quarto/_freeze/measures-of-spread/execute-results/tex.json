{
  "hash": "9d9cbebfc5675c179fff9297738adb0d",
  "result": {
    "markdown": "---\noutput: html_document\neditor_options: \n  chunk_output_type: console\n---\n\n\n# Measures of spread\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# load libraries\nlibrary(tidyverse)\nlibrary(magrittr)\nlibrary(kableExtra)\nlibrary(ggplot2)\nlibrary(gridExtra)\n```\n:::\n\n\n\n\n## Quartiles \n\nQuartiles are the three values that divide the data values into four equally sized groups.\n\n  - Q1. First quartile. 25% of values are below Q1. Divides the values below the median into equally sized groups.\n  - Q2. Second quartile. 50% of values are below Q2 and 50% are above Q2. Q2 is the median that we have seen before.\n  - Q3. Third quartile. 75% of values are below Q3. Divides the values above the median into equally sized groups.\n\n\n::: {#exm-mice-quartiles}\n\n## Lab mice (cont.)\n\nGoing back to the lab mice example. What are the three quartiles of mice weight at week 5? \n\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# read in mice data\ndata.mice <- read_csv(\"data/mice.csv\")\ndata.mice <- data.mice %>%\n  mutate(weight = round(weight,2))\n\n# narrow data set to week 5 measurements\ndata.mice.week5 <- data.mice %>%\n  filter(week == 5)\n\n# calculate quartiles\ndata.mice.week5 %>%\n  summarise(x = quantile(weight, c(0.25, 0.5, 0.75))) %>%\n  print()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 3 x 1\n      x\n  <dbl>\n1  17.8\n2  19.3\n3  20.6\n```\n:::\n:::\n\n\n\nWe can check if the values agree with the box plot. \n\n\n::: {.cell .fig-cap-location-margin}\n\n```{.r .cell-code}\n# define generic ggplot theme\nfont.size <- 12\nmy.ggtheme <- theme(axis.title = element_text(size = font.size), \n        axis.text = element_text(size = font.size), \n        legend.text = element_text(size = font.size), \n        legend.title = element_blank(), \n        legend.position = \"top\") \n\ndata.mice.week5 %>%\n  ggplot(aes(x = \"\", y = weight)) + \n  geom_boxplot() + \n  xlab(\"\") + \n  ylab(\"weight (g)\") + \n  theme_bw() + \n  my.ggtheme\n```\n\n::: {.cell-output-display}\n![Bar plot of mice weights at week 5](measures-of-spread_files/figure-pdf/fig-mice-boxplot-1.pdf){#fig-mice-boxplot fig-pos='H'}\n:::\n:::\n\n\n\n\n## Variance and standard deviation\n\nThe **variance** of a set of observations is their mean squared distance from the mean value:\n\n\n\n$$\\sigma^2 = \\frac{1}{n} \\sum_{i=1}^n (x_i - \\bar x)^2.$$\n\n\nThe variance is measured in the square of the unit in which $x$ was measured. Another common measure using the same unit as $x$ is **standard deviation**, defined as the square root of the variance:\n\n\n\n$$\\sigma = \\sqrt{\\frac{1}{n} \\sum_{i=1}^n (x_i - \\bar x)^2}$$\n\n\n\n\nTypically, we regard the collection of observations $x_1, \\dots, x_n$ as a **sample** drawn from a large **population** of possible observations. It has been shown theoretically that we obtain a better sample estimate of the **population standard deviation** if we divide by $(n-1)$. So the denominator $n$ is commonly replaced by $n-1$ and the **sample standard deviation** is calculated instead:\n\n\n\n$$s = \\sqrt{\\frac{1}{n-1} \\sum_{i=1}^n (x_i - \\bar x)^2}.$$\n\n\n\nTo reiterate: \n\n- we calculate standard deviation, $\\sigma$, when we consider our observations to be entire population\n- we calculate sample standard deviation, $s$, when we consider our observations a random sample from a larger population, as a better estimate of the standard deviation of the larger population\n\n::: {#exm-mice-sd}\n\n## Lab mice (cont.)\n\nLet's calculate variance, standard deviation and sample standard deviation for mice weight at week 5. \n\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# get weights at week 5\nweight.week5 <- data.mice.week5 %>%\n  pull(weight)\n\n# number of observations\nn <- length(weight.week5)\n  \n# calculate mean (arthimetic)\nweight.mean <- mean(weight.week5)\n\n# calculate variance following variance equation\nsigma2 <- (sum((weight.week5 - weight.mean)^2))/(n)\n\n# calculate standard deviation following standard deviation equation\nsigma <- sqrt((sum((weight.week5 - weight.mean)^2))/(n))\n\n# calculate sample standard deviation following sample standard deviation equation\ns <- sqrt((sum((weight.week5 - weight.mean)^2))/(n-1))\n# sd(weight.week5) # we can alternatively use sd() function\n\n# collect results\nv.name <- c(\"sigma2\", \"sigma\", \"s\")\nv.values <- c(sigma2, sigma, s)\nresults <- data.frame(stats = v.name, value = v.values)\nprint(results)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   stats    value\n1 sigma2 3.817581\n2  sigma 1.953863\n3      s 1.963706\n```\n:::\n:::\n",
    "supporting": [
      "measures-of-spread_files/figure-pdf"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {
      "knitr": [
        "{\"type\":\"list\",\"attributes\":{\"knit_meta_id\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\"]}},\"value\":[{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"booktabs\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"longtable\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"array\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"multirow\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"wrapfig\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"float\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"colortbl\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"pdflscape\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"tabu\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"threeparttable\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"threeparttablex\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"ulem\"]},{\"type\":\"character\",\"attributes\":{},\"value\":[\"normalem\"]},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"makecell\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]},{\"type\":\"list\",\"attributes\":{\"names\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"name\",\"options\",\"extra_lines\"]},\"class\":{\"type\":\"character\",\"attributes\":{},\"value\":[\"latex_dependency\"]}},\"value\":[{\"type\":\"character\",\"attributes\":{},\"value\":[\"xcolor\"]},{\"type\":\"NULL\"},{\"type\":\"NULL\"}]}]}"
      ]
    },
    "preserve": null,
    "postProcess": false
  }
}