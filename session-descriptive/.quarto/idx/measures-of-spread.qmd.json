{"title":"Measures of spread","markdown":{"yaml":{"output":"html_document","editor_options":{"chunk_output_type":"console"}},"headingText":"Measures of spread","containsRefs":false,"markdown":"\n```{r, include=T, message=FALSE, warning=FALSE}\n# load libraries\nlibrary(tidyverse)\nlibrary(magrittr)\nlibrary(kableExtra)\nlibrary(ggplot2)\nlibrary(gridExtra)\n```\n\n\n## Quartiles \n\nQuartiles are the three values that divide the data values into four equally sized groups.\n\n  - Q1. First quartile. 25% of values are below Q1. Divides the values below the median into equally sized groups.\n  - Q2. Second quartile. 50% of values are below Q2 and 50% are above Q2. Q2 is the median that we have seen before.\n  - Q3. Third quartile. 75% of values are below Q3. Divides the values above the median into equally sized groups.\n\n\n::: {#exm-mice-quartiles}\n\n## Lab mice (cont.)\n\nGoing back to the lab mice example. What are the three quartiles of mice weight at week 5? \n\n:::\n\n```{r, warning=F, message=F}\n# read in mice data\ndata.mice <- read_csv(\"data/mice.csv\")\ndata.mice <- data.mice %>%\n  mutate(weight = round(weight,2))\n\n# narrow data set to week 5 measurements\ndata.mice.week5 <- data.mice %>%\n  filter(week == 5)\n\n# calculate quartiles\ndata.mice.week5 %>%\n  summarise(x = quantile(weight, c(0.25, 0.5, 0.75))) %>%\n  print()\n\n```\n\nWe can check if the values agree with the box plot. \n```{r}\n#| fig-cap: Bar plot of mice weights at week 5\n#| label: fig-mice-boxplot\n#| fig-cap-location: margin\n#| fig-width: 4\n#| fig-height: 4\n\n# define generic ggplot theme\nfont.size <- 12\nmy.ggtheme <- theme(axis.title = element_text(size = font.size), \n        axis.text = element_text(size = font.size), \n        legend.text = element_text(size = font.size), \n        legend.title = element_blank(), \n        legend.position = \"top\") \n\ndata.mice.week5 %>%\n  ggplot(aes(x = \"\", y = weight)) + \n  geom_boxplot() + \n  xlab(\"\") + \n  ylab(\"weight (g)\") + \n  theme_bw() + \n  my.ggtheme\n\n```\n\n\n## Variance and standard deviation\n\nThe **variance** of a set of observations is their mean squared distance from the mean value:\n\n$$\\sigma^2 = \\frac{1}{n} \\sum_{i=1}^n (x_i - \\bar x)^2.$$\nThe variance is measured in the square of the unit in which $x$ was measured. Another common measure using the same unit as $x$ is **standard deviation**, defined as the square root of the variance:\n\n$$\\sigma = \\sqrt{\\frac{1}{n} \\sum_{i=1}^n (x_i - \\bar x)^2}$$\n\n\nTypically, we regard the collection of observations $x_1, \\dots, x_n$ as a **sample** drawn from a large **population** of possible observations. It has been shown theoretically that we obtain a better sample estimate of the **population standard deviation** if we divide by $(n-1)$. So the denominator $n$ is commonly replaced by $n-1$ and the **sample standard deviation** is calculated instead:\n\n$$s = \\sqrt{\\frac{1}{n-1} \\sum_{i=1}^n (x_i - \\bar x)^2}.$$\n\nTo reiterate: \n\n- we calculate standard deviation, $\\sigma$, when we consider our observations to be entire population\n- we calculate sample standard deviation, $s$, when we consider our observations a random sample from a larger population, as a better estimate of the standard deviation of the larger population\n\n::: {#exm-mice-sd}\n\n## Lab mice (cont.)\n\nLet's calculate variance, standard deviation and sample standard deviation for mice weight at week 5. \n\n:::\n\n```{r}\n\n# get weights at week 5\nweight.week5 <- data.mice.week5 %>%\n  pull(weight)\n\n# number of observations\nn <- length(weight.week5)\n  \n# calculate mean (arthimetic)\nweight.mean <- mean(weight.week5)\n\n# calculate variance following variance equation\nsigma2 <- (sum((weight.week5 - weight.mean)^2))/(n)\n\n# calculate standard deviation following standard deviation equation\nsigma <- sqrt((sum((weight.week5 - weight.mean)^2))/(n))\n\n# calculate sample standard deviation following sample standard deviation equation\ns <- sqrt((sum((weight.week5 - weight.mean)^2))/(n-1))\n# sd(weight.week5) # we can alternatively use sd() function\n\n# collect results\nv.name <- c(\"sigma2\", \"sigma\", \"s\")\nv.values <- c(sigma2, sigma, s)\nresults <- data.frame(stats = v.name, value = v.values)\nprint(results)\n\n```\n\n\n\n\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":"html_document","warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-yaml":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":true,"code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","self-contained":false,"output-file":"measures-of-spread.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.0.36","theme":"cosmo","editor_options":{"chunk_output_type":"console"}},"extensions":{"book":{"multiFile":true}}},"pdf":{"execute":{"fig-width":5.5,"fig-height":3.5,"fig-format":"pdf","fig-dpi":300,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":"html_document","warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-yaml":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"pdf","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"pdf-engine":"xelatex","standalone":true,"variables":{"graphics":true,"tables":true},"default-image-extension":"pdf","to":"pdf","output-file":"measures-of-spread.pdf"},"language":{},"metadata":{"block-headings":true,"documentclass":"scrreprt","editor_options":{"chunk_output_type":"console"}},"extensions":{"book":{}}}}}