{"title":"Categorical data","markdown":{"headingText":"Categorical data","containsRefs":false,"markdown":"\n```{r, message=FALSE, warning=F}\n# load libraries\nlibrary(tidyverse)\nlibrary(kableExtra)\nlibrary(ggplot2)\n```\n\nCategorical data can be summarized by counting the number of observations of each category and summarizing in a frequency table or graphically in a bar chart. Alternatively we can calculate the the proportions (or percentages) of each category.\n\n```{mermaid}\nflowchart TD\n  A(Categorical data) --> B(Numerical summary)\n  B(Numerical summary) --> D(Table of frequencies <br/> Proportions <br/> Percentages <br/> ...)\n  A(Categorical data) --> C(Graphical summary)\n  C(Graphical summary) --> E(Bar charts <br/> Pie chart <br/> Mosaic plot <br/> ...)\n```\n\n<!-- Example: 10 mice -->\n```{r data-cat-simulate-mice-data, include=F}\n# Generate mice data\nset.seed(101) # set random seed\nn <- 100 # number of observations to generate\nweek <- 5:24 # number of weeks to generate\nm <- length(week)\n\nmice0 <- data.frame(id=1:n, sex=sample(c('male', 'female'), n, replace = TRUE)) %>%\n  mutate(male=1*(sex==\"male\"), b0=rnorm(n, 15.5, 1), b1=rnorm(n, 0.5, 0.1), b2=rnorm(n, 1.5,0.5), b3=rnorm(n, 0.3, 0.1), a0 = rnorm(n, 44, 4))\n\nmice <- mice0 %>% slice(rep(1:n(), each=m)) %>% mutate(week=rep(week, n))\nmice <- mice %>% mutate(s=rnorm(n*m, 0, 0.2)) %>% mutate(weight=b0+b1*week+b2*male+b3*male*week+s) \n\nmice <- mice %>% select(id, sex, male, week, weight)\nwrite_csv(mice, file=\"data/mice.csv\")\n\n```\n\n::: {#exm-mice-10}\n## Lab mice: sex\n\nImagine, we run an experiment, in which follow 100 mice over a period of 24 weeks. To begin with, we record mice sex (male/female). In addition, every week we record the weight (g) of each mouse, starting at week 5. How can we summarize the sex (male/female) variable? \n\n::: \n\nThe data can be loaded from [mice.csv](data/mice.csv) and a preview is shown below.\n```{r, message=FALSE}\n#| label: tbl-mice-sex-preview\n#| tbl-cap: Preview of the mice data\n\n# read in data\nmice <- read_csv(\"data/mice.csv\")\nmice <- mice %>%\n  mutate(weight = round(weight,2))\n\n# # preview data\n# mice %>%\n#   datatable() %>%\n#   formatSignif(columns = c(\"weight\"), digits = 4)\n\n# preview data\nhead(mice) %>%\n  kable() %>% \n  kable_styling(full_width = FALSE)\n```\n\nLet's focus on only subset of data, the first 10 mice. \n```{r}\n#| label: tbl-mice10-sex-preview\n#| tbl-cap: Sex and weigth data for a subset of 10 mice observed at week 5\n\n# select first 10 mice at week 5\nmice.10 <- mice %>% \n  filter(week == 5) %>%\n  filter(id %in% 1:10)\n\n# preview data\nhead(mice.10) %>%\n  kable() %>% \n  kable_styling(full_width = FALSE)\n```\n\nClearly, information about male/female falls under categorical data type. Things we can ask here to summarize the data are: how many mice of each category we have, i.e. how many males and how many females and what are the males/females percentages (or proportions). We can also visualize these descriptive statistics in a bar chart of a pie chart. \n\n**Frequency table**\n\n```{r}\n#| label: tbl-mice-sex\n#| tbl-cap: The number, percentages and proportions of male and female mice\n\n# count frequencies, percentages and proportions\ntable.summary <- mice.10 %>% \n  group_by(sex) %>%\n  tally() %>%\n  mutate(\"percent (%)\" = n/sum(n)*100) %>%\n  mutate(\"proportion\" = n/sum(n))\n  \n# show table\nkable(table.summary) %>% kable_styling(full_width = TRUE)\n  \n```\n\n**Bar chart & pie chart**\n\nTo visualize the frequencies (or percentages or proportions) we can use bar charts referred to as barplots in R. \n\n```{r}\n#| label: fig-mice10\n#| fig-keep: all\n#| fig-height: 10\n#| fig-width: 12\n#| fig-cap: Graphical summaries of number and percentage of mice for each observed sex category (male/female)\n#| fig-subcap:\n#|   - \"Bar chart\"\n#|   - \"Pie chart\"\n#| layout-ncol: 2\n\nfont.size <- 30\nmy.ggtheme <- theme(axis.title = element_text(size = font.size), \n        axis.text = element_text(size = font.size), \n        legend.text = element_text(size = font.size), \n        legend.title = element_blank()) \n\n# use ggplot to draw a bar chart\nmice.10 %>%\n  ggplot(aes(x = sex, fill = sex)) +\n  geom_bar(width = 0.5) +\n  scale_fill_brewer(palette = \"Paired\") + \n  theme_bw() +\n  my.ggtheme\n\n# draw pie chart\nmice.10 %>%\n  ggplot(aes(x=\"\", y = sex, fill = sex)) +\n  geom_bar(width = 1, stat = \"identity\") +\n  theme_bw() +\n  coord_polar(\"y\", start=0) +\n  scale_fill_brewer(palette=\"Paired\") +\n  xlab(\"\") +\n  ylab(\"\") + \n  my.ggtheme\n\n```\n\n\n\n::: {#exm-lefthand}\n## Left-handedness\n\nWe are interested in whether left-handedness is associated with suffering from migraine. We collect data on handedness in 30 patients suffering from migraine on regular basis and 40 healthy controls. \n:::\n\nThe preview of data: \n```{r}\n# in fact we just generate some random data on handedness (L/H) and migrane (Yes/No)\nset.seed(1123) # set random seed \npatients <- sample(c(\"L\", \"R\"), 30, prob=c(0.3, 0.7), replace=TRUE)\ncontrols <- sample(c(\"L\", \"R\"), 40, prob=c(0.1, 0.9), replace=TRUE)\ndata.handedness <- rbind(data.frame(group=\"patient\", handedness=patients),\n              data.frame(group=\"control\", handedness=controls)) %>%\n  rownames_to_column(\"id\")\n\n# preview data on handedness and migraine\nglimpse(data.handedness)\n```\n\n\n```{r}\n# preview first few observations\nhead(data.handedness)\n\n# preview last few observations\ntail(data.handedness)\n```\n\n**Summary table**\n\n```{r}\n#| label: tbl-handedness-summary\n#| tbl-cap: Summary of left-handedness among patients and controls\n\n\n# count number (and %) of left-handed by group (patients / controls)\ndata.handedness %>%\n  group_by(group) %>%\n  dplyr::summarize(Total=n(), `Left-handed` = sum(handedness==\"L\")) %>% \n  mutate(`Left handed (%)` = round(`Left-handed` * 100 / Total, 2)) %>%\n  kable() %>%\n  kable_styling(full_width = TRUE)\n  \n```\n\n**Contingency table**\n\nShows the multivariate frequency distribution of variables\n\n```{r}\n#| label: tbl-handedness-con\n#| tbl-cap: Contigency table (or cross table) of group and handedness \n\n# use table() function to create contingency table\ntable.con <- table(data.handedness$group, data.handedness$handedness)\ntable.con <- addmargins(table.con)\ntable.con %>% kable() %>%\n  kable_styling(full_width = TRUE)\n\n```\n\n\n**Bar charts**\n\nAgain, we can visualize the frequencies using bar charts. \n\n```{r}\n#| label: fig-handedness-barcharts\n#| fig-cap: Bar charts summarizing handedness variable in control and patients\n#| fig-width: 12\n#| fig-height: 16\n#| fig-subcap:\n#| - \"stacked bars\"\n#| - \"side-by-side bars\"\n#| - \"bars showing fractions instead of counts\"\n#| layout-ncol: 3\n\ndata.handedness %>% \n  ggplot(aes(x=group, fill=handedness)) + \n  geom_bar() + \n  theme_bw() + \n  xlab(\"\") + \n  scale_fill_brewer(palette = \"Paired\") + \n  my.ggtheme\n  \n# another way of using bar charts: side by side bars\ndata.handedness %>% \n  ggplot(aes(x=group, fill=handedness)) + \n  geom_bar(position = \"dodge\") + \n  theme_bw() + \n  xlab(\"\") + \n  scale_fill_brewer(palette = \"Paired\") + \n  my.ggtheme\n\n# another way of using bar charts: showing fractions instead of counts\ndata.handedness %>% \n  ggplot(aes(x=group, fill=handedness)) + \n  geom_bar(position = \"fill\") + \n  theme_bw() + \n  xlab(\"\") + \n  ylab(\"fraction\") +\n  scale_fill_brewer(palette = \"Paired\") + \n  my.ggtheme\n\n```\n\n**Mosaic plot**\n\nMosaic plots display contingency tables\n\n```{r}\n#| label: fig-handedness-mosaic\n#| fig-cap: Mosaic plot showing contigency table\n\n# recreate contingency table to remove margins stats\ntable.con <- table(data.handedness$group, data.handedness$handedness)\n\n# draw mosaic plot\nfont.scale <- 2\nmosaicplot(table.con, col = \"#a6cee3\", \n           main = \"\", \n           cex.axis = font.scale)\n\n```\n\n\n\n\n\n\n\n\n\n\n\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-yaml":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":true,"code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","self-contained":false,"output-file":"data-categorical.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.0.36","theme":"cosmo"},"extensions":{"book":{"multiFile":true}}},"pdf":{"execute":{"fig-width":5.5,"fig-height":3.5,"fig-format":"pdf","fig-dpi":300,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-yaml":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"pdf","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"pdf-engine":"xelatex","standalone":true,"variables":{"graphics":true,"tables":true},"default-image-extension":"pdf","to":"pdf","output-file":"data-categorical.pdf"},"language":{},"metadata":{"block-headings":true,"documentclass":"scrreprt"},"extensions":{"book":{}}}}}