{"title":"Measures of location","markdown":{"yaml":{"output":"html_document","editor_options":{"chunk_output_type":"console"}},"headingText":"Measures of location","containsRefs":false,"markdown":"\n\n```{r, include=T, message=FALSE, warning=FALSE}\n# load libraries\nlibrary(tidyverse)\nlibrary(magrittr)\nlibrary(kableExtra)\nlibrary(ggplot2)\nlibrary(ggbeeswarm)\nlibrary(gridExtra)\nlibrary(reshape2)\n```\n\nIt is not always easy to get a \"feeling\" for a set of numerical measurements unless we summarize the data in a meaningful way. Diagrams, as shown in the previous chapter, are often a good starting point. We can further condense the information by reporting what constitutes a representative value. If we also know how widely scattered the observations are around it, we can formulate an image of data. The **average** is a general term for a measure of **location** and some common ways of calculating the average are mode, mean and median. \n\n## Mode\nMode values is the value that most common occurs across the measurements. It can be found for numerical and categorical data types. \n\n## Median \nMedian value divides the ordered data values into two equally sized groups, so 50% of the values are below and 50% are above the median value. \n\n## Arthimetic mean & weighted mean\n**The arithmetic mean**, also commonly referred to as to mean, is calculated by adding up all the values and diving this by the number of values in the data set.\n\nMathematically, for $n$ observations $x_1, x_2, \\dots, x_n$, the arithmetic mean value is calculated as:\n$$\\bar x = \\frac{x_1+x_2+\\dots+x_n}{n} = \\frac{1}{n}\\displaystyle\\sum_{i=1}^n x_i$$\n\nAs all the values equally contribute to the calculations, the arithmetic mean value is easily affected by outliers and is distorted by skewed distributions. Sometimes, the **weighted mean** may be more useful, as it allows weights to certain values of the variable of interest. We attach a weight, $w_i$ to each of the observed values, $x_i$, in our sample, to reflect this importance and define the weighted mean as: $$\\bar{x} = \\frac{w_1x_1 + w_2x_2 + \\ldots + w_nx_n}{w_1 + w_2 + \\ldots + w_n} = \\frac{\\displaystyle\\sum_{i=1}^{n}w_ix_i}{\\displaystyle\\sum_{i=1}^{n}w_i}$$\n\n\n::: {#exm-mice-location}\n\n## Lab mice (cont.)\n\nLet's revisit our lab mice example and focus on data from week 5. What's the mode value of sex variable? And what is the average weight of mice? \n:::\n\n```{r, warning=F, message=F}\n# read in mice data\ndata.mice <- read_csv(\"data/mice.csv\")\ndata.mice <- data.mice %>%\n  mutate(weight = round(weight,2))\n\n# narrow data set to week 5 measurements\ndata.mice.week5 <- data.mice %>%\n  filter(week == 5)\n\n```\n\n**Mode value**\n\nWe can find mode value by counting how many times we observe males and females among our mice. The mode value is the most commonly occurring one, here \"females\". We have see from counting the values, that we have 53 female and 47 male mice. \n```{r}\n# fine mode value\ndata.mice.week5 %>%\n  group_by(sex) %>%\n  tally() %>%\n  arrange(desc(n)) %>%\n  print()\n```\n\n**Arithmetic mean and weighted mean**\n\nTo calculate the arithmetic mean we can use basic mean() function in R. \n```{r}\n# calculate arithmetic mean\ndata.mice.week5 %$%\n  mean(weight) %>%\n  print()\n```\n\nThe above arithmetic mean value may be however not best to reflect an average mice weight since we do not have equal numbers of males and females in the study. Here we know,or rather assume for the purpose of this example, that it is equally likely to find male and females in mice population and hence, in our experiment, males are underrepresented. \n\nWe can calculate weighted mean to account for group sizes. We assign weights so that they sum up to 100. The males and females group should have equal influence, so 50/50. As we have 53 females, the female weight is $w_f = 50 / 53 = 0.9433962$ and male weight is $w_m = 50 / 47 = 1.06383$. The weighted mean can now be calculated following the above equation and below code and is equal to:\n\n```{r}\n\n# number of females\nn.females <- data.mice.week5 %>%\n  filter(sex == \"female\") %>%\n  nrow() \n\n# number of males\nn.males <- data.mice.week5 %>%\n  filter(sex == \"male\") %>%\n  nrow() \n\n# add weights to observations\ndata.mice.week5.addweight <- data.mice.week5 %>%\n  mutate(w = ifelse(sex == \"male\", 50/n.males, 50/n.females)) %>% # assign weights\n  mutate(wx = weight * w) %$% # multiply weight by their weights values\n  mean(wx) %>% # average the weighted measurements\n  print()\n    \n```\n\n\n:::{.callout-warning}\nNote that several very different distributions can still have the same mean value. \n:::\n\n```{r mean35, warning=FALSE, message=FALSE, include=T, echo=F}\n#| fig-cap: Examples of various distributions having the same mean value of 3.5\n#| label: fig-mean-distr\n#| fig-width: 12\n#| fig-height: 10\n#| fig-cap-location: margin\n\ndf <- data.frame(x=rnorm(200, 3.5, 2))\ndf$x <- df$x - mean(df$x) + 3.5\ny <- exp(rnorm(200, 0, 1))\ny <- y+3.5 - mean(y)\ndf$y=y\n\ndf$z <- rep(c(0,10), c(200*.65, 200*.35))\n\ndf$a <- rnorm(200, 3.5, 8)\ndf$a <- df$a - mean(df$a) + 3.5\nb <- exp(rnorm(200, 2, 1))\ndf$b <- b+3.5 - mean(b)\nc <- c(rnorm(150, 10, 3), rnorm(50,0,1))\nc <- c + 3.5 - mean(c)\ndf$c <- c\n\ndata.plot <- df\ncolnames(data.plot) <- c(\"Distr1\", \"Distr2\", \"Distr3\", \"Distr4\", \"Distr5\", \"Distr6\")\ndata.plot %>%\n  rownames_to_column(\"x\") %>%\n  pivot_longer(-x, names_to = \"Distr\") %>%\n  ggplot(aes(x = value)) + \n  geom_histogram(color=\"white\", bins=30) + \n  facet_wrap(~Distr, scale = \"free\") + \n  theme_bw() +\n  xlab(\"\")\n  \n``` \n\n\n\n\n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":"html_document","warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-yaml":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":true,"code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","self-contained":false,"output-file":"measures-of-location.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.0.36","theme":"cosmo","editor_options":{"chunk_output_type":"console"}},"extensions":{"book":{"multiFile":true}}},"pdf":{"execute":{"fig-width":5.5,"fig-height":3.5,"fig-format":"pdf","fig-dpi":300,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":"html_document","warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"knitr"},"render":{"keep-tex":false,"keep-yaml":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"pdf","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"pdf-engine":"xelatex","standalone":true,"variables":{"graphics":true,"tables":true},"default-image-extension":"pdf","to":"pdf","output-file":"measures-of-location.pdf"},"language":{},"metadata":{"block-headings":true,"documentclass":"scrreprt","editor_options":{"chunk_output_type":"console"}},"extensions":{"book":{}}}}}