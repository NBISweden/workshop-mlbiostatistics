<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Statistical Inference - 3&nbsp; Parametric tests</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./infe_04multiple.html" rel="next">
<link href="./infe_exr1_hyporesampling_solutions.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Parametric tests</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Statistical Inference</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infe_01hypothesis.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to hypothesis tests</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infe_02hypresamp.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Hypothesis testing using resampling</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infe_exr1_hyporesampling_solutions.html" class="sidebar-item-text sidebar-link">Exercises: Hypothesis tests, resampling</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infe_03hypparm.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Parametric tests</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infe_04multiple.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Multiple testing</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infe_exr2_hypoparam_solutions.html" class="sidebar-item-text sidebar-link">Exercises: Hypothesis tests, parametric</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infe_05interval.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Point and interval estimates</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infe_exr3_interval_solutions.html" class="sidebar-item-text sidebar-link">Exercises: Point and interval estimates</a>
  </div>
</li>
    </ul>
    </div>
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#one-sample-mean" id="toc-one-sample-mean" class="nav-link active" data-scroll-target="#one-sample-mean"><span class="toc-section-number">3.1</span>  One sample, mean</a></li>
  <li><a href="#two-samples-mean" id="toc-two-samples-mean" class="nav-link" data-scroll-target="#two-samples-mean"><span class="toc-section-number">3.2</span>  Two samples, mean</a></li>
  <li><a href="#one-sample-proportions" id="toc-one-sample-proportions" class="nav-link" data-scroll-target="#one-sample-proportions"><span class="toc-section-number">3.3</span>  One sample, proportions</a></li>
  <li><a href="#two-samples-proportions" id="toc-two-samples-proportions" class="nav-link" data-scroll-target="#two-samples-proportions"><span class="toc-section-number">3.4</span>  Two samples, proportions</a></li>
  <li><a href="#variance" id="toc-variance" class="nav-link" data-scroll-target="#variance"><span class="toc-section-number">3.5</span>  Variance</a></li>
  </ul>
</nav>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Parametric tests</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>In the previous chapter we computed the sampling distribution using resampling techniques to be able to perform hypothesis tests. If the null distribution was already known, or could be computed based on a few assumptions, resampling would not be necessary.</p>
<p>We can follow the same steps as before to perform a hypothesis test:</p>
<ol type="1">
<li>Define <span class="math inline">\(H_0\)</span> and <span class="math inline">\(H_1\)</span></li>
<li>Select an appropriate significance level, <span class="math inline">\(\alpha\)</span></li>
<li>Select appropriate test statistic, <span class="math inline">\(T\)</span>, and compute the observed value, <span class="math inline">\(t_{obs}\)</span></li>
<li>Assume that the <span class="math inline">\(H_0\)</span> and derive the null distribution of the test statistic based on appropriate assumptions.</li>
<li>Compare the observed value, <span class="math inline">\(t_{obs}\)</span>, with the null distribution and compute a p-value. The p-value is the probability of observing a value at least as extreme as the observed value, if <span class="math inline">\(H_0\)</span> is true.</li>
<li>Based on the p-value either accept or reject <span class="math inline">\(H_0\)</span>.</li>
</ol>
<p>In this section we will present a few common situation in which the null distribution can be described parametrically.</p>
<section id="one-sample-mean" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="one-sample-mean"><span class="header-section-number">3.1</span> One sample, mean</h2>
<p>A one sample test of means compares the mean of one sample to a prespecified value.</p>
<p>For example, we might know that the weight of a mouse on normal diet is normally distributed with mean 24.0 g and standard deviation 3 g and want to compare the weight of a sample of 10 mice on high-fat diet to the known mean value for mice on normal diet.</p>
<p>The hypotheses:</p>
<p><span class="math display">\[H_0: \mu = \mu_0\]</span> <span class="math display">\[H_1: \mu \neq \mu_0\]</span></p>
<p>The alternative hypothesis, <span class="math inline">\(H_1,\)</span> above is for the two-sided hypothesis test. Other options are the one-sided <span class="math inline">\(H_1\)</span>; <span class="math inline">\(H_1: \mu &gt; \mu_0\)</span> or <span class="math inline">\(H_1: \mu &lt; \mu_0\)</span>.</p>
<p>If <span class="math display">\[X \sim N(\mu, \sigma)\]</span> (this could for example be the weight of a mouse on high-fat diet) then the sample mean <span class="math display">\[\bar X \sim N\left(\mu, \frac{\sigma}{\sqrt{n}}\right).\]</span></p>
<p>If <span class="math inline">\(\sigma\)</span> is known under the null hypothesis, then the test statistic</p>
<p><span class="math display">\[Z = \frac{\bar X - \mu_0}{\frac{\sigma}{\sqrt{n}}}\]</span> is normally distributed, <span class="math inline">\(\sim N(0,1)\)</span>.</p>
<p>In many situations the the population standard deviation is not known, but can instead be estimated from the sample. For large sample size <span class="math inline">\(n\)</span>, <span class="math inline">\(\sigma\)</span> can be replaced by the sample standard deviation <span class="math inline">\(s\)</span> and the test statistic will still be normally distributed according to the <strong>central limiit theorem</strong>*.</p>
<p>For small <span class="math inline">\(n\)</span> and unknown <span class="math inline">\(\sigma\)</span>, we can use the <strong>one-sample t-test</strong>, that uses the test statistic</p>
<p><span class="math display">\[T = \frac{\bar X - \mu_0}{\frac{s}{\sqrt{n}}},\]</span></p>
<p>which is t-distributed with <span class="math inline">\(df=n-1\)</span> degrees of freedom.</p>
<p>Once we have an appropriate test statistic, <span class="math inline">\(T\)</span> with known distribution, we can compute the observed value, <span class="math inline">\(t_{obs}\)</span> and use the null distribution to compute the p-value, <span class="math inline">\(P(|T| \geq |t_{obs}|)\)</span>.</p>
<p>In R, the functions <code>pnorm</code> and <code>pt</code> are useful for computing these probabilities. The <strong>one-sample t-test</strong> can also be performed using the function <code>t.test</code>like this;</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="do">##The observed 10 mouse weights;</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">30</span>, <span class="dv">23</span>, <span class="dv">18</span>, <span class="dv">31</span>, <span class="dv">24</span>, <span class="dv">39</span>, <span class="dv">26</span>, <span class="dv">36</span>, <span class="dv">29</span>, <span class="dv">23</span>, <span class="dv">32</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Under the null hypothesis mu=24</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="do">##Perform the t-test to investigate if the null hypotheis can be accepted, i.e.</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="do">##if the sample comes from a normal distribution with expected value 24.</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(x, <span class="at">mu=</span><span class="dv">24</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  x
t = 2.3153, df = 11, p-value = 0.04092
alternative hypothesis: true mean is not equal to 24
95 percent confidence interval:
 24.19742 31.80258
sample estimates:
mean of x 
       28 </code></pre>
</div>
</div>
</section>
<section id="two-samples-mean" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="two-samples-mean"><span class="header-section-number">3.2</span> Two samples, mean</h2>
<p>A two sample test of means is used to determine if two population means are equal.</p>
<p>Two independent samples are collected (one from each population) and the means are compared. This test can for example be used to determine if a treatment group is different compared to a control group, in terms of the mean of a property of interest.</p>
<p>The null hypothesis;</p>
<p><span class="math display">\[H_0: \mu_2 = \mu_1\]</span> The alternative hypothesis can either be two sided</p>
<p><span class="math display">\[H_1: \mu_2 \neq \mu_1\]</span> or one sided</p>
<p><span class="math display">\[H_1: \mu_2 &gt; \mu_1 \textrm{ or } H_1: \mu_2 &lt; \mu_1.\]</span></p>
<p>Assume observations from both populations are normally distributed;</p>
<p><span class="math display">\[
\begin{aligned}
X_1 \sim N(\mu_1, \sigma_1) \\
X_2 \sim N(\mu_2, \sigma_2)
\end{aligned}
\]</span> Then it follows that the sample means will also be normally distributed;</p>
<p><span class="math display">\[
\begin{aligned}
\bar X_1 \sim N(\mu_1, \sigma_1/\sqrt{n_1}) \\
\bar X_2 \sim N(\mu_2, \sigma_2/\sqrt{n_2})
\end{aligned}
\]</span></p>
<p>The mean difference <span class="math inline">\(D = \bar X_2 - \bar X_1\)</span> is thus also normally distributed:</p>
<p><span class="math display">\[D = \bar X_2 - \bar X_1 = N\left(\mu_2-\mu_1, \sqrt{\frac{\sigma_2^2}{n_2} + \frac{\sigma_1^2}{n_1}}\right)\]</span></p>
<p>If <span class="math inline">\(H_0\)</span> is true: <span class="math display">\[D = \bar X_2 - \bar X_1 = N\left(0, \sqrt{\frac{\sigma_2^2}{n_2} + \frac{\sigma_1^2}{n_1}}\right)\]</span></p>
<p>The test statistic: <span class="math display">\[Z = \frac{\bar X_2 - \bar X_1}{\sqrt{\frac{\sigma_2^2}{n_2} + \frac{\sigma_1^2}{n_1}}}\]</span> is standard normal, i.e.&nbsp;<span class="math inline">\(Z \sim N(0,1)\)</span>.</p>
<p>However, note that the test statistic require the standard deviations <span class="math inline">\(\sigma_1\)</span> and <span class="math inline">\(\sigma_2\)</span> to be known.</p>
<p>What if the population standard deviations are not known?</p>
<p>If the sample sizes are large, we can replace the known standard deviations with our sample standard deviations and according to the <strong>central limit theorem assume</strong> that</p>
<p><span class="math display">\[Z = \frac{\bar X_2 - \bar X_1}{\sqrt{\frac{s_2^2}{n_2} + \frac{s_1^2}{n_1}}} \sim N(0,1)\]</span></p>
<p>and proceed as before.</p>
<!-- Here $n_1=n_2=12$ which is not very large. -->
<p>For small sample sizes the test statistic will be t-distributed.</p>
<p><span class="math display">\[t = \frac{\bar X_2 - \bar X_1}{\sqrt{\frac{s_2^2}{n_2} + \frac{s_1^2}{n_1}}}\]</span></p>
<p>If it can be assumed that <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span> both are normally distributed and have equal variances, Studen’t t-test can be used. For equal variances the pooled sample variance can be computed;</p>
<p><span class="math display">\[s_p^2 = \frac{(n_1-1)s_1^2 + (n_2-1)s_2^2}{n_1+n_2-2}\]</span></p>
<p>and the test statistic</p>
<p><span class="math display">\[t = \frac{\bar X_1 - \bar X_2}{\sqrt{s_p^2(\frac{1}{n_1} + \frac{1}{n_2})}}\]</span></p>
<p>is t-distributed with <span class="math inline">\(n_1+n_2-2\)</span> degrees of freedom.</p>
<p>For unequal variances Welch’s t-test can instead be used.</p>
<p>The t-test is implemented in R, e.g.&nbsp;in the function <code>t.test</code> in the R-package <code>stats</code>, both Student’s t-test for equal variances and Welch’s t-test for unequal variances.</p>
</section>
<section id="one-sample-proportions" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="one-sample-proportions"><span class="header-section-number">3.3</span> One sample, proportions</h2>
<div id="exm-parampollen" class="theorem example">
<p><span class="theorem-title"><strong>Example 3.1 (Pollen allergy) </strong></span>Let’s get back to the pollen example!</p>
<p>Assume that the proportion of pollen allergy in Sweden is known to be <span class="math inline">\(0.3\)</span>. Observe 100 people from Uppsala, 42 of these were allergic to pollen. Is there a reason to believe that the proportion of pollen allergic in Uppsala <span class="math inline">\(\pi &gt; 0.3\)</span>?</p>
</div>
<ol type="1">
<li><p>Null and alternative hypotheses</p>
<p><span class="math display">\[H_0:\, \pi=\pi_0\]</span></p>
<p><span class="math display">\[H_1:\, \pi&gt;\pi_0,\]</span></p>
<p>where <span class="math inline">\(\pi_0=0.30\)</span> in this example. Other potential alternative hypothesis are <span class="math inline">\(H_1: \pi&lt;\pi_0\)</span> or <span class="math inline">\(H_1:\pi \neq \pi_0,\)</span> but in this particular example we are only interested in the alternative that <span class="math inline">\(\pi &gt; \pi_0\)</span>.</p></li>
<li><p>Significance level</p>
<p>Set the signifgicance level to <span class="math inline">\(\alpha=0.05\)</span>.</p></li>
<li><p>Test statistic</p>
<p>Here, we will use <span class="math inline">\(X\)</span>, the number of allergic persons in a random sample of size <span class="math inline">\(n=100\)</span>. The observed value is <span class="math inline">\(x_{obs} = 42\)</span>.</p></li>
<li><p>Null distribution</p>
<p><span class="math inline">\(X\)</span> is binomially distributed, so there is no need to use resampling here, we can use the binomial distribution to answer the question.</p></li>
<li><p>p-value</p>
<p>The probability of <span class="math inline">\(x_{obs}\)</span> or something higher,</p>
<p><span class="math inline">\(P(X \geq 42) = 1 - P(X \leq 41)\)</span> = [<code>1-pbinom(41,100,0.3)</code>] = 0.007174</p></li>
<li><p>Accept or reject <span class="math inline">\(H_0\)</span>?</p>
<p>As <span class="math inline">\(p&lt;0.05\)</span> <span class="math inline">\(H_0\)</span> is rejected and we conclude that there is reason to believe that the proportion of pollen allergic in Uppsala is higher than 0.3.</p></li>
</ol>
<p>This p-value can also be computed using the exact binomial test;</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">binom.test</span>(<span class="dv">42</span>, <span class="dv">100</span>, <span class="fl">0.3</span>, <span class="at">alternative=</span><span class="st">"greater"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Exact binomial test

data:  42 and 100
number of successes = 42, number of trials = 100, p-value = 0.007174
alternative hypothesis: true probability of success is greater than 0.3
95 percent confidence interval:
 0.3364797 1.0000000
sample estimates:
probability of success 
                  0.42 </code></pre>
</div>
</div>
<p>An alternative approach is to use the <strong>central limit theorem</strong> and use the normal approximation.</p>
<!-- # The central limit theorem -->
<!-- The sum of $n$ independent and equally distributed random variables -->
<!-- is normally distributed, if $n$ is large enough. -->
<p>As a result of the central limit theorem, the distribution of number or proportion of allergic individuals in a sample of size <span class="math inline">\(n\)</span> is approximately normal. At least if the sample is large enough. A rule of thumb is that the sample size should be <span class="math inline">\(n&gt;30\)</span>.</p>
<p>Here, the sample size is 100!</p>
<p>This test of proportions using the normal approximation is implemented in in the r-function <code>prop.test</code>.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
    1-sample proportions test with continuity correction

data:  42 out of 100, null probability 0.3
X-squared = 6.2976, df = 1, p-value = 0.006045
alternative hypothesis: true p is greater than 0.3
95 percent confidence interval:
 0.3372368 1.0000000
sample estimates:
   p 
0.42 </code></pre>
</div>
</div>
<p>But can of course also be calculated using only the normal distribution table.</p>
<p>The normal distribution has two parameters, mean and standard deviation.</p>
<p>From the binomial distribution we know that <span class="math inline">\(E[X] = n\pi\)</span> and <span class="math inline">\(var(X) = n\pi(1-\pi)\)</span>.</p>
<p>The standard error of <span class="math inline">\(X\)</span> is</p>
<p><span class="math display">\[SE=\sqrt{n\pi(1-\pi)}\]</span></p>
<p>If <span class="math inline">\(H_0\)</span> is true <span class="math inline">\(\pi=\pi_0\)</span> and</p>
<p><span class="math display">\[X \sim N\left(n\pi_0, \sqrt{n\pi_0(1-\pi_0)}\right)\]</span> <!-- An appropriate test statistic is --> <!-- $$Z = \frac{X-n\pi_0}{\sqrt{n\pi_0(1-\pi_0)}}$$ --> <!-- $Z \in N(0,1)$ which makes probabilities easy to compute. --></p>
<p>With this null distribution and ur observed value <span class="math inline">\(x_{obs} = 42\)</span>, the p-value can be computed.</p>
<p><span class="math inline">\(p = P(X \geq 42)\)</span></p>
<p>As we are now approximating a discrete distribution using a continuous distribution we need to use a trick called <em>continuiuty correction</em>, which simply means that we let each integer be represented by y a region <span class="math inline">\(\pm 0.5\)</span> from its value. Hence,</p>
<p><span class="math display">\[p = P(X \geq 42) = [continuity \; correction] = \]</span> <span class="math display">\[P(X \geq 41.5) = P\left(Z \geq \frac{41.5 - n\pi_0}{\sqrt{n\pi_0(1-\pi_0)}}\right) = \]</span> <span class="math display">\[P\left(Z \geq \frac{41.5-30}{\sqrt{100*0.3*(1-0.3)}}\right) = P(Z \geq 2.51) = 1 - P(Z \leq 2.51) = [Z-table] = 0.0060\]</span></p>
<!-- The p-value is the probability of the observed value, or something more extreme, if the null hypothesis is true. If the computed probability is below $\alpha=0.05$ our significance threshold, $H_0$ will be rejected. -->

<!-- $$p = P(P \geq \pi_0) = P(Z \geq Z_{obs}) = P(Z \geq` 2.51) = 1 - P(Z \leq 2.51) = [table] = 1 - 0.996 = 0.0044$$ -->
<p>As 0.00605&lt;0.05 we reject <span class="math inline">\(H_0\)</span> and conclude that there is reason to believe that the proportion of allergic in Uppsala is greater than 0.3.</p>
</section>
<section id="two-samples-proportions" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="two-samples-proportions"><span class="header-section-number">3.4</span> Two samples, proportions</h2>
<p><span class="math display">\[
\begin{aligned}
H_0: \pi_1 - \pi_2 = 0\\
H_1: \pi_1 - \pi_2 \neq 0
\end{aligned}
\]</span></p>
<p>Alternatively, a one sided alternative hypothesis can be used; <span class="math display">\[H_1: \pi_1 - \pi_2 &gt;0\textrm{ or }H_1: \pi_1 - \pi_2 &lt; 0.\]</span></p>
<!-- $$P_1 - P_2 \sim N\left(0, \sqrt{\pi(1-\pi)\left (\frac{1}{n_1} + \frac{1}{n_2}\right)} \right)$$ -->
<!-- where $\pi$ is the  -->
<p>If n is large the normal approximation can be used, an appropriate test statistic is</p>
<p><span class="math display">\[Z = \frac{P_1 - P_2}{\sqrt{P(1-P)\left (\frac{1}{n_1} + \frac{1}{n_2}\right)}},\]</span></p>
<p>where <span class="math inline">\(P\)</span> is the proportion in the merged sample of size <span class="math inline">\(n_1 + n_2\)</span>. <span class="math inline">\(Z \in N(0,1)\)</span> and p-value can be computed using the standard normal distribution.</p>
<p>Also the two sample proportions test is implemented in the function <code>prop.test</code>.</p>
</section>
<section id="variance" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="variance"><span class="header-section-number">3.5</span> Variance</h2>
<p>The test of equal variance in two groups is based on the null hypothesis</p>
<p><span class="math display">\[H_0: \sigma_1^2 = \sigma_2^2\]</span></p>
<p>If the two samples both come from populations with normal distributions, the sample variances (also random variables) are</p>
<p><span class="math display">\[S_1^2 = \frac{1}{n_1-1} \sum_{i=1}^{n_1} (X_{1i}-\bar X_1)^2\\
S_2^2 = \frac{1}{n_2-1} \sum_{i=1}^{n_2} (X_{2i}-\bar X_2)^2\]</span></p>
<p>It can be shown that <span class="math inline">\(\frac{(n_1-1)S_1^2}{\sigma_1^2} \sim \chi^2(n_1-1)\)</span> and <span class="math inline">\(\frac{(n_2-1)S_2^2}{\sigma_2^2} \sim \chi^2(n_2-1)\)</span>.</p>
<p>Hence, the test statistic for comparing the variances of two groups</p>
<p><span class="math display">\[F = \frac{S_1^2}{S_2^2}\]</span> is <span class="math inline">\(F\)</span>-distributed with <span class="math inline">\(n_1-1\)</span> and <span class="math inline">\(n_2-1\)</span> degrees of freedom.</p>
<p>In R a test of equal variances can be performed using the function <code>var.test</code>.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./infe_exr1_hyporesampling_solutions.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Exercises: Hypothesis tests, resampling</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./infe_04multiple.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Multiple testing</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>