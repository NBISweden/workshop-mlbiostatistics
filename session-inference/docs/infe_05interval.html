<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Statistical Inference - 5&nbsp; Point and interval estimates</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./infe_exr3_interval_solutions.html" rel="next">
<link href="./infe_exr2_hypoparam_solutions.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Point and interval estimates</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Statistical Inference</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infe_01hypothesis.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction to hypothesis tests</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infe_02hypresamp.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Hypothesis testing using resampling</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infe_exr1_hyporesampling_solutions.html" class="sidebar-item-text sidebar-link">Exercises: Hypothesis tests, resampling</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infe_03hypparm.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Parametric tests</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infe_04multiple.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Multiple testing</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infe_exr2_hypoparam_solutions.html" class="sidebar-item-text sidebar-link">Exercises: Hypothesis tests, parametric</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infe_05interval.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Point and interval estimates</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./infe_exr3_interval_solutions.html" class="sidebar-item-text sidebar-link">Exercises: Point and interval estimates</a>
  </div>
</li>
    </ul>
    </div>
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#point-estimate" id="toc-point-estimate" class="nav-link active" data-scroll-target="#point-estimate"><span class="toc-section-number">5.1</span>  Point estimate</a></li>
  <li><a href="#bias-and-precision" id="toc-bias-and-precision" class="nav-link" data-scroll-target="#bias-and-precision"><span class="toc-section-number">5.2</span>  Bias and precision</a></li>
  <li><a href="#interval-estimates" id="toc-interval-estimates" class="nav-link" data-scroll-target="#interval-estimates"><span class="toc-section-number">5.3</span>  Interval estimates</a>
  <ul class="collapse">
  <li><a href="#sec-bootstrapinterval" id="toc-sec-bootstrapinterval" class="nav-link" data-scroll-target="#sec-bootstrapinterval"><span class="toc-section-number">5.3.1</span>  Bootstrap interval</a></li>
  <li><a href="#confidence-interval" id="toc-confidence-interval" class="nav-link" data-scroll-target="#confidence-interval"><span class="toc-section-number">5.3.2</span>  Confidence interval</a></li>
  <li><a href="#confidence-interval-of-proportions" id="toc-confidence-interval-of-proportions" class="nav-link" data-scroll-target="#confidence-interval-of-proportions"><span class="toc-section-number">5.3.3</span>  Confidence interval of proportions</a></li>
  <li><a href="#confidence-interval-of-mean" id="toc-confidence-interval-of-mean" class="nav-link" data-scroll-target="#confidence-interval-of-mean"><span class="toc-section-number">5.3.4</span>  Confidence interval of mean</a></li>
  </ul></li>
  </ul>
</nav>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-estimates" class="quarto-section-identifier d-none d-lg-block"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Point and interval estimates</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="point-estimate" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="point-estimate"><span class="header-section-number">5.1</span> Point estimate</h2>
<p>Unknown population parameters can be inferred from estimates from random samples from the population of interest. The sample estimate will be our best guess, a <strong>point estimate</strong>, of the population parameter.</p>
<div id="exm-pollen-pointestimate" class="theorem example">
<p><span class="theorem-title"><strong>Example 5.1 (Pollen) </strong></span>If we are interested in how large proportion of the Uppsala population is allergic to pollen, we can investigate this by studying a random sample, e.g.&nbsp;randomly select 100 persons in Uppsala. It is important to actually sample randomly, ideally every individual in the population should have the same probability of being sampled.</p>
<p>In our sample, we observed that 42 of the 100 has a pollen allergy. Hence, the observed sample proportion is <span class="math inline">\(p=0.42\)</span>.</p>
<!-- What does this say about the population proportion $\pi$? -->
<p>Based on this random sample our point estimate of the Uppsala popultation proportion <span class="math inline">\(\pi\)</span> is <span class="math inline">\(\pi \approx p = 0.42\)</span>. There is an uncertainty in this measurement, if the experiment is repeated 100 other persons would be selected and our point estimate would be slightly different.</p>
</div>
<div id="exm-meanweight" class="theorem example">
<p><span class="theorem-title"><strong>Example 5.2 (Weight) </strong></span>The mean weight of a mouse population, <span class="math inline">\(\mu\)</span> is unknown. By taking a sample of size <span class="math inline">\(n\)</span> and measure the mean weight of the mice in the sample, <span class="math inline">\(m\)</span>, we measure a point estimate of the population mean.</p>
</div>
</section>
<section id="bias-and-precision" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="bias-and-precision"><span class="header-section-number">5.2</span> Bias and precision</h2>
<p>The sample proportion and sample mean are unbiased point estimates of the corresponding population parameters. It will not be without error, but the larger the sample, the smaller the error.</p>
<p>The expected value of an <strong>unbiased</strong> point estimate is the the population parameter that it estimates, This means that if you would repeat the sampling many times and compute the point estimate of interest, e.g.&nbsp;sample mean, the average of the sample means would be the population mean.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-biasprecision" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Rfigures/infe_fig-biasprecision-1.png" class="img-fluid figure-img" width="2100"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;5.1: Bias and precision.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>Even an unbiased point estimate is not perfect, it will have a certain amount of uncertainty.</p>
</section>
<section id="interval-estimates" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="interval-estimates"><span class="header-section-number">5.3</span> Interval estimates</h2>
<p>To show the uncertainty an <strong>interval estimate</strong> for a population parameter can be computed instead of just a point estimate. An interval estimate is an interval of possible values that with high probability contains the true population parameter. An interval estimate is estimated based on sample data. Interval estimation, just like point estimation, is a type of statistical inference.</p>
<p>The width of the interval estimate can be determined from the sampling distribution, i.e.&nbsp;the distribution of the sample property of interest. The dispersion of the sampling distribution is related to the uncertainty of the point estimate and can be used to define the interval estimate. As seen before there are different ways to estimate the sampling distribution.</p>
<section id="sec-bootstrapinterval" class="level3" data-number="5.3.1">
<h3 data-number="5.3.1" class="anchored" data-anchor-id="sec-bootstrapinterval"><span class="header-section-number">5.3.1</span> Bootstrap interval</h3>
<p>If the distribution of the sample statistic of interest is unknown, a bootstrap confidence interval can be computed instead.</p>
<p>Bootstraping is performed by resampling with replacement from the available random sample. The resampling distribution can then be used to calculate e.g.&nbsp;a 95% bootstrap interval.</p>
<p>This can be done as follows;</p>
<ol type="1">
<li>Put the entire sample in an urn!</li>
</ol>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figures/pollenurn42.png" class="img-fluid figure-img" style="width:20.0%"></p>
<p></p><figcaption class="figure-caption">An urn model with 42 allergy (black) and 58 non-allergy (white). The black balls represent allergic and the white balls non-allergic.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>In R;</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="do">## the sample consists of 50 non-allergic (0) and 42 allergic (1).</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">1</span>, <span class="fu">c</span>(<span class="dv">58</span>, <span class="dv">42</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ol start="2" type="1">
<li>Sample from the urn with replacement to compute the bootstrap distribution.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>pboot <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">1000</span>, <span class="fu">mean</span>(<span class="fu">sample</span>(x, <span class="at">replace=</span><span class="cn">TRUE</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">x=</span>pboot), <span class="fu">aes</span>(<span class="at">x=</span>x)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">color=</span><span class="st">"white"</span>, <span class="at">binwidth=</span><span class="fl">0.02</span>) <span class="sc">+</span> <span class="fu">theme_bw</span>() <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">"p"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-boot" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Rfigures/infe_fig-boot-1.png" class="img-fluid figure-img" style="width:45.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;5.2: Bootstrap resampling distribution.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<ol start="3" type="1">
<li>Compute the 95% bootstrap interval. This can be done using the percentile method by calculating the 2.5 and 97.5 percentiles, i.e.&nbsp;the values in the resampling distribution for which 2.5% and 97.5%, respectively, of all the values lie to the left of.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>ciboot <span class="ot">&lt;-</span> <span class="fu">quantile</span>(pboot, <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-CIboot" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Rfigures/infe_fig-CIboot-1.png" class="img-fluid figure-img" style="width:45.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;5.3: Bootstrap resampling distribution and the 95% bootstrap confidence interval.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>The 95% bootstrap confidence interval of <span class="math inline">\(\pi\)</span>; [0.32, 0.51].</p>
</section>
<section id="confidence-interval" class="level3" data-number="5.3.2">
<h3 data-number="5.3.2" class="anchored" data-anchor-id="confidence-interval"><span class="header-section-number">5.3.2</span> Confidence interval</h3>
<p>A confidence interval is a type of interval estimate associated with a confidence level.</p>
<div id="def-CI" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 5.1 </strong></span><strong>A confidence interval for <span class="math inline">\(\theta\)</span> with confidence level <span class="math inline">\(1 - \alpha\)</span></strong> is an interval that with probability <span class="math inline">\(1 - \alpha\)</span> cover the population parameter <span class="math inline">\(\theta\)</span>.</p>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fig-CI95" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Rfigures/infe_fig-CI95-1.png" class="img-fluid figure-img" width="4200"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;5.4: A 95% confidence interval will have 95% chance to cover the true value.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<!-- xx -->
<p>If the sampling distribution of studied statistic is known the confidence interval can be computed.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-samplingdistr" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Rfigures/infe_fig-samplingdistr-1.png" class="img-fluid figure-img" style="width:50.0%"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;5.5: The sampling distribution of theta. The probability that the observed value of a random sample falls in the</figcaption><p></p>
</figure>
</div>
</div>
</div>
</section>
<section id="confidence-interval-of-proportions" class="level3" data-number="5.3.3">
<h3 data-number="5.3.3" class="anchored" data-anchor-id="confidence-interval-of-proportions"><span class="header-section-number">5.3.3</span> Confidence interval of proportions</h3>
<p>The bootstrap is very useful if you do not know the distribution of our sampled property, but in our proportions example we actually do.</p>
<p>Remember that we can use the central limit theorem to show that</p>
<p><span class="math display">\[P \sim N\left(\pi, SE\right) \iff P \sim N\left(\pi, \sqrt{\frac{\pi(1-\pi)}{n}}\right)\]</span></p>
<p>It follows that</p>
<p><span class="math display">\[Z = \frac{P - \pi}{SE} \sim N(0,1)\]</span> Based on what we know of the standard normal distribution, we can compute an interval around the population property <span class="math inline">\(\pi\)</span> such that the probability that a sample property <span class="math inline">\(p\)</span> fall within this interval is <span class="math inline">\(1-\alpha\)</span>.</p>
<p><span class="math display">\[P(-z_{\alpha/2} &lt; \frac{P - \pi}{SE} &lt; z_{\alpha/2}) = 1 - \alpha\]</span></p>
<p>For a 95% confidence interval <span class="math inline">\(z_{0.025}=1.96\)</span> (from a table of the standard normal distribution). Other confidence levels of interest include 90% (<span class="math inline">\(z_{0.05}=1.64\)</span>) and 99% (<span class="math inline">\(z_{0.005}=2.58\)</span>). In R, the function ´qnorm` is used to compute <span class="math inline">\(z_{\alpha/2}\)</span>,</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 95% confidence interval, alpha=0.05</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="dv">1</span><span class="fl">-0.05</span><span class="sc">/</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.959964</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 90% confidence interval, alpha=0.10</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="dv">1</span><span class="fl">-0.10</span><span class="sc">/</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.644854</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 99% confidence interval, alpha=0.01</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="dv">1</span><span class="fl">-0.01</span><span class="sc">/</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.575829</code></pre>
</div>
</div>
<p>The unequality can be rewritten;</p>
<p><span class="math display">\[-z_{\alpha/2} &lt; \frac{P-\pi}{SE}&lt;z_{\alpha/2} \iff P-z_{\alpha/2}SE \leq \pi \leq P + z_{\alpha/2}SE\]</span> Hence,</p>
<p><span class="math display">\[P\left(P-z SE &lt; \pi &lt; P + z SE\right) = 1 - \alpha\]</span> In words, the population proportion <span class="math inline">\(\pi\)</span> will lie within <span class="math inline">\(\pm z_{\alpha/2}SE\)</span> from the the sample proportion <span class="math inline">\(P\)</span>.</p>
<p>To get the observed confidence interval, replace the random variable <span class="math inline">\(P\)</span> with the observed value <span class="math inline">\(p\)</span> (in our example 0.42).</p>
<p>The confidence interval can be expressed in different was;</p>
<p><span class="math display">\[p-z_{\alpha/2} SE &lt; \pi &lt; p + z_{\alpha/2} SE\]</span> <span class="math display">\[\pi = p \pm z_{\alpha/2} SE\]</span> <span class="math display">\[(p - z_{\alpha/2} SE, p + z_{\alpha/2} SE)\]</span></p>
<p>The 95% confidence interval <span class="math display">\[\pi = p \pm 1.96 \sqrt{\frac{p(1-p)}{n}}\]</span> will have 95% chance to cover the true value.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="Rfigures/infe_CIallergy-1.png" class="img-fluid" width="4200"></p>
</div>
</div>
<p>Back to our example of proportion pollen allergic in Uppsala. <span class="math inline">\(p=0.42\)</span> and <span class="math inline">\(SE=\sqrt{\frac{p(1-p)}{n}} = 0.0493559\)</span>.</p>
<p>Hence, the 95% confidence interval is <span class="math display">\[\pi = 0.42 \pm 1.96 * 0.05 = 0.42 \pm 0.092\]</span> or <span class="math display">\[(0.42-0.092, 0.42+0.092) = (0.32, 0.52)\]</span></p>
</section>
<section id="confidence-interval-of-mean" class="level3" data-number="5.3.4">
<h3 data-number="5.3.4" class="anchored" data-anchor-id="confidence-interval-of-mean"><span class="header-section-number">5.3.4</span> Confidence interval of mean</h3>
<p>The confidence interval of mean can be derived similarly.</p>
<p>The mean of a sample of <span class="math inline">\(n\)</span> independent and identically normal distributed observations <span class="math inline">\(X_i\)</span> is normally distributed;</p>
<p><span class="math display">\[\bar X \sim N(\mu, \frac{\sigma}{\sqrt{n}})\]</span></p>
<p>If <span class="math inline">\(\sigma\)</span> is unknown the statistic</p>
<p><span class="math display">\[T = \frac{\bar X - \mu}{\frac{s}{\sqrt{n}}}\]</span></p>
<p>is t-distributed with <span class="math inline">\(n-1\)</span> degrees of freedom, in short <span class="math inline">\(T \sim t(n-1)\)</span>.</p>
<p>It follows that</p>
<p><span class="math display">\[
  \begin{aligned}
P\left(-t &lt; \frac{\bar X - \mu}{\frac{\sigma}{\sqrt{n}}} &lt; t\right) = 1 - \alpha \iff \\
P\left(\bar X - t \frac{\sigma}{\sqrt{n}} &lt; \mu &lt; \bar X + t \frac{\sigma}{\sqrt{n}}\right) = 1 - \alpha
\end{aligned}
\]</span></p>
<p>The confidence interval with confidence level <span class="math inline">\(1-\alpha\)</span> is thus;</p>
<p><span class="math display">\[\mu = \bar x \pm t \frac{s}{\sqrt{n}}\]</span></p>
<p>The <span class="math inline">\(t\)</span> values for different values of <span class="math inline">\(\alpha\)</span> and degrees of freedom are tabulated and can be computed in R using the function <code>qt</code>.</p>
<p>For a 95% confidence interval, i.e.&nbsp;<span class="math inline">\(\alpha=0.05\)</span>, and <span class="math inline">\(n=5\)</span>, <span class="math inline">\(t\)</span> is 2.7764451 and can be computed using</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">5</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">=</span> <span class="fl">0.05</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="do">## t value</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="fu">qt</span>(<span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>, <span class="at">df=</span>n<span class="dv">-1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.776445</code></pre>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./infe_exr2_hypoparam_solutions.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Exercises: Hypothesis tests, parametric</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./infe_exr3_interval_solutions.html" class="pagination-link">
        <span class="nav-page-text">Exercises: Point and interval estimates</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>