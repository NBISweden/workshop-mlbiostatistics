<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>1 Introduction to hypothesis tests | Statistical inference</title>
  <meta name="description" content="1 Introduction to hypothesis tests | Statistical inference" />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="1 Introduction to hypothesis tests | Statistical inference" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="1 Introduction to hypothesis tests | Statistical inference" />
  
  
  

<meta name="author" content="NBIS" />


<meta name="date" content="2022-09-13" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="infe-exr1-hypresamp.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="" data-path=""><a href="#part-statistical-inference"><i class="fa fa-check"></i>(PART) Statistical Inference</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#learning-outcomes"><i class="fa fa-check"></i>Learning outcomes</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="infe-hypothesis.html"><a href="infe-hypothesis.html"><i class="fa fa-check"></i><b>1</b> Introduction to hypothesis tests</a>
<ul>
<li class="chapter" data-level="1.1" data-path="infe-hypothesis.html"><a href="infe-hypothesis.html#the-null-and-alternative-hypothesis"><i class="fa fa-check"></i><b>1.1</b> The null and alternative hypothesis</a></li>
<li class="chapter" data-level="1.2" data-path="infe-hypothesis.html"><a href="infe-hypothesis.html#significance-level-and-error-types"><i class="fa fa-check"></i><b>1.2</b> Significance level and error types</a></li>
<li class="chapter" data-level="1.3" data-path="infe-hypothesis.html"><a href="infe-hypothesis.html#to-perform-a-hypothesis-test"><i class="fa fa-check"></i><b>1.3</b> To perform a hypothesis test</a></li>
<li class="chapter" data-level="1.4" data-path="infe-hypothesis.html"><a href="infe-hypothesis.html#hypothesis-test-using-resampling"><i class="fa fa-check"></i><b>1.4</b> Hypothesis test using resampling</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="infe-hypothesis.html"><a href="infe-hypothesis.html#proportions-pollen-allergy-example"><i class="fa fa-check"></i><b>1.4.1</b> Proportions, pollen allergy example</a></li>
<li class="chapter" data-level="1.4.2" data-path="infe-hypothesis.html"><a href="infe-hypothesis.html#mean-values-permutation-test-example"><i class="fa fa-check"></i><b>1.4.2</b> Mean values, permutation test example</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="infe-exr1-hypresamp.html"><a href="infe-exr1-hypresamp.html"><i class="fa fa-check"></i>Exercises: Hypothesis tests, resampling</a></li>
<li class="chapter" data-level="2" data-path="infe-hypparam.html"><a href="infe-hypparam.html"><i class="fa fa-check"></i><b>2</b> Parametric tests</a>
<ul>
<li class="chapter" data-level="2.1" data-path="infe-hypparam.html"><a href="infe-hypparam.html#one-sample-proportions"><i class="fa fa-check"></i><b>2.1</b> One sample, proportions</a></li>
<li class="chapter" data-level="2.2" data-path="infe-hypparam.html"><a href="infe-hypparam.html#one-sample-mean"><i class="fa fa-check"></i><b>2.2</b> One sample, mean</a></li>
<li class="chapter" data-level="2.3" data-path="infe-hypparam.html"><a href="infe-hypparam.html#two-samples-proportions"><i class="fa fa-check"></i><b>2.3</b> Two samples, proportions</a></li>
<li class="chapter" data-level="2.4" data-path="infe-hypparam.html"><a href="infe-hypparam.html#two-samples-mean"><i class="fa fa-check"></i><b>2.4</b> Two samples, mean</a></li>
<li class="chapter" data-level="2.5" data-path="infe-hypparam.html"><a href="infe-hypparam.html#variance"><i class="fa fa-check"></i><b>2.5</b> Variance</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="infe-exr2-hypparam.html"><a href="infe-exr2-hypparam.html"><i class="fa fa-check"></i>Exercises: Hypothesis tests, parametric</a></li>
<li class="chapter" data-level="3" data-path="infe-multiple.html"><a href="infe-multiple.html"><i class="fa fa-check"></i><b>3</b> Multiple testing</a>
<ul>
<li class="chapter" data-level="3.1" data-path="infe-multiple.html"><a href="infe-multiple.html#error-types"><i class="fa fa-check"></i><b>3.1</b> Error types</a></li>
<li class="chapter" data-level="3.2" data-path="infe-multiple.html"><a href="infe-multiple.html#perform-one-test"><i class="fa fa-check"></i><b>3.2</b> Perform one test:</a></li>
<li class="chapter" data-level="3.3" data-path="infe-multiple.html"><a href="infe-multiple.html#perform-m-independent-tests"><i class="fa fa-check"></i><b>3.3</b> Perform <span class="math inline">\(m\)</span> independent tests:</a></li>
<li class="chapter" data-level="3.4" data-path="infe-multiple.html"><a href="infe-multiple.html#bonferroni-correction"><i class="fa fa-check"></i><b>3.4</b> Bonferroni correction</a></li>
<li class="chapter" data-level="3.5" data-path="infe-multiple.html"><a href="infe-multiple.html#benjamini-hochbergs-fdr"><i class="fa fa-check"></i><b>3.5</b> Benjamini-Hochbergs FDR</a></li>
<li class="chapter" data-level="3.6" data-path="infe-multiple.html"><a href="infe-multiple.html#adjusted-p-values"><i class="fa fa-check"></i><b>3.6</b> ‘Adjusted’ p-values</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="infe-interval.html"><a href="infe-interval.html"><i class="fa fa-check"></i><b>4</b> Point and interval estimates</a>
<ul>
<li class="chapter" data-level="4.1" data-path="infe-interval.html"><a href="infe-interval.html#point-estimate"><i class="fa fa-check"></i><b>4.1</b> Point estimate</a></li>
<li class="chapter" data-level="4.2" data-path="infe-interval.html"><a href="infe-interval.html#confidence-interval"><i class="fa fa-check"></i><b>4.2</b> Confidence interval</a>
<ul>
<li class="chapter" data-level="4.2.1" data-path="infe-interval.html"><a href="infe-interval.html#bootstrap-interval"><i class="fa fa-check"></i><b>4.2.1</b> Bootstrap interval</a></li>
<li class="chapter" data-level="4.2.2" data-path="infe-interval.html"><a href="infe-interval.html#confidence-interval-of-proportions"><i class="fa fa-check"></i><b>4.2.2</b> Confidence interval of proportions</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="infe-exr3-interval.html"><a href="infe-exr3-interval.html"><i class="fa fa-check"></i>Exercises: Interval estimates</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Statistical inference</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="infe-hypothesis" class="section level1 hasAnchor" number="1">
<h1><span class="header-section-number">1</span> Introduction to hypothesis tests<a href="infe-hypothesis.html#infe-hypothesis" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>To perform a <strong>hypothesis test</strong> is to evaluate a hypothesis based on a random sample.</p>
<p>Typically, the hypotheses that are tested are assumptions about properties of the population, such as proportion, mean, mean difference, variance etc.</p>
<div id="the-null-and-alternative-hypothesis" class="section level2 hasAnchor" number="1.1">
<h2><span class="header-section-number">1.1</span> The null and alternative hypothesis<a href="infe-hypothesis.html#the-null-and-alternative-hypothesis" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>There are two hypotheses involved in a hypothesis test, the <strong>null hypothesis, <span class="math inline">\(H_0\)</span></strong>, and the <strong>alternative hypothesis, <span class="math inline">\(H_1\)</span></strong>.</p>
<p>The null hypothesis is in general neutral; “no change”, “no difference between the groups”, “no association”. In general we want to show that <span class="math inline">\(H_0\)</span> is false.</p>
<p>The alternative hypothesis expresses what the researcher is interested in, such as “the treatment has an effect”, “there is a difference between the groups”, “there is an association”. The alternative hypothesis can also be directional, e.g. “the treatment has a positive effect”.</p>
</div>
<div id="significance-level-and-error-types" class="section level2 hasAnchor" number="1.2">
<h2><span class="header-section-number">1.2</span> Significance level and error types<a href="infe-hypothesis.html#significance-level-and-error-types" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A hypothesis test is used to draw inference about a population based on a random sample. The inference made might of course be wrong. There are two types of errors;</p>
<p><strong>Type I error</strong> is a false positive, a false alarm that occurs when <span class="math inline">\(H_0\)</span> is rejected when it is actually true. Examples: <em>“The test says that you are covid-19 positive, when you actually are not”, “The test says that the drug has a positive effect on patient symptoms, but it actually has not”</em>.</p>
<p><strong>Type II error</strong> is a false negative, a miss that occurs when <span class="math inline">\(H_0\)</span> is accepted, when it is actually false. Examples: <em>The test says that you are covid-19 negative, when you actually have covid-19”, “The test says that the drug has no effect on patient symptoms, when it actually has”</em>.</p>
<table class="table" style="width: auto !important; margin-left: auto; margin-right: auto;">
<caption>
<span id="tab:unnamed-chunk-1">Table 1.1: </span>Error types
</caption>
<tbody>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
H0 is true
</td>
<td style="text-align:left;">
H0 is false
</td>
</tr>
<tr>
<td style="text-align:left;">
Accept H0
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Type II error, miss
</td>
</tr>
<tr>
<td style="text-align:left;">
Reject H0
</td>
<td style="text-align:left;">
Type I error, false alarm
</td>
<td style="text-align:left;">
</td>
</tr>
</tbody>
</table>
<p>The significance level, <span class="math inline">\(\alpha\)</span> = P(false alarm) = P(Reject <span class="math inline">\(H_0\)</span>|<span class="math inline">\(H_0\)</span> is true).</p>
<p>The significance level is the risk of false alarm, i.e. to say “I have a hit”, “I found a difference”, when the the null hypothesis (“there is no difference”) is true. The risk of false alarm is controlled by setting the significance level to a desired value. We do want to keep the risk of false alarm (type I error) low, but at the same time we don’t want many missed hits (type II error).</p>
<p>The significance level should be set before the hypothesis test is performed. Common values to use are 0.05 or 0.01.</p>
<p>If the p-value is above the significance level, <span class="math inline">\(p&gt;\alpha\)</span>, <span class="math inline">\(H_0\)</span> is accepted.</p>
<p>If the p-value is below the significance level, <span class="math inline">\(p \leq \alpha\)</span>, <span class="math inline">\(H_0\)</span> is rejected.</p>
<p>Another property of a statistical test is the <strong>statistical power</strong>, defined as power = P(Refect H0|H0 is false).</p>
</div>
<div id="to-perform-a-hypothesis-test" class="section level2 hasAnchor" number="1.3">
<h2><span class="header-section-number">1.3</span> To perform a hypothesis test<a href="infe-hypothesis.html#to-perform-a-hypothesis-test" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ol style="list-style-type: decimal">
<li>Define <span class="math inline">\(H_0\)</span> and <span class="math inline">\(H_1\)</span></li>
<li>Select an appropriate <strong>significance level</strong>, <span class="math inline">\(\alpha\)</span></li>
<li>Select an appropriate test statistic, <span class="math inline">\(T\)</span>, and compute the observed value, <span class="math inline">\(t_{obs}\)</span></li>
<li>Assume that the <span class="math inline">\(H_0\)</span> is true and compute the <strong>sampling distribution</strong> of <span class="math inline">\(T\)</span>.</li>
<li>Compare the observed value, <span class="math inline">\(t_{obs}\)</span>, with the computed sampling distribution under <span class="math inline">\(H_0\)</span> (the so called <strong>null distribution</strong>) and compute a <strong>p-value</strong>.</li>
<li>Based on the p-value either accept or reject <span class="math inline">\(H_0\)</span>.</li>
</ol>
<p>The <strong>sampling distribution</strong> is the distribution of a sample statistic (e.g mean or proportion). The sampling distribution can be obtained by drawing a large number of samples from a population.</p>
<p>A <strong>null distribution</strong> is a sampling distribution when the null hypothesis is true.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:examplenull"></span>
<img src="Rfigures/infe_examplenull-1.png" alt="A null distribution" width="70%" />
<p class="caption">
Figure 1.1: A null distribution
</p>
</div>
<p>The <strong>p-value</strong> is the probability of observing a value at least as extreme as the observed value, if <span class="math inline">\(H_0\)</span> is true.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:examplepval"></span>
<img src="Rfigures/infe_examplepval-1.png" alt="The p-value is the probability to observe $x_{obs}$ or something more extreme, if the null hypothesis is true. The p-value is illustrated for a one-tailed test (left) and for a two-tailed test (right)." width="50%" /><img src="Rfigures/infe_examplepval-2.png" alt="The p-value is the probability to observe $x_{obs}$ or something more extreme, if the null hypothesis is true. The p-value is illustrated for a one-tailed test (left) and for a two-tailed test (right)." width="50%" />
<p class="caption">
Figure 1.2: The p-value is the probability to observe <span class="math inline">\(x_{obs}\)</span> or something more extreme, if the null hypothesis is true. The p-value is illustrated for a one-tailed test (left) and for a two-tailed test (right).
</p>
</div>
</div>
<div id="hypothesis-test-using-resampling" class="section level2 hasAnchor" number="1.4">
<h2><span class="header-section-number">1.4</span> Hypothesis test using resampling<a href="infe-hypothesis.html#hypothesis-test-using-resampling" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The sampling distribution of a test statistic under the null hypothesis is sometimes known or can be approximated. When the null distribution is unknown, another option is to simulate the null distribution using resampling. This is done by simulating a model under the null hypothesis and drawing random samples from this model repeatedly. Let’s take a look at a few examples;</p>
<div id="proportions-pollen-allergy-example" class="section level3 hasAnchor" number="1.4.1">
<h3><span class="header-section-number">1.4.1</span> Proportions, pollen allergy example<a href="infe-hypothesis.html#proportions-pollen-allergy-example" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s assume we know that the proportion of pollen allergy in Sweden is <span class="math inline">\(0.3\)</span>. We suspect that the number of pollen allergic has increased in Uppsala in the last couple of years and want to investigate this.</p>
<p>Observe 100 people from Uppsala, 42 of these were allergic to pollen. Is there a reason to believe that the proportion of pollen allergic in Uppsala <span class="math inline">\(\pi &gt; 0.3\)</span>?</p>
<div id="null-and-alternative-hypotheses" class="section level5 unnumbered hasAnchor">
<h5>Null and alternative hypotheses<a href="infe-hypothesis.html#null-and-alternative-hypotheses" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p><span class="math inline">\(H_0:\)</span> The proportion of pollen allergy in Uppsala is the same as in Sweden as a whole.</p>
<p><span class="math inline">\(H_1:\)</span> The proportion of pollen allergy in Uppsala is greater than in Sweden as a whole.</p>
<p>or expressed differently;</p>
<p><span class="math display">\[H_0:\, \pi=\pi_0\]</span></p>
<p><span class="math display">\[H_1:\, \pi&gt;\pi_0\]</span>
where <span class="math inline">\(\pi\)</span> is the unknown proportion of pollen allergy in the Uppsala population and <span class="math inline">\(\pi_0 = 0.3\)</span> is the proportion of pollen allergy in Sweden.</p>
</div>
<div id="test-statistic" class="section level5 unnumbered hasAnchor">
<h5>Test statistic<a href="infe-hypothesis.html#test-statistic" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Here we are interested in the proportion of pollen allergic in Uppsala. An appropriate test statistic could be the number of pollen allergic in a sample of size <span class="math inline">\(n=100\)</span>, <span class="math inline">\(X\)</span>. As an alternative we can use the proportion of pollen allergic in a sample of size <span class="math inline">\(n\)</span>,</p>
<p><span class="math display">\[P = \frac{X}{n}\]</span></p>
<p>Let’s use <span class="math inline">\(P\)</span> as our test statistic and compute the observed value, <span class="math inline">\(p_{obs}\)</span>. In our sample of 100 people from Uppsala, the proportion allergic to pollen is <span class="math inline">\(p=42/100=0.42\)</span>.</p>
</div>
<div id="null-distribution" class="section level5 unnumbered hasAnchor">
<h5>Null distribution<a href="infe-hypothesis.html#null-distribution" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>The sampling distribution of <span class="math inline">\(P\)</span> under <span class="math inline">\(H_0\)</span> (i.e. when the null hypothesis is true) is what we call the null distribution.</p>
<p><span class="math inline">\(H_0\)</span> state that <span class="math inline">\(\pi=0.3\)</span>. We can model this using an urn model as follows;</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:pollenurn"></span>
<img src="figures/pollenurn.png" alt="An urn model of the null hypothesis $\pi=0.3$. The black balls represent allergic and the white balls non-allergic." width="20%" />
<p class="caption">
Figure 1.3: An urn model of the null hypothesis <span class="math inline">\(\pi=0.3\)</span>. The black balls represent allergic and the white balls non-allergic.
</p>
</div>
<p>Using this model, we can simulate taking a sample of size 100 many times.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="infe-hypothesis.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Urn</span></span>
<span id="cb1-2"><a href="infe-hypothesis.html#cb1-2" aria-hidden="true" tabindex="-1"></a>urn <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">3</span>))</span>
<span id="cb1-3"><a href="infe-hypothesis.html#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Sample 100 times with replacement</span></span>
<span id="cb1-4"><a href="infe-hypothesis.html#cb1-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sample</span>(urn, <span class="dv">100</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb1-5"><a href="infe-hypothesis.html#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Compute proportion of samples that are allergic (1)</span></span>
<span id="cb1-6"><a href="infe-hypothesis.html#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(x)</span></code></pre></div>
<pre><code>## [1] 0.2</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="infe-hypothesis.html#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Set the seed to get the same result if we redo the analysis</span></span>
<span id="cb3-2"><a href="infe-hypothesis.html#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">13</span>)</span>
<span id="cb3-3"><a href="infe-hypothesis.html#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Repeat drawing sample of size 100 and computing proporion allergic 100000 times</span></span>
<span id="cb3-4"><a href="infe-hypothesis.html#cb3-4" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">100000</span>, <span class="fu">mean</span>(<span class="fu">sample</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="fu">c</span>(<span class="dv">7</span>, <span class="dv">3</span>)), <span class="dv">100</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)))</span></code></pre></div>
<p>Plot the distribution</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:pollensampledistr"></span>
<img src="Rfigures/infe_pollensampledistr-1.png" alt="The sampling distribution." width="45%" />
<p class="caption">
Figure 1.4: The sampling distribution.
</p>
</div>
</div>
<div id="compute-p-value" class="section level5 unnumbered hasAnchor">
<h5>Compute p-value<a href="infe-hypothesis.html#compute-p-value" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Compare the observed value, <span class="math inline">\(p_{obs} = 0.42\)</span> to the null distribution.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:histpollennull"></span>
<img src="Rfigures/infe_histpollennull-1.png" alt="The sampling distribution. The observed value is marked by a red vertical line." width="50%" />
<p class="caption">
Figure 1.5: The sampling distribution. The observed value is marked by a red vertical line.
</p>
</div>
<p>The p-value is the probability of getting the observed value or higher, if the null hypothesis is true.</p>
<p>Use the null distribution to calculate the p-value, <span class="math inline">\(P(P \geq 0.42|H_0)\)</span>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="infe-hypothesis.html#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="do">## How many times </span></span>
<span id="cb4-2"><a href="infe-hypothesis.html#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(p <span class="sc">&gt;=</span> <span class="fl">0.42</span>)</span></code></pre></div>
<pre><code>## [1] 703</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="infe-hypothesis.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="do">## p-value</span></span>
<span id="cb6-2"><a href="infe-hypothesis.html#cb6-2" aria-hidden="true" tabindex="-1"></a>pval <span class="ot">&lt;-</span> <span class="fu">mean</span>(p <span class="sc">&gt;=</span> <span class="fl">0.42</span>)</span></code></pre></div>
<p>p = <span class="math inline">\(P(P \geq 0.42|H_0)\)</span> = 0.00703</p>
</div>
<div id="accept-or-reject-h_0" class="section level5 unnumbered hasAnchor">
<h5>Accept or reject <span class="math inline">\(H_0\)</span>?<a href="infe-hypothesis.html#accept-or-reject-h_0" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>As the p-value is <span class="math inline">\(&lt; \alpha = 0.05\)</span> the null hypotheis is rejected. This means that we can conclude that there is reason to belive that the porportion of pollen allergic in Uppsala is greater than 30%.</p>
</div>
</div>
<div id="mean-values-permutation-test-example" class="section level3 hasAnchor" number="1.4.2">
<h3><span class="header-section-number">1.4.2</span> Mean values, permutation test example<a href="infe-hypothesis.html#mean-values-permutation-test-example" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Do high fat diet lead to increased body weight?</strong></p>
<p>The effect of high-fat diet on the body weight of mice is tudied in an experiment. The study setup is as follows:</p>
<ol style="list-style-type: decimal">
<li>24 female mice are ordered from a lab.</li>
<li>Randomly, 12 of the 24 mice are assigned to receive high-fat diet, the
remaining 12 are controls (ordinary diet).</li>
<li>Body weight is measured after one week.</li>
</ol>
<p>The observed values, mouse weights in grams, are summarized below;</p>
<table class="table" style="font-size: 14px; margin-left: auto; margin-right: auto;">
<tbody>
<tr>
<td style="text-align:left;">
high-fat
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
23
</td>
<td style="text-align:right;">
18
</td>
<td style="text-align:right;">
31
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
39
</td>
<td style="text-align:right;">
26
</td>
<td style="text-align:right;">
36
</td>
<td style="text-align:right;">
29
</td>
<td style="text-align:right;">
23
</td>
<td style="text-align:right;">
32
</td>
</tr>
<tr>
<td style="text-align:left;">
ordinary
</td>
<td style="text-align:right;">
27
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
22
</td>
<td style="text-align:right;">
23
</td>
<td style="text-align:right;">
25
</td>
<td style="text-align:right;">
37
</td>
<td style="text-align:right;">
24
</td>
<td style="text-align:right;">
26
</td>
<td style="text-align:right;">
21
</td>
<td style="text-align:right;">
26
</td>
<td style="text-align:right;">
30
</td>
<td style="text-align:right;">
24
</td>
</tr>
</tbody>
</table>
<div id="null-and-alternative-hypotheses-1" class="section level5 unnumbered hasAnchor">
<h5>Null and alternative hypotheses<a href="infe-hypothesis.html#null-and-alternative-hypotheses-1" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p><span class="math display">\[
\begin{aligned}
H_0: \mu_d = \mu_c \iff \mu_d - \mu_c = 0\\
H_1: \mu_d&gt;\mu_c \iff \mu_d-\mu_c &gt; 0
\end{aligned}
\]</span></p>
<p>where <span class="math inline">\(\mu_d\)</span> is the (unknown) mean body weight of the high-fat mouse population and <span class="math inline">\(\mu_c\)</span> is the mean body-weight of the control mouse population.</p>
<p>Studied population: Female mice that can be ordered from a lab.</p>
</div>
<div id="test-statistic-1" class="section level5 unnumbered hasAnchor">
<h5>Test statistic<a href="infe-hypothesis.html#test-statistic-1" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Here we are interested in the mean difference between high-fat and control mice and an appropriate test statistic can be the mean diffrence, <span class="math inline">\(D = \bar X_d - \bar X_c\)</span>, where</p>
<ul>
<li><span class="math inline">\(\bar X_d\)</span> is a random variable describing the mean weight of 12 (randomly selected) mice on high-fat diet. <span class="math inline">\(E[\bar X_d] = E[X_d] = \mu_d\)</span></li>
<li><span class="math inline">\(\bar X_c\)</span> is a random variable describing the Mean weight of 12 (randomly selected) mice on ordinary diet. <span class="math inline">\(E[\bar X_c] = E[X_c] = \mu_c\)</span></li>
</ul>
<p>The mean difference <span class="math inline">\(D = \bar X_d - \bar X_c\)</span> is also a random variable.</p>
<p>Observed values;</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="infe-hypothesis.html#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="do">## 12 HF mice</span></span>
<span id="cb7-2"><a href="infe-hypothesis.html#cb7-2" aria-hidden="true" tabindex="-1"></a>xD <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">30</span>, <span class="dv">23</span>, <span class="dv">18</span>, <span class="dv">31</span>, <span class="dv">24</span>, <span class="dv">39</span>, <span class="dv">26</span>, <span class="dv">36</span>, <span class="dv">29</span>, <span class="dv">23</span>, <span class="dv">32</span>)</span>
<span id="cb7-3"><a href="infe-hypothesis.html#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="do">## 12 control mice</span></span>
<span id="cb7-4"><a href="infe-hypothesis.html#cb7-4" aria-hidden="true" tabindex="-1"></a>xC <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">27</span>, <span class="dv">25</span>, <span class="dv">22</span>, <span class="dv">23</span>, <span class="dv">25</span>, <span class="dv">37</span>, <span class="dv">24</span>, <span class="dv">26</span>, <span class="dv">21</span>, <span class="dv">26</span>, <span class="dv">30</span>, <span class="dv">24</span>)</span>
<span id="cb7-5"><a href="infe-hypothesis.html#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="infe-hypothesis.html#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="do">##Compute mean body weights of the two samples</span></span>
<span id="cb7-7"><a href="infe-hypothesis.html#cb7-7" aria-hidden="true" tabindex="-1"></a>mD <span class="ot">&lt;-</span> <span class="fu">mean</span>(xD)</span>
<span id="cb7-8"><a href="infe-hypothesis.html#cb7-8" aria-hidden="true" tabindex="-1"></a>mC <span class="ot">&lt;-</span> <span class="fu">mean</span>(xC) </span>
<span id="cb7-9"><a href="infe-hypothesis.html#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="do">## Compute mean difference</span></span>
<span id="cb7-10"><a href="infe-hypothesis.html#cb7-10" aria-hidden="true" tabindex="-1"></a>dobs <span class="ot">&lt;-</span> mD <span class="sc">-</span> mC</span></code></pre></div>
<p>Mean weight of sample control mice (ordinary diet): <span class="math inline">\(\bar x_c = 25.83\)</span></p>
<p>Mean weight of sample mice on high-fat diet: <span class="math inline">\(\bar x_d = 28.00\)</span></p>
<p>Difference in sample mean weights: <span class="math inline">\(d_{obs} = \bar x_d - \bar x_c = 2.1667\)</span></p>
</div>
<div id="null-distribution-1" class="section level5 unnumbered hasAnchor">
<h5>Null distribution<a href="infe-hypothesis.html#null-distribution-1" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>If high-fat diet has no effect, i.e. if <span class="math inline">\(H_0\)</span> was true, the result would be as if all mice were given the same diet. What can we expect if all mice are fed with the same type of food?</p>
<p>This can be accomplished using permutation</p>
<p>The 24 mice were initially from the same population, depending on how the mice are randomly assigned to high-fat and normal group, the mean weights would differ, even if the two groups were treated the same.</p>
<p>Assume <span class="math inline">\(H_0\)</span> is true, i.e. assume all mice are equivalent and</p>
<ol style="list-style-type: decimal">
<li>Randomly reassign 12 of the 24 mice to ‘high-fat’ and the remaining 12 to ‘control’.</li>
<li>Compute difference in mean weights</li>
</ol>
<p>If we repeat 1-2 many times we get the null distribution of difference in mean weights.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="infe-hypothesis.html#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="do">## All 24 body weights in a vector</span></span>
<span id="cb8-2"><a href="infe-hypothesis.html#cb8-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(xHF, xN)</span>
<span id="cb8-3"><a href="infe-hypothesis.html#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Mean difference</span></span>
<span id="cb8-4"><a href="infe-hypothesis.html#cb8-4" aria-hidden="true" tabindex="-1"></a>dobs <span class="ot">&lt;-</span> <span class="fu">mean</span>(x[<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>]) <span class="sc">-</span> <span class="fu">mean</span>(x[<span class="dv">13</span><span class="sc">:</span><span class="dv">24</span>])</span>
<span id="cb8-5"><a href="infe-hypothesis.html#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Permute once</span></span>
<span id="cb8-6"><a href="infe-hypothesis.html#cb8-6" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">sample</span>(x)</span>
<span id="cb8-7"><a href="infe-hypothesis.html#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="do">##Compute mean difference</span></span>
<span id="cb8-8"><a href="infe-hypothesis.html#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(y[<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>]) <span class="sc">-</span> <span class="fu">mean</span>(y[<span class="dv">13</span><span class="sc">:</span><span class="dv">24</span>])</span></code></pre></div>
<pre><code>## [1] 0.1667</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="infe-hypothesis.html#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Repeat the above many times</span></span>
<span id="cb10-2"><a href="infe-hypothesis.html#cb10-2" aria-hidden="true" tabindex="-1"></a>dnull.perm <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="at">n =</span> <span class="dv">100000</span>, {</span>
<span id="cb10-3"><a href="infe-hypothesis.html#cb10-3" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">sample</span>(x)</span>
<span id="cb10-4"><a href="infe-hypothesis.html#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="do">##Mean difference</span></span>
<span id="cb10-5"><a href="infe-hypothesis.html#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(y[<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>]) <span class="sc">-</span> <span class="fu">mean</span>(y[<span class="dv">13</span><span class="sc">:</span><span class="dv">24</span>])</span>
<span id="cb10-6"><a href="infe-hypothesis.html#cb10-6" aria-hidden="true" tabindex="-1"></a>})</span></code></pre></div>
<p>Plot the null distribution and the observed difference.</p>
<<<<<<< HEAD
<div class="figure"><span style="display:block;" id="fig:permtest-4"></span>
<img src="Rfigures/infe_permtest-4-1.png" alt="Null distribution of the mean difference $D$." width="50%" />
=======
<div class="figure"><span style="display:block;" id="fig:permtest-6"></span>
<img src="Rfigures/infe_permtest-6-1.png" alt="Null distribution of the mean difference $D$." width="50%" />
>>>>>>> master
<p class="caption">
Figure 1.6: Null distribution of the mean difference <span class="math inline">\(D\)</span>.
</p>
</div>
</div>
<div id="compute-p-value-1" class="section level5 unnumbered hasAnchor">
<h5>Compute p-value<a href="infe-hypothesis.html#compute-p-value-1" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>What is the probability to get an at least as extreme mean difference as our observed value, <span class="math inline">\(d_{obs}\)</span>, if <span class="math inline">\(H_0\)</span> was true?</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="infe-hypothesis.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Compute the p-value</span></span>
<span id="cb11-2"><a href="infe-hypothesis.html#cb11-2" aria-hidden="true" tabindex="-1"></a>pval <span class="ot">&lt;-</span> <span class="fu">mean</span>(dnull.perm<span class="sc">&gt;=</span>dobs)</span></code></pre></div>
<p><span class="math display">\[P(\bar X_2 - \bar X_1 \geq d_{obs} | H_0) = 0.169\]</span></p>
</div>
<div id="accept-or-reject-h_0-1" class="section level5 unnumbered hasAnchor">
<h5>Accept or reject <span class="math inline">\(H_0\)</span>?<a href="infe-hypothesis.html#accept-or-reject-h_0-1" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>As <span class="math inline">\(0.169&gt;0.05\)</span> the null hypothesis is accepted, there is no evidence that the high-fat diet increase body weight in mice.</p>
<!-- ## Parametric hypothesis tests -->
</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="infe-exr1-hypresamp.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
